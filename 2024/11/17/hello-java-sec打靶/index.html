
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>hello-java-sec打靶 | Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>hello-java-sec打靶</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/11/17
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/java/" style="color: #00bcd4">java</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><h2 id="jdbc"><a href="#jdbc" class="headerlink" title="jdbc"></a>jdbc</h2><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>SQL注入是因为程序未能正确对用户的输入进行检查，将用户的输入以拼接的方式带入SQL语句，导致了SQL语句可控 从而获取数据库信息，造成信息泄漏</p>
<p>对于提供的例子 漏洞的成因都是先拼接的字符串 然后传入statement</p>
<p>由于错误的使用预编译 在此还是导致了sql注入</p>
<p>正确的做法是占位符 加set </p>
<p><img src="https://img-host-arcueid.oss-cn-hangzhou.aliyuncs.com/img202411170723960.png" alt="image-20241117072316828"></p>
<p>靶场提供的安全解决方案是 黑名单 预编译 使用ESAPI框架 jdbctemplate使用强制数据类型</p>
<p>注意jdbctemplate也要正确使用才安全</p>
<p><img src="https://img-host-arcueid.oss-cn-hangzhou.aliyuncs.com/img202411170725317.png" alt="image-20241117072528240"></p>
<h3 id="安全编码"><a href="#安全编码" class="headerlink" title="安全编码"></a>安全编码</h3><p>正确使用预编译 分离语句和数据 从本质上避免sql注入</p>
<p>出现异常时禁止返回堆栈 sql语句等敏感信息 统一返回错误页面 屏蔽异常栈</p>
<h2 id="mybatis"><a href="#mybatis" class="headerlink" title="mybatis"></a>mybatis</h2><p>使用<code>$&#123;&#125;</code>表示拼接字符串 会直接将接受到参数的内容不加任何修饰符拼接在 SQL 中 从而导致sql注入</p>
<p>而<code>#&#123;&#125;</code>使用预编译，通过 PreparedStatement 和占位符来实现，会把参数部分用一个占位符 <code>?</code> 替代</p>
<p>强制使用Integer或long类型 可以在一定程度上解决<code>$&#123;&#125;</code>导致的sql注入 但是还是不建议用<code>$&#123;&#125;</code></p>
<pre><code class="java">@Select(&quot;select * from users where id = $&#123;id&#125;&quot;)
List&lt;User&gt; queryById2(@Param(&quot;id&quot;) Integer id);
</code></pre>
<p>模糊搜索时，直接使用’%#{q}%’ 会报错，部分研发图方便直接改成’%${q}%’从而造成注入</p>
<pre><code class="java">@Select(&quot;select * from users where user like &#39;%$&#123;q&#125;%&#39;&quot;)
List&lt;User&gt; search(String q);

// 安全代码,采用concat
@Select(&quot;select * from users where user like concat(&#39;%&#39;,#&#123;q&#125;,&#39;%&#39;)&quot;)
List&lt;User&gt; search(String q);
                    
</code></pre>
<h3 id="安全编码-1"><a href="#安全编码-1" class="headerlink" title="安全编码"></a>安全编码</h3><p>使用<code>#&#123;&#125;</code>进行参数绑定</p>
<p>针对order by注入 进行排序映射</p>
<pre><code class="java">&lt;select id=&quot;orderBySafe&quot; resultType=&quot;com.best.hello.entity.User&quot;&gt;
    select * from users
    &lt;choose&gt;
        &lt;when test=&quot;field == &#39;id&#39;&quot;&gt;
            order by id desc
        &lt;/when&gt;
        &lt;when test=&quot;field == &#39;user&#39;&quot;&gt;
            order by user desc
        &lt;/when&gt;
        &lt;otherwise&gt;
            order by id desc
        &lt;/otherwise&gt;
    &lt;/choose&gt;
&lt;/select&gt;
                    
</code></pre>
<span id="more"></span>

<h1 id="任意文件操作"><a href="#任意文件操作" class="headerlink" title="任意文件操作"></a>任意文件操作</h1><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>后端基于白名单进行过滤 且不要暴露上传路径</p>
<p>设置目录权限限制，禁止上传目录的执行权限</p>
<p>建议使用OSS静态存储服务器来存储用户上传的文件</p>
<h2 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h2><p>也就是路径穿越 没有过滤<code>../ /</code>从而导致攻击者可以进行路径穿越 访问到本不该访问到的资源</p>
<pre><code class="java">public String download(String filename, HttpServletResponse response) &#123;
    String filePath = System.getProperty(&quot;user.dir&quot;) + &quot;/logs/&quot; + filename;
    try (InputStream inputStream = new BufferedInputStream(Files.newInputStream(Paths.get(filePath)))) &#123;
        response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot; + filename);
        response.setContentLength((int) Files.size(Paths.get(filePath)));
        response.setContentType(&quot;application/octet-stream&quot;);

        // 使用 Apache Commons IO 库的工具方法将输入流中的数据拷贝到输出流中
        IOUtils.copy(inputStream, response.getOutputStream());
        log.info(&quot;文件 &#123;&#125; 下载成功，路径：&#123;&#125;&quot;, filename, filePath);
        return &quot;下载文件成功：&quot; + filePath;
    &#125; catch (IOException e) &#123;
        log.error(&quot;下载文件失败，路径：&#123;&#125;&quot;, filePath, e);
        return &quot;未找到文件：&quot; + filePath;
    &#125;
&#125;
// fileName可控 并直接拼接到了filePath中
</code></pre>
<h3 id="安全编码-2"><a href="#安全编码-2" class="headerlink" title="安全编码"></a>安全编码</h3><p>文件目录避免外部参数拼接</p>
<p>黑名单匹配<code>../ /</code></p>
<p>文件保存时，将文件名替换为随机字符串</p>
<p>后端写死上传路径 上传时检验 如有尝试绕过一律不放行</p>
<h1 id="验证码复用"><a href="#验证码复用" class="headerlink" title="验证码复用"></a>验证码复用</h1><pre><code class="java"> // 未清除session中的验证码，导致可复用

 if (!CaptchaUtil.ver(captcha, request)) &#123;
     model.addAttribute(&quot;msg&quot;, &quot;验证码不正确&quot;);
     return &quot;login&quot;;
 &#125;
                    
</code></pre>
<p>此处在比较完验证码后 添加消息并返回到login路由 但是并没有清空验证码 导致可以爆破</p>
<h2 id="安全编码-3"><a href="#安全编码-3" class="headerlink" title="安全编码"></a>安全编码</h2><p>不管验证码是不是输入正确，都应该及时销毁验证码。</p>
<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><p>直接将用户的输入返回 没做任何处理</p>
<pre><code class="java">@GetMapping(&quot;/reflect&quot;)
public static String input(String content) &#123;
    return content;
&#125;
</code></pre>
<p>值得注意的是 如果前端做的转义 可以被绕过 所以后端要确保攻击者抓包修改传入数据时 后端要转义</p>
<p>干脆的就是不要前端转义 直接后端转义</p>
<h2 id="安全编码-4"><a href="#安全编码-4" class="headerlink" title="安全编码"></a>安全编码</h2><p><code>htmlEscape 或 OWASP Java Encoder 或 ESAPI 或 自实现</code>进行html实体化</p>
<p>黑白名单</p>
<p>对cookie进行httpOnly的设置 阻止js直接访问</p>
<p>正确设置content-type 禁止将非html页面设置为text&#x2F;html</p>
<h1 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h1><pre><code class="java">public static String URLConnection(String url) &#123;
    try &#123;
        URL u = new URL(url);
        URLConnection conn = u.openConnection();
        BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String content;
        StringBuffer html = new StringBuffer();

        while ((content = reader.readLine()) != null) &#123;
            html.append(content);
        &#125;
        reader.close();
        return html.toString();

    &#125; catch (Exception e) &#123;
        return e.getMessage();
    &#125;
&#125;
</code></pre>
<p>未检验url 直接进行请求</p>
<h2 id="安全编码-5"><a href="#安全编码-5" class="headerlink" title="安全编码"></a>安全编码</h2><p>黑白名单 判断是否是指定协议 是否是可信域名 最好直接限制对内网的访问</p>
<p>攻击者可能考虑使用短链接 ip进制等方法尝试绕过 此时需要先解析url为ip 然后再判断是否在内网</p>
<p>不允许302 重定向</p>
<pre><code class="java">// 1. 判断是否为http协议
public static boolean isHttp(String url) &#123;
    return url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;);
&#125;

// 2. 解析IP地址
public static String urltoIp(String url) &#123;
    try &#123;
        URI uri = new URI(url);
        String host = uri.getHost().toLowerCase();
        InetAddress ip = Inet4Address.getByName(host);
        return ip.getHostAddress();
    &#125; catch (Exception e) &#123;
        return &quot;127.0.0.1&quot;;
    &#125;
&#125;

// 3. 判断是否为内网IP
public static boolean isIntranet(String url) &#123;
    Pattern reg = Pattern.compile(&quot;^(127\\.0\\.0\\.1)|(localhost)|^(10\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;)|^(172\\.((1[6-9])|(2\\d)|(3[01]))\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;)|^(192\\.168\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;)$&quot;);
    Matcher match = reg.matcher(url);
    Boolean a = match.find();
    return a;
&#125;

// 4. 不允许302跳转
HttpURLConnection conn = (HttpURLConnection) u.openConnection();
conn.setInstanceFollowRedirects(false); // 不允许重定向或者对重定向后的地址做二次判断
conn.connect();
</code></pre>
<h1 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h1><p>常规的命令执行就不写了</p>
<p>通过脚本引擎代码注入</p>
<pre><code class="java">// 通过加载远程js文件来执行代码，如果加载了恶意js则会造成任意命令执行
// 远程恶意js: var a = mainOutput(); function mainOutput() &#123; var x=java.lang.Runtime.getRuntime().exec(&quot;open -a Calculator&quot;);&#125;
// ⚠️ 在Java 8之后移除了ScriptEngineManager的eval

public void jsEngine(String url) throws Exception &#123;
    ScriptEngine engine = new ScriptEngineManager().getEngineByName(&quot;JavaScript&quot;);
    Bindings bindings = engine.getBindings(ScriptContext.ENGINE_SCOPE);
    String payload = String.format(&quot;load(&#39;%s&#39;)&quot;, url);
    engine.eval(payload, bindings);
</code></pre>
<p>Groovy执行命令</p>
<pre><code class="java">import groovy.lang.GroovyShell;
@GetMapping(&quot;/groovy&quot;)
public void groovy(String cmd) &#123;
    GroovyShell shell = new GroovyShell();
    shell.evaluate(cmd);
</code></pre>
<h2 id="安全编码-6"><a href="#安全编码-6" class="headerlink" title="安全编码"></a>安全编码</h2><p>黑白名单</p>
<p>避免通过”cmd”、“bash”、“sh”等命令创建shell后拼接外部数据来执行操作系统命令 建议按需提供必要的功能</p>
<h1 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h1><p>当输入的反序列化的数据可被用户控制，那么攻击者即可通过构造恶意输入，让反序列化产生非预期的对象，在此过程中执行构造的任意代码</p>
<h2 id="安全编码-7"><a href="#安全编码-7" class="headerlink" title="安全编码"></a>安全编码</h2><p>沙箱</p>
<p>黑白名单</p>
<p>及时更新第三方组件库</p>
<p>使用第三方的安全组件 如 <a target="_blank" rel="noopener" href="https://github.com/ikkisoft/SerialKiller">SerialKiller </a>  java9+ 可以考虑继承<code>ObjectInputFilter</code>重写checkInput</p>
<h1 id="表达式注入"><a href="#表达式注入" class="headerlink" title="表达式注入"></a>表达式注入</h1><p>用户可以直接传入表达式 服务端未做过滤</p>
<pre><code class="java">// PoC: T(java.lang.Runtime).getRuntime().exec(%22calc%22)

public String vul(String ex) &#123;
    ExpressionParser parser = new SpelExpressionParser();

    // StandardEvaluationContext权限过大，可以执行任意代码，默认使用
    EvaluationContext evaluationContext = new StandardEvaluationContext();

    Expression exp = parser.parseExpression(ex);
    String result = exp.getValue(evaluationContext).toString();
    return result;
&#125;
                    
</code></pre>
<h2 id="安全编码-8"><a href="#安全编码-8" class="headerlink" title="安全编码"></a>安全编码</h2><p>切换权限更合理的上下文 如<code>SimpleEvaluationContext</code></p>
<p>黑白名单</p>
<h1 id="xxe"><a href="#xxe" class="headerlink" title="xxe"></a>xxe</h1><p>当开发人员配置其XML解析功能允许外部实体引用时 攻击者可以尝试任意文件读 内网端口探测 rce dos等攻击</p>
<pre><code class="java">public String XMLReader(@RequestBody String content) &#123;
    try &#123;
        XMLReader xmlReader = XMLReaderFactory.createXMLReader();
        // 修复：禁用外部实体
        // xmlReader.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);
        xmlReader.parse(new InputSource(new StringReader(content)));
        return &quot;XMLReader XXE&quot;;
    &#125; catch (Exception e) &#123;
        return e.toString();
    &#125;
&#125;
</code></pre>
<h2 id="安全编码-9"><a href="#安全编码-9" class="headerlink" title="安全编码"></a>安全编码</h2><p>关闭DTD解析</p>
<blockquote>
<p>  &#x2F;&#x2F; xmlReader.setFeature(“<a target="_blank" rel="noopener" href="http://apache.org/xml/features/disallow-doctype-decl">http://apache.org/xml/features/disallow-doctype-decl</a>“, true);</p>
<p>  &#x2F;&#x2F; factory.setFeature(“<a target="_blank" rel="noopener" href="http://apache.org/xml/features/disallow-doctype-decl">http://apache.org/xml/features/disallow-doctype-decl</a>“, true);</p>
<p>  &#x2F;&#x2F; sax.setFeature(“<a target="_blank" rel="noopener" href="http://apache.org/xml/features/disallow-doctype-decl">http://apache.org/xml/features/disallow-doctype-decl</a>“, true);</p>
<p>  &#x2F;&#x2F; saxbuilder.setFeature(“<a target="_blank" rel="noopener" href="http://apache.org/xml/features/disallow-doctype-decl">http://apache.org/xml/features/disallow-doctype-decl</a>“, true);</p>
<pre><code>  // xif.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, &quot;&quot;);
  // xif.setProperty(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, &quot;&quot;);
</code></pre>
</blockquote>
<h1 id="越权"><a href="#越权" class="headerlink" title="越权"></a>越权</h1><p>在用户进行某操作的时候 用户信息不是从session中获取的 直接接收用户的输入 并且后端未做权限校验 导致的越权</p>
<pre><code class="java">// 未做权限控制，通过遍历name参数可查询任意用户信息
public List&lt;User&gt; vul(String name) &#123;
    return userMapper.queryByUser(name);
&#125;
</code></pre>
<h2 id="安全编码-10"><a href="#安全编码-10" class="headerlink" title="安全编码"></a>安全编码</h2><p> 对于非公共操作，应当校验当前访问账号进行操作权限和数据权限校验。</p>
<ol>
<li>验证当前用户的登录态</li>
<li>从可信结构中获取经过校验的当前请求账号的身份信息（如：session）。禁止从用户请求参数或Cookie中获取外部传入不可信用户身份直接进行查询。</li>
<li>校验当前用户是否具备该操作权限</li>
<li>校验当前用户是否具备所操作数据的权限，避免越权。</li>
</ol>
<h1 id="接口未授权访问"><a href="#接口未授权访问" class="headerlink" title="接口未授权访问"></a>接口未授权访问</h1><p>部分接口未做权限校验 在不具备权限或权限不足的情况下允许了用户对接口的调用</p>
<h2 id="安全编码-11"><a href="#安全编码-11" class="headerlink" title="安全编码"></a>安全编码</h2><p>对于非公共操作，应当校验当前访问账号进行操作权限和数据权限校验。</p>
<p>确保所有非公共的API接口先经过登录控制器。</p>
<h1 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h1><pre><code class="java"> /**
   * 如果controller无返回值，则以GetMapping的路由为视图名称，即将请求的url作为视图名称，调用模板引擎去解析
   * 在这种情况下，我们只要可以控制请求的controller的参数，一样可以造成RCE漏洞
   * payload: __$&#123;T(java.lang.Runtime).getRuntime().exec(&quot;open -a Calculator&quot;)&#125;__::.x
   */

 @GetMapping(&quot;/doc/&#123;document&#125;&quot;)
 public void getDocument(@PathVariable String document) &#123;
     System.out.println(document);
 &#125;
</code></pre>
<p>安全代码如下</p>
<pre><code class="java"> // 由于controller的参数被设置为HttpServletResponse，Spring认为它已经处理了HTTP Response，因此不会发生视图名称解析

 @GetMapping(&quot;/doc/safe/&#123;document&#125;&quot;)
 public void getDocument(@PathVariable String document, HttpServletResponse response) &#123;
     System.out.println(document);
 &#125;  
</code></pre>
<h2 id="安全编码-12"><a href="#安全编码-12" class="headerlink" title="安全编码"></a>安全编码</h2><p>验证用户输入</p>
<p>启用对应模板引擎的安全特性 比如<code>Freemarker</code>设置freemarker.template.utility.ObjectConstructor<code>为</code>null 避免创建任意对象</p>
<h1 id="JNDI注入"><a href="#JNDI注入" class="headerlink" title="JNDI注入"></a>JNDI注入</h1><p>当lookup方法可控时就可能存在jndi注入 高版本jdk会好一点 默认禁止LDAP协议使用远程codebase</p>
<h2 id="安全编码-13"><a href="#安全编码-13" class="headerlink" title="安全编码"></a>安全编码</h2><p>白名单</p>
<p>正则匹配</p>
<p>不允许lookup参数接收用户的输入</p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
